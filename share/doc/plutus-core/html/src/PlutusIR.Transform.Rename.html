<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE ConstraintKinds       #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE FlexibleContexts      #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE FlexibleInstances     #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase            #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE MultiParamTypeClasses #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE RankNTypes            #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeFamilies          #-}</span><span>
</span><span id="line-9"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators         #-}</span><span>
</span><span id="line-10"></span><span class="hs-pragma">{-# LANGUAGE UndecidableInstances  #-}</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-pragma">{-# OPTIONS_GHC -fno-warn-orphans #-}</span><span>
</span><span id="line-13"></span><span>
</span><span id="line-14"></span><span class="hs-comment">-- | Renaming of PIR terms. Import this module to bring the @PLC.Rename (Term tyname name uni fun ann)@</span><span>
</span><span id="line-15"></span><span class="hs-comment">-- instance in scope.</span><span>
</span><span id="line-16"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusIR.Transform.Rename</span><span>
</span><span id="line-17"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier">renameTermM</span></a></span><span>
</span><span id="line-18"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameProgramM"><span class="hs-identifier">renameProgramM</span></a></span><span>
</span><span id="line-19"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-20"></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusPrelude.html"><span class="hs-identifier">PlutusPrelude</span></a></span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.html"><span class="hs-identifier">PlutusIR</span></a></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusIR.Mark.html"><span class="hs-identifier">PlutusIR.Mark</span></a></span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.html"><span class="hs-identifier">PlutusCore</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PLC</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Name.html"><span class="hs-identifier">PlutusCore.Name</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PLC</span></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="PlutusCore.Rename.Internal.html"><span class="hs-identifier">PlutusCore.Rename.Internal</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PLC</span></span><span>
</span><span id="line-29"></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">Control.Monad.Trans.Cont</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier">ContT</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="hs-comment">{- Note [Renaming of mutually recursive bindings]
The 'RenameM' monad is a newtype wrapper around @ReaderT renaming Quote@, so in order to bring
a name into the scope we need to use the following pattern:

    withFreshenedX :: X -&gt; (X -&gt; RenameM renaming c) -&gt; RenameM renaming c

where an 'X' is some value that has names inside and the second argument is a continuation that
expects to receive this value, but with all the names freshened and with the mappings from the
old uniques to the new ones saved. For the latter reason we can't just write

    freshenX :: X -&gt; RenameM renaming X

because if you write

    freshenX x &gt;&gt;= \xFr -&gt; ...

then the mappings from the uniques of 'x' to the uniques of 'xFr' do not exist in @...@.

Two problems arise:

1. If you have a list of @X@s and then an @Y@ and then another list of @Z@s and you need to freshen
   all of those, it's not nice to compose @withFreshened*@ functions at all. In order to make these
   functions composable, we can wrap them in the 'ContT' monad. See e.g. 'renameDatatypeCM' below.
2. Handling of mutually recursive bindings requires to bring a bunch of bindings in scope first and
   only then to rename their RHSs. I.e. one part of a 'ScopedRenameM' computation must be performed
   immediately (brinding names in scope) and the other part must be postponed until all bindings
   are in scope (renaming of RHSs). We will refer to this scheme as &quot;two-stage renaming&quot;.

   Hence we have the following pattern:

       renameXCM :: X -&gt; ContT c PLC.ScopedRenameM (PLC.ScopedRenameM X)

   where an 'X' is some value that defines some names and has types/terms that need to be renamed.
   The first 'PLC.ScopedRenameM' is for bringing names (the first stage) in scope and the second
   'PLC.ScopedRenameM' is for performing the renaming (the second stage).
-}</span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">{- Note [Weird IR data types]
We don't attempt to recognize in the renamer a family of mutually recursive data types where two
or more data types have the same name, so the renamer's behavior in that case is undefined.
The same applies to a data type having identically named constructors or when a constructor has
the same name as the matcher etc.

The AST of Plutus IR allows us to represent some weird data types like

    data D where
        C : integer -&gt; (\d -&gt; d) D

    data D where
        C : (\d -&gt; d) (integer -&gt; D)

We don't pretend that we can handle those at all. The renamer calls 'error' upon seeing anything of
this kind.

However this one:

    data D x where
        C : all D. D x -&gt; D x

is perfectly unambiguous:

1. the head (@D@) of the application (@D x@) in the type of the result (after @-&gt;@) has to refer to
   the data type being defined and so @all D@ is not supposed to result in shadowing there
2. @all D@ shadows the name of the data type everywhere before the final @-&gt;@, so it does not matter
   whether @D@ is recursive or not as any @D@ before the final @-&gt;@ refers to the @all@-bound @D@
   regardless of recursivity.

Note that @all D@ is existential quantification and the type checker wasn't able to handle that at
the time this note was written.

Similarly, in

    data D D where
        C : D -&gt; D

the parameter shadows the data type before @-&gt;@ and does not shadow it afterwards regardless of
recursivity.

Note also that for example the following:

    data D1 x where
        C1 : all x. D1 x

is not existential quantification and should mean the same thing as

    data D2 x where
        C2 : D2 x

but also was blowing up the type checker at the time the note was written.

Haskell agrees that these two data types are isomorphic:

    data D1 x where
        C1 :: forall x. D1 x

    data D2 x where
        C2 :: D2 x

    d12 :: D1 x -&gt; D2 x
    d12 C1 = C2

    d21 :: D2 x -&gt; D1 x
    d21 C2 = C1

Note @D1@ only requires @GADTSyntax@ and not full-blown @GADTs@.

Speaking of GADTs, the following data type:

    data D D where
        C : D D

is only unambiguous if we stipulate that GADTs are not allowed in Plutus IR (otherwise the last
@D@ could be an index referring to the data type rather than the parameter).

So what we do in the renamer is rename everything as normal apart from the head of the application
after the final @-&gt;@ in the type of a constructor (let's call that &quot;the final head&quot;). Instead, the
final head is renamed in the context that the whole data type is renamed in plus the name of the
data type, which ensures that neither parameters nor @all@-bound variables in the type of the
constructor can shadow the name of the data type in the final head. This effectively bans the
GADT interpretation of the @data D D@ example from the above thus removing ambiguity.

This agrees perfectly with what we need to do to handle recursivity in constructors, see
Note [Renaming of constructors].
-}</span><span>
</span><span id="line-157"></span><span>
</span><span id="line-158"></span><span class="hs-comment">{- Note [Renaming of constructors]
Consider the following data type:

    data Loop where
        MkLoop : Loop -&gt; Loop

Whether the occurrence of @Loop@ before @-&gt;@ in the type of @MkLoop@ refers to @Loop@-the-data-type
or not depends on whether the data type is declared as recursive or not. However the occurrence of
@Loop@ after @-&gt;@ always refers to @Loop@-the-data-type. So we can't just directly rename the type
of a constructor with some general 'renameTypeM' stuff, we have to actually traverse the type and
rename things before the final @-&gt;@ differently depending on recursivity without doing so for the
final type as was discussed in Note [Weird IR data types].

However the current context is stored inside the 'RenameT' transformer and changing it manually
would be quite unpleasant as 'RenameT' is designed specifically to abstract these details out.
Instead, we provide a function that captures the current context in a 'Restorer' that allows us
to restore that context later. We use the capturing function twice: right before binding the name
of a data type and right after, which gives us two respective restorers. The former restorer is
used when type checking constructors of non-recursive data types: binding the name of data type
ensures that the data type is visible after the 'DatatypeBind' entry of the corresponding @let@
and using the restorer ensures that the name of the data type is not visible in the type of
constructors (as the data type is non-recursive) apart from the final head. And since recursivity
has no impact on how the final head is renamed, we use the right-after-the-name-of-the-data-type
restorer once we reach the final head. This gives us a single function for renaming types of
constructors in both the recursive and non-recursive cases letting us handle recursivity with a
single line in the function renaming a data type.
-}</span><span>
</span><span id="line-185"></span><span>
</span><span id="line-186"></span><span class="hs-comment">{- Note [Mutual vs non-mutual recursion]
Note [Renaming of mutually recursive bindings] describes how we handle recursive bindings.
There's nothing special about the way we handle non-recursive ones, however it's worth saying
explicitly that in

    let nonrec x = &lt;...&gt;

@x@ is not visible in @&lt;...&gt;@, which makes it hard to share code between functions that handle
recursive and non-recursive bindings, so we don't.

Note [Renaming of constructors] describes how we managed to handle types of constructors of
recursive and non-recursive data types with a single function.
-}</span><span>
</span><span id="line-199"></span><span>
</span><span id="line-200"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681105306"><span id="local-6989586621681105307"><span id="local-6989586621681105308"><span id="local-6989586621681105309"><span id="local-6989586621681105310"><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105310"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105309"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105308"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105307"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105306"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Rename.html#Rename"><span class="hs-identifier hs-type">PLC.Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105310"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105309"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105308"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105307"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105306"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-201"></span><span>    </span><span class="hs-comment">-- See Note [Marking]</span><span>
</span><span id="line-202"></span><span>    </span><span id="local-6989586621681105011"><span class="annot"><span class="annottext">rename :: forall (m :: * -&gt; *).
MonadQuote m =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusCore.Rename.html#rename"><span class="hs-identifier hs-var hs-var hs-var hs-var">rename</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; f b) -&gt; a -&gt; f a
</span><a href="PlutusPrelude.html#through"><span class="hs-identifier hs-var">through</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun ann (m :: * -&gt; *).
(HasUniques (Term tyname name uni fun ann), MonadQuote m) =&gt;
Term tyname name uni fun ann -&gt; m ()
</span><a href="PlutusIR.Mark.html#markNonFreshTerm"><span class="hs-identifier hs-var">markNonFreshTerm</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren (m :: * -&gt; *) a. Monoid ren =&gt; RenameT ren m a -&gt; m a
</span><a href="PlutusCore.Rename.Monad.html#runRenameT"><span class="hs-identifier hs-var">PLC.runRenameT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681105255"><span id="local-6989586621681105256"><span id="local-6989586621681105257"><span id="local-6989586621681105258"><span id="local-6989586621681105259"><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105259"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105258"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105257"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105256"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105255"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Rename.html#Rename"><span class="hs-identifier hs-type">PLC.Rename</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105259"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105258"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105257"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105256"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105255"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-205"></span><span>    </span><span id="local-6989586621681104992"><span class="annot"><span class="annottext">rename :: forall (m :: * -&gt; *).
MonadQuote m =&gt;
Program tyname name uni fun ann
-&gt; m (Program tyname name uni fun ann)
</span><a href="#local-6989586621681104992"><span class="hs-identifier hs-var hs-var hs-var hs-var">rename</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span id="local-6989586621681104990"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104990"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681104989"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104989"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun ann.
ann
-&gt; Term tyname name uni fun ann -&gt; Program tyname name uni fun ann
</span><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-var">Program</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104990"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a (m :: * -&gt; *). (Rename a, MonadQuote m) =&gt; a -&gt; m a
</span><a href="PlutusCore.Rename.html#rename"><span class="hs-identifier hs-var">PLC.rename</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104989"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-206"></span><span>
</span><span id="line-207"></span><span class="hs-comment">-- See Note [Renaming of constructors].</span><span>
</span><span id="line-208"></span><span class="hs-comment">-- | A wrapper around a function restoring some old context of the renamer.</span><span>
</span><span id="line-209"></span><span class="hs-keyword">newtype</span><span> </span><span id="Restorer"><span class="annot"><a href="PlutusIR.Transform.Rename.html#Restorer"><span class="hs-identifier hs-var">Restorer</span></a></span></span><span> </span><span id="local-6989586621681105245"><span class="annot"><a href="#local-6989586621681105245"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Restorer"><span class="annot"><a href="PlutusIR.Transform.Rename.html#Restorer"><span class="hs-identifier hs-var">Restorer</span></a></span></span><span>
</span><span id="line-210"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="unRestorer"><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Restorer m -&gt; forall a. m a -&gt; m a
</span><a href="PlutusIR.Transform.Rename.html#unRestorer"><span class="hs-identifier hs-var hs-var">unRestorer</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-keyword">forall</span><span> </span><span id="local-6989586621681105243"><span class="annot"><a href="#local-6989586621681105243"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-operator">.</span><span> </span><span class="annot"><a href="#local-6989586621681105245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105243"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105245"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105243"><span class="hs-identifier hs-type">a</span></a></span><span>
</span><span id="line-211"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-212"></span><span>
</span><span id="line-213"></span><span class="hs-comment">-- | Capture the current context in a 'Restorer'.</span><span>
</span><span id="line-214"></span><span id="local-6989586621681105239"><span id="local-6989586621681105240"><span id="local-6989586621681105241"><span class="annot"><a href="PlutusIR.Transform.Rename.html#captureContext"><span class="hs-identifier hs-type">captureContext</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105241"><span class="hs-identifier hs-type">ren</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105240"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ContT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105239"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105240"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#Restorer"><span class="hs-identifier hs-type">Restorer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105240"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span></span></span></span><span>
</span><span id="line-215"></span><span id="captureContext"><span class="annot"><span class="annottext">captureContext :: forall ren (m :: * -&gt; *) c.
MonadReader ren m =&gt;
ContT c m (Restorer m)
</span><a href="PlutusIR.Transform.Rename.html#captureContext"><span class="hs-identifier hs-var hs-var">captureContext</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104977"><span class="annot"><span class="annottext">Restorer m -&gt; m c
</span><a href="#local-6989586621681104977"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-216"></span><span>    </span><span id="local-6989586621681104976"><span class="annot"><span class="annottext">ren
</span><a href="#local-6989586621681104976"><span class="hs-identifier hs-var">env</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *). MonadReader r m =&gt; m r
</span><a href="../../../../ghc/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">ask</span></a></span><span>
</span><span id="line-217"></span><span>    </span><span class="annot"><span class="annottext">Restorer m -&gt; m c
</span><a href="#local-6989586621681104977"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). (forall a. m a -&gt; m a) -&gt; Restorer m
</span><a href="PlutusIR.Transform.Rename.html#Restorer"><span class="hs-identifier hs-var">Restorer</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall r (m :: * -&gt; *) a. MonadReader r m =&gt; (r -&gt; r) -&gt; m a -&gt; m a
</span><a href="../../../../ghc/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-var">local</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; b -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">ren
</span><a href="#local-6989586621681104976"><span class="hs-identifier hs-var">env</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span class="hs-keyword">type</span><span> </span><span id="MonadRename"><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-var">MonadRename</span></a></span></span><span> </span><span id="local-6989586621681104971"><span class="annot"><a href="#local-6989586621681104971"><span class="hs-identifier hs-type">m</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Quote.html#MonadQuote"><span class="hs-identifier hs-type">PLC.MonadQuote</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681104971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/mtl-2.2.2/src"><span class="hs-identifier hs-type">MonadReader</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Rename.Monad.html#ScopedRenaming"><span class="hs-identifier hs-type">PLC.ScopedRenaming</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681104971"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-220"></span><span>
</span><span id="line-221"></span><span class="hs-comment">-- | Rename the type of a constructor given a restorer dropping all variables bound after the</span><span>
</span><span id="line-222"></span><span class="hs-comment">-- name of the data type.</span><span>
</span><span id="line-223"></span><span id="local-6989586621681105218"><span id="local-6989586621681105219"><span id="local-6989586621681105220"><span id="local-6989586621681105221"><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameConstrTypeM"><span class="hs-identifier hs-type">renameConstrTypeM</span></a></span><span>
</span><span id="line-224"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105221"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105220"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105219"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105218"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-225"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Rename.html#Restorer"><span class="hs-identifier hs-type">Restorer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105221"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105220"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105219"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105218"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105221"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105220"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105219"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105218"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span><span>
</span><span id="line-226"></span><span id="renameConstrTypeM"><span class="annot"><span class="annottext">renameConstrTypeM :: forall (m :: * -&gt; *) tyname (uni :: * -&gt; *) ann.
(MonadRename m, HasUniques (Type tyname uni ann)) =&gt;
Restorer m -&gt; Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusIR.Transform.Rename.html#renameConstrTypeM"><span class="hs-identifier hs-var hs-var">renameConstrTypeM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#Restorer"><span class="hs-identifier hs-type">Restorer</span></a></span><span> </span><span id="local-6989586621681104937"><span class="annot"><span class="annottext">forall a. m a -&gt; m a
</span><a href="#local-6989586621681104937"><span class="hs-identifier hs-var">restoreAfterData</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="#local-6989586621681104936"><span class="hs-identifier hs-var">renameSpineM</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-227"></span><span>    </span><span id="local-6989586621681104936"><span class="annot"><span class="annottext">renameSpineM :: Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="#local-6989586621681104936"><span class="hs-identifier hs-var hs-var">renameSpineM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-type">TyForall</span></a></span><span> </span><span id="local-6989586621681104934"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104934"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681104933"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104933"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681104932"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681104932"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681104931"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104931"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-228"></span><span>        </span><span class="annot"><span class="annottext">forall ren unique name (m :: * -&gt; *) c.
(HasRenaming ren unique, HasUnique name unique, MonadQuote m,
 MonadReader ren m) =&gt;
name -&gt; (name -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Monad.html#withFreshenedName"><span class="hs-identifier hs-var">PLC.withFreshenedName</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104933"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104929"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104929"><span class="hs-identifier hs-var">nameFr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; tyname -&gt; Kind ann -&gt; Type tyname uni ann -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyForall"><span class="hs-identifier hs-var">TyForall</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104934"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104929"><span class="hs-identifier hs-var">nameFr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681104932"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="#local-6989586621681104936"><span class="hs-identifier hs-var">renameSpineM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104931"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-229"></span><span>    </span><span class="annot"><a href="#local-6989586621681104936"><span class="hs-identifier hs-var">renameSpineM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-type">TyFun</span></a></span><span> </span><span id="local-6989586621681104927"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104927"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681104926"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104926"><span class="hs-identifier hs-var">dom</span></a></span></span><span> </span><span id="local-6989586621681104925"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104925"><span class="hs-identifier hs-var">cod</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyFun"><span class="hs-identifier hs-var">TyFun</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104927"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104926"><span class="hs-identifier hs-var">dom</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="#local-6989586621681104936"><span class="hs-identifier hs-var">renameSpineM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104925"><span class="hs-identifier hs-var">cod</span></a></span><span>
</span><span id="line-230"></span><span>    </span><span class="annot"><a href="#local-6989586621681104936"><span class="hs-identifier hs-var">renameSpineM</span></a></span><span> </span><span id="local-6989586621681104923"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104923"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="#local-6989586621681104922"><span class="hs-identifier hs-var">renameResultM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104923"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span>    </span><span id="local-6989586621681104922"><span class="annot"><span class="annottext">renameResultM :: Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="#local-6989586621681104922"><span class="hs-identifier hs-var hs-var">renameResultM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-type">TyApp</span></a></span><span> </span><span id="local-6989586621681104920"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104920"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681104919"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104919"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681104918"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104918"><span class="hs-identifier hs-var">arg</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
-&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyApp"><span class="hs-identifier hs-var">TyApp</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104920"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="#local-6989586621681104922"><span class="hs-identifier hs-var">renameResultM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104919"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104918"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-233"></span><span>    </span><span class="annot"><a href="#local-6989586621681104922"><span class="hs-identifier hs-var">renameResultM</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-type">TyVar</span></a></span><span> </span><span id="local-6989586621681104916"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104916"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681104915"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104915"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname (uni :: * -&gt; *) ann.
ann -&gt; tyname -&gt; Type tyname uni ann
</span><a href="PlutusCore.Core.Type.html#TyVar"><span class="hs-identifier hs-var">TyVar</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104916"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. m a -&gt; m a
</span><a href="#local-6989586621681104937"><span class="hs-identifier hs-var">restoreAfterData</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ren unique name (m :: * -&gt; *).
(HasRenaming ren unique, HasUnique name unique,
 MonadReader ren m) =&gt;
name -&gt; m name
</span><a href="PlutusCore.Rename.Monad.html#renameNameM"><span class="hs-identifier hs-var">PLC.renameNameM</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104915"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-234"></span><span>    </span><span class="annot"><a href="#local-6989586621681104922"><span class="hs-identifier hs-var">renameResultM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-235"></span><span>        </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Panic: a constructor returns something that is not an iterated application of a type variable&quot;</span></span><span>
</span><span id="line-236"></span><span>
</span><span id="line-237"></span><span class="hs-comment">-- | Rename the name of a constructor immediately and defer renaming of its type until the second</span><span>
</span><span id="line-238"></span><span class="hs-comment">-- stage where all mutually recursive data types (if any) are bound.</span><span>
</span><span id="line-239"></span><span id="local-6989586621681105179"><span id="local-6989586621681105181"><span id="local-6989586621681105182"><span id="local-6989586621681105183"><span id="local-6989586621681105184"><span id="local-6989586621681105185"><span id="local-6989586621681105186"><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameConstrCM"><span class="hs-identifier hs-type">renameConstrCM</span></a></span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105186"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105185"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105184"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105183"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105182"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105181"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Transform.Rename.html#Restorer"><span class="hs-identifier hs-type">Restorer</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105186"><span class="hs-identifier hs-type">m</span></a></span><span>
</span><span id="line-242"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105185"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105184"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105183"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105181"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-243"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ContT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105179"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105186"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681105186"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105185"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105184"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105183"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105181"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-244"></span><span id="renameConstrCM"><span class="annot"><span class="annottext">renameConstrCM :: forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Restorer m
-&gt; VarDecl tyname name uni ann
-&gt; ContT c m (m (VarDecl tyname name uni ann))
</span><a href="PlutusIR.Transform.Rename.html#renameConstrCM"><span class="hs-identifier hs-var hs-var">renameConstrCM</span></a></span></span><span> </span><span id="local-6989586621681104889"><span class="annot"><span class="annottext">Restorer m
</span><a href="#local-6989586621681104889"><span class="hs-identifier hs-var">restorerAfterData</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-type">VarDecl</span></a></span><span> </span><span id="local-6989586621681104887"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104887"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681104886"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104886"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681104885"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104885"><span class="hs-identifier hs-var">ty</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-245"></span><span>    </span><span id="local-6989586621681104884"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104884"><span class="hs-identifier hs-var">nameFr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren unique name (m :: * -&gt; *) c.
(HasRenaming ren unique, HasUnique name unique, MonadQuote m,
 MonadReader ren m) =&gt;
name -&gt; (name -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Monad.html#withFreshenedName"><span class="hs-identifier hs-var">PLC.withFreshenedName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104886"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-246"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) ann.
ann -&gt; name -&gt; Type tyname uni ann -&gt; VarDecl tyname name uni ann
</span><a href="PlutusCore.Core.Type.html#VarDecl"><span class="hs-identifier hs-var">VarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104887"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104884"><span class="hs-identifier hs-var">nameFr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname (uni :: * -&gt; *) ann.
(MonadRename m, HasUniques (Type tyname uni ann)) =&gt;
Restorer m -&gt; Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusIR.Transform.Rename.html#renameConstrTypeM"><span class="hs-identifier hs-var">renameConstrTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Restorer m
</span><a href="#local-6989586621681104889"><span class="hs-identifier hs-var">restorerAfterData</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104885"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-247"></span><span>
</span><span id="line-248"></span><span class="hs-comment">-- | Apply a function to a value in the non-recursive case and return the value unchanged otherwise.</span><span>
</span><span id="line-249"></span><span id="local-6989586621681105159"><span class="annot"><a href="PlutusIR.Transform.Rename.html#onNonRec"><span class="hs-identifier hs-type">onNonRec</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Recursivity"><span class="hs-identifier hs-type">Recursivity</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681105159"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105159"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105159"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105159"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-250"></span><span id="onNonRec"><span class="annot"><span class="annottext">onNonRec :: forall a. Recursivity -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="PlutusIR.Transform.Rename.html#onNonRec"><span class="hs-identifier hs-var hs-var">onNonRec</span></a></span></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span id="local-6989586621681104881"><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621681104881"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621681104880"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681104880"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; a
</span><a href="#local-6989586621681104881"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681104880"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-251"></span><span class="annot"><a href="PlutusIR.Transform.Rename.html#onNonRec"><span class="hs-identifier hs-var">onNonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>    </span><span class="annot"><span class="annottext">a -&gt; a
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681104878"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681104878"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621681104878"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-252"></span><span>
</span><span id="line-253"></span><span class="hs-comment">-- See Note [Weird IR data types]</span><span>
</span><span id="line-254"></span><span class="hs-comment">-- See Note [Renaming of constructors] (and make sure you understand all the intricacies in it</span><span>
</span><span id="line-255"></span><span class="hs-comment">-- before toucing this function).</span><span>
</span><span id="line-256"></span><span class="hs-comment">-- | Rename a 'Datatype' in the CPS-transformed 'ScopedRenameM' monad.</span><span>
</span><span id="line-257"></span><span id="local-6989586621681105150"><span id="local-6989586621681105152"><span id="local-6989586621681105153"><span id="local-6989586621681105154"><span id="local-6989586621681105155"><span id="local-6989586621681105156"><span id="local-6989586621681105157"><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameDatatypeCM"><span class="hs-identifier hs-type">renameDatatypeCM</span></a></span><span>
</span><span id="line-258"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105157"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105156"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105155"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105154"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105153"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105152"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-259"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Recursivity"><span class="hs-identifier hs-type">Recursivity</span></a></span><span>
</span><span id="line-260"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105156"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105155"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105154"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105152"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-261"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ContT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105150"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681105157"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105156"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105155"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105154"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105152"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-262"></span><span id="renameDatatypeCM"><span class="annot"><span class="annottext">renameDatatypeCM :: forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Recursivity
-&gt; Datatype tyname name uni ann
-&gt; ContT c m (m (Datatype tyname name uni ann))
</span><a href="PlutusIR.Transform.Rename.html#renameDatatypeCM"><span class="hs-identifier hs-var hs-var">renameDatatypeCM</span></a></span></span><span> </span><span id="local-6989586621681104836"><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681104836"><span class="hs-identifier hs-var">recy</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-type">Datatype</span></a></span><span> </span><span id="local-6989586621681104834"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104834"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104833"><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104833"><span class="hs-identifier hs-var">dataDecl</span></a></span></span><span> </span><span id="local-6989586621681104832"><span class="annot"><span class="annottext">[TyVarDecl tyname ann]
</span><a href="#local-6989586621681104832"><span class="hs-identifier hs-var">params</span></a></span></span><span> </span><span id="local-6989586621681104831"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104831"><span class="hs-identifier hs-var">matchName</span></a></span></span><span> </span><span id="local-6989586621681104830"><span class="annot"><span class="annottext">[VarDecl tyname name uni ann]
</span><a href="#local-6989586621681104830"><span class="hs-identifier hs-var">constrs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-263"></span><span>    </span><span class="hs-comment">-- The first stage (the data type itself, its constructors and its matcher get renamed).</span><span>
</span><span id="line-264"></span><span>    </span><span class="hs-comment">-- Note that all of these are visible downstream.</span><span>
</span><span id="line-265"></span><span>    </span><span id="local-6989586621681104829"><span class="annot"><span class="annottext">Restorer m
</span><a href="#local-6989586621681104829"><span class="hs-identifier hs-var">restorerBeforeData</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ren (m :: * -&gt; *) c.
MonadReader ren m =&gt;
ContT c m (Restorer m)
</span><a href="PlutusIR.Transform.Rename.html#captureContext"><span class="hs-identifier hs-var">captureContext</span></a></span><span>
</span><span id="line-266"></span><span>    </span><span id="local-6989586621681104828"><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104828"><span class="hs-identifier hs-var">dataDeclFr</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *) c.
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
TyVarDecl tyname ann -&gt; (TyVarDecl tyname ann -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Internal.html#withFreshenedTyVarDecl"><span class="hs-identifier hs-var">PLC.withFreshenedTyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104833"><span class="hs-identifier hs-var">dataDecl</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span id="local-6989586621681104826"><span class="annot"><span class="annottext">Restorer m
</span><a href="#local-6989586621681104826"><span class="hs-identifier hs-var">restorerAfterData</span></a></span></span><span>  </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ren (m :: * -&gt; *) c.
MonadReader ren m =&gt;
ContT c m (Restorer m)
</span><a href="PlutusIR.Transform.Rename.html#captureContext"><span class="hs-identifier hs-var">captureContext</span></a></span><span>
</span><span id="line-268"></span><span>    </span><span id="local-6989586621681104825"><span class="annot"><span class="annottext">[m (VarDecl tyname name uni ann)]
</span><a href="#local-6989586621681104825"><span class="hs-identifier hs-var">constrsRen</span></a></span></span><span>         </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Restorer m
-&gt; VarDecl tyname name uni ann
-&gt; ContT c m (m (VarDecl tyname name uni ann))
</span><a href="PlutusIR.Transform.Rename.html#renameConstrCM"><span class="hs-identifier hs-var">renameConstrCM</span></a></span><span> </span><span class="annot"><span class="annottext">Restorer m
</span><a href="#local-6989586621681104826"><span class="hs-identifier hs-var">restorerAfterData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[VarDecl tyname name uni ann]
</span><a href="#local-6989586621681104830"><span class="hs-identifier hs-var">constrs</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span id="local-6989586621681104823"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104823"><span class="hs-identifier hs-var">matchNameFr</span></a></span></span><span>        </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren unique name (m :: * -&gt; *) c.
(HasRenaming ren unique, HasUnique name unique, MonadQuote m,
 MonadReader ren m) =&gt;
name -&gt; (name -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Monad.html#withFreshenedName"><span class="hs-identifier hs-var">PLC.withFreshenedName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104831"><span class="hs-identifier hs-var">matchName</span></a></span><span>
</span><span id="line-270"></span><span>    </span><span class="hs-comment">-- The second stage (the type parameters and types of constructors get renamed).</span><span>
</span><span id="line-271"></span><span>    </span><span class="hs-comment">-- Note that parameters are only visible in the types of constructors and not downstream.</span><span>
</span><span id="line-272"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Recursivity -&gt; (a -&gt; a) -&gt; a -&gt; a
</span><a href="PlutusIR.Transform.Rename.html#onNonRec"><span class="hs-identifier hs-var">onNonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681104836"><span class="hs-identifier hs-var">recy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *). Restorer m -&gt; forall a. m a -&gt; m a
</span><a href="PlutusIR.Transform.Rename.html#unRestorer"><span class="hs-identifier hs-var">unRestorer</span></a></span><span> </span><span class="annot"><span class="annottext">Restorer m
</span><a href="#local-6989586621681104829"><span class="hs-identifier hs-var">restorerBeforeData</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-273"></span><span>        </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
ContT r m a -&gt; (a -&gt; m r) -&gt; m r
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runContT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *) c.
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
TyVarDecl tyname ann -&gt; (TyVarDecl tyname ann -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Internal.html#withFreshenedTyVarDecl"><span class="hs-identifier hs-var">PLC.withFreshenedTyVarDecl</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[TyVarDecl tyname ann]
</span><a href="#local-6989586621681104832"><span class="hs-identifier hs-var">params</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104821"><span class="annot"><span class="annottext">[TyVarDecl tyname ann]
</span><a href="#local-6989586621681104821"><span class="hs-identifier hs-var">paramsFr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-274"></span><span>            </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) a.
a
-&gt; TyVarDecl tyname a
-&gt; [TyVarDecl tyname a]
-&gt; name
-&gt; [VarDecl tyname name uni a]
-&gt; Datatype tyname name uni a
</span><a href="PlutusIR.Core.Type.html#Datatype"><span class="hs-identifier hs-var">Datatype</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104834"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104828"><span class="hs-identifier hs-var">dataDeclFr</span></a></span><span> </span><span class="annot"><span class="annottext">[TyVarDecl tyname ann]
</span><a href="#local-6989586621681104821"><span class="hs-identifier hs-var">paramsFr</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104823"><span class="hs-identifier hs-var">matchNameFr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="annot"><span class="annottext">[m (VarDecl tyname name uni ann)]
</span><a href="#local-6989586621681104825"><span class="hs-identifier hs-var">constrsRen</span></a></span><span>
</span><span id="line-275"></span><span>
</span><span id="line-276"></span><span class="hs-comment">-- | Rename a 'Binding' from a non-recursive family in the CPS-transformed 'ScopedRenameM' monad.</span><span>
</span><span id="line-277"></span><span id="local-6989586621681105114"><span id="local-6989586621681105116"><span id="local-6989586621681105117"><span id="local-6989586621681105118"><span id="local-6989586621681105119"><span id="local-6989586621681105120"><span id="local-6989586621681105121"><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameBindingNonRecC"><span class="hs-identifier hs-type">renameBindingNonRecC</span></a></span><span>
</span><span id="line-278"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105121"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105120"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105119"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105118"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105117"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105116"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-279"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105120"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105119"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105118"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105117"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105116"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-280"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ContT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105114"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105121"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105120"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105119"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105118"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105117"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105116"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-281"></span><span class="hs-comment">-- Unlike in the recursive case we don't have any stage separation here.</span><span>
</span><span id="line-282"></span><span class="hs-comment">--</span><span>
</span><span id="line-283"></span><span class="hs-comment">-- 'TypeBind' is the simplest case: the body of the binding gets renamed first, then the name of</span><span>
</span><span id="line-284"></span><span class="hs-comment">-- the binding is brought in scope (not the other way around! As that would bring the name of the</span><span>
</span><span id="line-285"></span><span class="hs-comment">-- binding in scope in its own body, which is very wrong in the non-recursive case) and the</span><span>
</span><span id="line-286"></span><span class="hs-comment">-- renamed 'TypeBind' is passed to the continuation.</span><span>
</span><span id="line-287"></span><span class="hs-comment">--</span><span>
</span><span id="line-288"></span><span class="hs-comment">-- 'TermBind' also requires us to discharge the computation returning a variable with a renamed term-- before feeding the continuation. The reason why 'withFreshenedVarDecl' provides the caller with a</span><span>
</span><span id="line-289"></span><span class="hs-comment">-- computation rather than a pure term is because that is how we bring mutually recursive bindings</span><span>
</span><span id="line-290"></span><span class="hs-comment">-- in scope first without renaming their types right away (as those can reference type bindings from</span><span>
</span><span id="line-291"></span><span class="hs-comment">-- the same family) while still being able to perform the renaming later. But we don't need that</span><span>
</span><span id="line-292"></span><span class="hs-comment">-- stage separation in the non-recursive case, hence the type of the binding is renamed right away.</span><span>
</span><span id="line-293"></span><span class="hs-comment">--</span><span>
</span><span id="line-294"></span><span class="hs-comment">-- 'DatatypeBind' is handled the same way as 'TermBind' except all the work is performed in</span><span>
</span><span id="line-295"></span><span class="hs-comment">-- 'renameDatatypeCM' and here we just unwrap from 'ContT' and perform all the renaming saved for</span><span>
</span><span id="line-296"></span><span class="hs-comment">-- stage two immediately just like in the 'TermBind' case and for the same reason.</span><span>
</span><span id="line-297"></span><span id="renameBindingNonRecC"><span class="annot"><span class="annottext">renameBindingNonRecC :: forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Binding tyname name uni fun ann
-&gt; ContT c m (Binding tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameBindingNonRecC"><span class="hs-identifier hs-var hs-var">renameBindingNonRecC</span></a></span></span><span> </span><span id="local-6989586621681104792"><span class="annot"><span class="annottext">Binding tyname name uni fun ann
</span><a href="#local-6989586621681104792"><span class="hs-identifier hs-var">binding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104791"><span class="annot"><span class="annottext">Binding tyname name uni fun ann -&gt; m c
</span><a href="#local-6989586621681104791"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Binding tyname name uni fun ann
</span><a href="#local-6989586621681104792"><span class="hs-identifier hs-var">binding</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-298"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span id="local-6989586621681104789"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104789"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104788"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681104788"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681104787"><span class="annot"><span class="annottext">VarDecl tyname name uni ann
</span><a href="#local-6989586621681104787"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621681104786"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104786"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-299"></span><span>        </span><span id="local-6989586621681104785"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104785"><span class="hs-identifier hs-var">termFr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104786"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-300"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun ann (m :: * -&gt; *) c.
(HasUniques (Term tyname name uni fun ann), MonadQuote m,
 MonadReader ScopedRenaming m) =&gt;
VarDecl tyname name uni ann
-&gt; (m (VarDecl tyname name uni ann) -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Internal.html#withFreshenedVarDecl"><span class="hs-identifier hs-var">PLC.withFreshenedVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni ann
</span><a href="#local-6989586621681104787"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104783"><span class="annot"><span class="annottext">m (VarDecl tyname name uni ann)
</span><a href="#local-6989586621681104783"><span class="hs-identifier hs-var">varRen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-301"></span><span>            </span><span id="local-6989586621681104782"><span class="annot"><span class="annottext">VarDecl tyname name uni ann
</span><a href="#local-6989586621681104782"><span class="hs-identifier hs-var">varFr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">m (VarDecl tyname name uni ann)
</span><a href="#local-6989586621681104783"><span class="hs-identifier hs-var">varRen</span></a></span><span>
</span><span id="line-302"></span><span>            </span><span class="annot"><span class="annottext">Binding tyname name uni fun ann -&gt; m c
</span><a href="#local-6989586621681104791"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104789"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681104788"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni ann
</span><a href="#local-6989586621681104782"><span class="hs-identifier hs-var">varFr</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104785"><span class="hs-identifier hs-var">termFr</span></a></span><span>
</span><span id="line-303"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span id="local-6989586621681104780"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104780"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104779"><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104779"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621681104778"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104778"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-304"></span><span>        </span><span id="local-6989586621681104777"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104777"><span class="hs-identifier hs-var">tyFr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104778"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-305"></span><span>        </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *) c.
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
TyVarDecl tyname ann -&gt; (TyVarDecl tyname ann -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Internal.html#withFreshenedTyVarDecl"><span class="hs-identifier hs-var">PLC.withFreshenedTyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104779"><span class="hs-identifier hs-var">var</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104776"><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104776"><span class="hs-identifier hs-var">varFr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-306"></span><span>            </span><span class="annot"><span class="annottext">Binding tyname name uni fun ann -&gt; m c
</span><a href="#local-6989586621681104791"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-var">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104780"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104776"><span class="hs-identifier hs-var">varFr</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104777"><span class="hs-identifier hs-var">tyFr</span></a></span><span>
</span><span id="line-307"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span id="local-6989586621681104774"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104774"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104773"><span class="annot"><span class="annottext">Datatype tyname name uni ann
</span><a href="#local-6989586621681104773"><span class="hs-identifier hs-var">datatype</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-308"></span><span>        </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
ContT r m a -&gt; (a -&gt; m r) -&gt; m r
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runContT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Recursivity
-&gt; Datatype tyname name uni ann
-&gt; ContT c m (m (Datatype tyname name uni ann))
</span><a href="PlutusIR.Transform.Rename.html#renameDatatypeCM"><span class="hs-identifier hs-var">renameDatatypeCM</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype tyname name uni ann
</span><a href="#local-6989586621681104773"><span class="hs-identifier hs-var">datatype</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104772"><span class="annot"><span class="annottext">m (Datatype tyname name uni ann)
</span><a href="#local-6989586621681104772"><span class="hs-identifier hs-var">datatypeRen</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-309"></span><span>            </span><span class="annot"><span class="annottext">m (Datatype tyname name uni ann)
</span><a href="#local-6989586621681104772"><span class="hs-identifier hs-var">datatypeRen</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Binding tyname name uni fun ann -&gt; m c
</span><a href="#local-6989586621681104791"><span class="hs-identifier hs-var">cont</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Datatype tyname name uni a -&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-var">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104774"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-310"></span><span>
</span><span id="line-311"></span><span class="hs-comment">-- | Rename a 'Binding' from a recursive family in the CPS-transformed 'ScopedRenameM' monad.</span><span>
</span><span id="line-312"></span><span id="local-6989586621681105084"><span id="local-6989586621681105085"><span id="local-6989586621681105086"><span id="local-6989586621681105087"><span id="local-6989586621681105088"><span id="local-6989586621681105089"><span id="local-6989586621681105090"><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameBindingRecCM"><span class="hs-identifier hs-type">renameBindingRecCM</span></a></span><span>
</span><span id="line-313"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105090"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105089"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105088"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105087"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105086"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105085"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-314"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105089"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105088"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105087"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105086"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105085"><span class="hs-identifier hs-type">ann</span></a></span><span>
</span><span id="line-315"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-type">ContT</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105084"><span class="hs-identifier hs-type">c</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621681105090"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105089"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105088"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105087"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105086"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105085"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span></span></span></span></span></span></span></span><span>
</span><span id="line-316"></span><span id="renameBindingRecCM"><span class="annot"><span class="annottext">renameBindingRecCM :: forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Binding tyname name uni fun ann
-&gt; ContT c m (m (Binding tyname name uni fun ann))
</span><a href="PlutusIR.Transform.Rename.html#renameBindingRecCM"><span class="hs-identifier hs-var hs-var">renameBindingRecCM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-317"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-type">TermBind</span></a></span><span> </span><span id="local-6989586621681104736"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104736"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104735"><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681104735"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span id="local-6989586621681104734"><span class="annot"><span class="annottext">VarDecl tyname name uni ann
</span><a href="#local-6989586621681104734"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621681104733"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104733"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-318"></span><span>        </span><span class="hs-comment">-- The first stage (the variable gets renamed).</span><span>
</span><span id="line-319"></span><span>        </span><span id="local-6989586621681104732"><span class="annot"><span class="annottext">m (VarDecl tyname name uni ann)
</span><a href="#local-6989586621681104732"><span class="hs-identifier hs-var">varRen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun ann (m :: * -&gt; *) c.
(HasUniques (Term tyname name uni fun ann), MonadQuote m,
 MonadReader ScopedRenaming m) =&gt;
VarDecl tyname name uni ann
-&gt; (m (VarDecl tyname name uni ann) -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Internal.html#withFreshenedVarDecl"><span class="hs-identifier hs-var">PLC.withFreshenedVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">VarDecl tyname name uni ann
</span><a href="#local-6989586621681104734"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-320"></span><span>        </span><span class="hs-comment">-- The second stage (the type of the variable and the RHS get renamed).</span><span>
</span><span id="line-321"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Strictness
-&gt; VarDecl tyname name uni a
-&gt; Term tyname name uni fun a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TermBind"><span class="hs-identifier hs-var">TermBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104736"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Strictness
</span><a href="#local-6989586621681104735"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (VarDecl tyname name uni ann)
</span><a href="#local-6989586621681104732"><span class="hs-identifier hs-var">varRen</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104733"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-322"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-type">TypeBind</span></a></span><span> </span><span id="local-6989586621681104731"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104731"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104730"><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104730"><span class="hs-identifier hs-var">var</span></a></span></span><span> </span><span id="local-6989586621681104729"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104729"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-323"></span><span>        </span><span class="hs-comment">-- The first stage (the variable gets renamed).</span><span>
</span><span id="line-324"></span><span>        </span><span id="local-6989586621681104728"><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104728"><span class="hs-identifier hs-var">varFr</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
((a -&gt; m r) -&gt; m r) -&gt; ContT r m a
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">ContT</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *) c.
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
TyVarDecl tyname ann -&gt; (TyVarDecl tyname ann -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Internal.html#withFreshenedTyVarDecl"><span class="hs-identifier hs-var">PLC.withFreshenedTyVarDecl</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104730"><span class="hs-identifier hs-var">var</span></a></span><span>
</span><span id="line-325"></span><span>        </span><span class="hs-comment">-- The second stage (the RHS gets renamed).</span><span>
</span><span id="line-326"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; TyVarDecl tyname a
-&gt; Type tyname uni a
-&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TypeBind"><span class="hs-identifier hs-var">TypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104731"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TyVarDecl tyname ann
</span><a href="#local-6989586621681104728"><span class="hs-identifier hs-var">varFr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104729"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-327"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-type">DatatypeBind</span></a></span><span> </span><span id="local-6989586621681104727"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104727"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104726"><span class="annot"><span class="annottext">Datatype tyname name uni ann
</span><a href="#local-6989586621681104726"><span class="hs-identifier hs-var">datatype</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-328"></span><span>        </span><span class="hs-comment">-- The first stage.</span><span>
</span><span id="line-329"></span><span>        </span><span id="local-6989586621681104725"><span class="annot"><span class="annottext">m (Datatype tyname name uni ann)
</span><a href="#local-6989586621681104725"><span class="hs-identifier hs-var">datatypeRen</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Recursivity
-&gt; Datatype tyname name uni ann
-&gt; ContT c m (m (Datatype tyname name uni ann))
</span><a href="PlutusIR.Transform.Rename.html#renameDatatypeCM"><span class="hs-identifier hs-var">renameDatatypeCM</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span> </span><span class="annot"><span class="annottext">Datatype tyname name uni ann
</span><a href="#local-6989586621681104726"><span class="hs-identifier hs-var">datatype</span></a></span><span>
</span><span id="line-330"></span><span>        </span><span class="hs-comment">-- The second stage.</span><span>
</span><span id="line-331"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Datatype tyname name uni a -&gt; Binding tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#DatatypeBind"><span class="hs-identifier hs-var">DatatypeBind</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104727"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">m (Datatype tyname name uni ann)
</span><a href="#local-6989586621681104725"><span class="hs-identifier hs-var">datatypeRen</span></a></span><span>
</span><span id="line-332"></span><span>
</span><span id="line-333"></span><span class="hs-comment">-- | Replace the uniques in the names stored in a bunch of bindings by new uniques,</span><span>
</span><span id="line-334"></span><span class="hs-comment">-- save the mapping from the old uniques to the new ones, rename the RHSs and</span><span>
</span><span id="line-335"></span><span class="hs-comment">-- supply the updated bindings to a continuation.</span><span>
</span><span id="line-336"></span><span id="local-6989586621681105070"><span id="local-6989586621681105071"><span id="local-6989586621681105072"><span id="local-6989586621681105073"><span id="local-6989586621681105074"><span id="local-6989586621681105075"><span id="local-6989586621681105076"><span class="annot"><a href="PlutusIR.Transform.Rename.html#withFreshenedBindings"><span class="hs-identifier hs-type">withFreshenedBindings</span></a></span><span>
</span><span id="line-337"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105076"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105075"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105074"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105073"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105072"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105071"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-338"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Recursivity"><span class="hs-identifier hs-type">Recursivity</span></a></span><span>
</span><span id="line-339"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105075"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105074"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105073"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105072"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105071"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-340"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">NonEmpty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Binding"><span class="hs-identifier hs-type">Binding</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105075"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105074"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105073"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105072"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105071"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105076"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105070"><span class="hs-identifier hs-type">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-341"></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105076"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105070"><span class="hs-identifier hs-type">c</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-342"></span><span id="withFreshenedBindings"><span class="annot"><span class="annottext">withFreshenedBindings :: forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Recursivity
-&gt; NonEmpty (Binding tyname name uni fun ann)
-&gt; (NonEmpty (Binding tyname name uni fun ann) -&gt; m c)
-&gt; m c
</span><a href="PlutusIR.Transform.Rename.html#withFreshenedBindings"><span class="hs-identifier hs-var hs-var">withFreshenedBindings</span></a></span></span><span> </span><span id="local-6989586621681104706"><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681104706"><span class="hs-identifier hs-var">recy</span></a></span></span><span> </span><span id="local-6989586621681104705"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681104705"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621681104704"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann) -&gt; m c
</span><a href="#local-6989586621681104704"><span class="hs-identifier hs-var">cont</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681104706"><span class="hs-identifier hs-var">recy</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-343"></span><span>    </span><span class="hs-comment">-- Bring each binding in scope, rename its RHS straight away, collect all the results and</span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-comment">-- supply them to the continuation.</span><span>
</span><span id="line-345"></span><span>    </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#NonRec"><span class="hs-identifier hs-var">NonRec</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
ContT r m a -&gt; (a -&gt; m r) -&gt; m r
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runContT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Binding tyname name uni fun ann
-&gt; ContT c m (Binding tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameBindingNonRecC"><span class="hs-identifier hs-var">renameBindingNonRecC</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681104705"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann) -&gt; m c
</span><a href="#local-6989586621681104704"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-comment">-- First bring all bindinds in scope and only then rename their RHSs and</span><span>
</span><span id="line-347"></span><span>    </span><span class="hs-comment">-- supply the results to the continuation.</span><span>
</span><span id="line-348"></span><span>    </span><span class="annot"><span class="annottext">Recursivity
</span><a href="PlutusIR.Core.Type.html#Rec"><span class="hs-identifier hs-var">Rec</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall {k} (r :: k) (m :: k -&gt; *) a.
ContT r m a -&gt; (a -&gt; m r) -&gt; m r
</span><a href="../../../../ghc/html/libraries/transformers-0.5.6.2/src"><span class="hs-identifier hs-var">runContT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (f :: * -&gt; *) a b.
(Traversable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f (t b)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">traverse</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Binding tyname name uni fun ann
-&gt; ContT c m (m (Binding tyname name uni fun ann))
</span><a href="PlutusIR.Transform.Rename.html#renameBindingRecCM"><span class="hs-identifier hs-var">renameBindingRecCM</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681104705"><span class="hs-identifier hs-var">binds</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) (m :: * -&gt; *) a.
(Traversable t, Monad m) =&gt;
t (m a) -&gt; m (t a)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">sequence</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b c.
Monad m =&gt;
(a -&gt; m b) -&gt; (b -&gt; m c) -&gt; a -&gt; m c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;=&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann) -&gt; m c
</span><a href="#local-6989586621681104704"><span class="hs-identifier hs-var">cont</span></a></span><span>
</span><span id="line-349"></span><span>
</span><span id="line-350"></span><span class="hs-comment">-- | Rename a 'Term' in the 'ScopedRenameM' monad.</span><span>
</span><span id="line-351"></span><span id="local-6989586621681105266"><span id="local-6989586621681105267"><span id="local-6989586621681105268"><span id="local-6989586621681105269"><span id="local-6989586621681105270"><span id="local-6989586621681105271"><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-type">renameTermM</span></a></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105271"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105270"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105269"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105268"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105267"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105266"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105270"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105269"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105268"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105267"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105266"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105271"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105270"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105269"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105268"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105267"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105266"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-354"></span><span id="renameTermM"><span class="annot"><span class="annottext">renameTermM :: forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var hs-var">renameTermM</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-355"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-type">Let</span></a></span><span> </span><span id="local-6989586621681104627"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104627"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104626"><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681104626"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span id="local-6989586621681104625"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681104625"><span class="hs-identifier hs-var">binds</span></a></span></span><span> </span><span id="local-6989586621681104624"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104624"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-356"></span><span>        </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann c.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Recursivity
-&gt; NonEmpty (Binding tyname name uni fun ann)
-&gt; (NonEmpty (Binding tyname name uni fun ann) -&gt; m c)
-&gt; m c
</span><a href="PlutusIR.Transform.Rename.html#withFreshenedBindings"><span class="hs-identifier hs-var">withFreshenedBindings</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681104626"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681104625"><span class="hs-identifier hs-var">binds</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104623"><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681104623"><span class="hs-identifier hs-var">bindsFr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-357"></span><span>            </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Recursivity
-&gt; NonEmpty (Binding tyname name uni fun a)
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Let"><span class="hs-identifier hs-var">Let</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104627"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Recursivity
</span><a href="#local-6989586621681104626"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="annot"><span class="annottext">NonEmpty (Binding tyname name uni fun ann)
</span><a href="#local-6989586621681104623"><span class="hs-identifier hs-var">bindsFr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104624"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-358"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-type">Var</span></a></span><span> </span><span id="local-6989586621681104621"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104621"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104620"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104620"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-359"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; name -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Var"><span class="hs-identifier hs-var">Var</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104621"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren unique name (m :: * -&gt; *).
(HasRenaming ren unique, HasUnique name unique,
 MonadReader ren m) =&gt;
name -&gt; m name
</span><a href="PlutusCore.Rename.Monad.html#renameNameM"><span class="hs-identifier hs-var">PLC.renameNameM</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104620"><span class="hs-identifier hs-var">name</span></a></span><span>
</span><span id="line-360"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-type">TyAbs</span></a></span><span> </span><span id="local-6989586621681104618"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104618"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104617"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104617"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681104616"><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681104616"><span class="hs-identifier hs-var">kind</span></a></span></span><span> </span><span id="local-6989586621681104615"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104615"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-361"></span><span>        </span><span class="annot"><span class="annottext">forall ren unique name (m :: * -&gt; *) c.
(HasRenaming ren unique, HasUnique name unique, MonadQuote m,
 MonadReader ren m) =&gt;
name -&gt; (name -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Monad.html#withFreshenedName"><span class="hs-identifier hs-var">PLC.withFreshenedName</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104617"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104614"><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104614"><span class="hs-identifier hs-var">nameFr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-362"></span><span>            </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; tyname
-&gt; Kind a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyAbs"><span class="hs-identifier hs-var">TyAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104618"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">tyname
</span><a href="#local-6989586621681104614"><span class="hs-identifier hs-var">nameFr</span></a></span><span> </span><span class="annot"><span class="annottext">Kind ann
</span><a href="#local-6989586621681104616"><span class="hs-identifier hs-var">kind</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104615"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-363"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-type">LamAbs</span></a></span><span> </span><span id="local-6989586621681104612"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104612"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104611"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104611"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621681104610"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104610"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span id="local-6989586621681104609"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104609"><span class="hs-identifier hs-var">body</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-364"></span><span>        </span><span class="annot"><span class="annottext">forall ren unique name (m :: * -&gt; *) c.
(HasRenaming ren unique, HasUnique name unique, MonadQuote m,
 MonadReader ren m) =&gt;
name -&gt; (name -&gt; m c) -&gt; m c
</span><a href="PlutusCore.Rename.Monad.html#withFreshenedName"><span class="hs-identifier hs-var">PLC.withFreshenedName</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104611"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621681104608"><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104608"><span class="hs-identifier hs-var">nameFr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-365"></span><span>            </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; name
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#LamAbs"><span class="hs-identifier hs-var">LamAbs</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104612"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">name
</span><a href="#local-6989586621681104608"><span class="hs-identifier hs-var">nameFr</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104610"><span class="hs-identifier hs-var">ty</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104609"><span class="hs-identifier hs-var">body</span></a></span><span>
</span><span id="line-366"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-type">Apply</span></a></span><span> </span><span id="local-6989586621681104606"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104606"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104605"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104605"><span class="hs-identifier hs-var">fun</span></a></span></span><span> </span><span id="local-6989586621681104604"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104604"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-367"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Apply"><span class="hs-identifier hs-var">Apply</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104606"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104605"><span class="hs-identifier hs-var">fun</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104604"><span class="hs-identifier hs-var">arg</span></a></span><span>
</span><span id="line-368"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-type">Constant</span></a></span><span> </span><span id="local-6989586621681104602"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104602"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104601"><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><a href="#local-6989586621681104601"><span class="hs-identifier hs-var">con</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-369"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Some (ValueOf uni) -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Constant"><span class="hs-identifier hs-var">Constant</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104602"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Some (ValueOf uni)
</span><a href="#local-6989586621681104601"><span class="hs-identifier hs-var">con</span></a></span><span>
</span><span id="line-370"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-type">Builtin</span></a></span><span> </span><span id="local-6989586621681104599"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104599"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104598"><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681104598"><span class="hs-identifier hs-var">bi</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-371"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; fun -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Builtin"><span class="hs-identifier hs-var">Builtin</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104599"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">fun
</span><a href="#local-6989586621681104598"><span class="hs-identifier hs-var">bi</span></a></span><span>
</span><span id="line-372"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-type">TyInst</span></a></span><span> </span><span id="local-6989586621681104596"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104596"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104595"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104595"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span id="local-6989586621681104594"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104594"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-373"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Term tyname name uni fun a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#TyInst"><span class="hs-identifier hs-var">TyInst</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104596"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104595"><span class="hs-identifier hs-var">term</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104594"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-374"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-type">Error</span></a></span><span> </span><span id="local-6989586621681104592"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104592"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104591"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104591"><span class="hs-identifier hs-var">ty</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-375"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Type tyname uni a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Error"><span class="hs-identifier hs-var">Error</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104592"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104591"><span class="hs-identifier hs-var">ty</span></a></span><span>
</span><span id="line-376"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-type">IWrap</span></a></span><span> </span><span id="local-6989586621681104589"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104589"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104588"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104588"><span class="hs-identifier hs-var">pat</span></a></span></span><span> </span><span id="local-6989586621681104587"><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104587"><span class="hs-identifier hs-var">arg</span></a></span></span><span> </span><span id="local-6989586621681104586"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104586"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-377"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a
-&gt; Type tyname uni a
-&gt; Type tyname uni a
-&gt; Term tyname name uni fun a
-&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#IWrap"><span class="hs-identifier hs-var">IWrap</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104589"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104588"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall ren tyname (uni :: * -&gt; *) ann (m :: * -&gt; *).
(HasRenaming ren TypeUnique, HasUniques (Type tyname uni ann),
 MonadQuote m, MonadReader ren m) =&gt;
Type tyname uni ann -&gt; m (Type tyname uni ann)
</span><a href="PlutusCore.Rename.Internal.html#renameTypeM"><span class="hs-identifier hs-var">PLC.renameTypeM</span></a></span><span> </span><span class="annot"><span class="annottext">Type tyname uni ann
</span><a href="#local-6989586621681104587"><span class="hs-identifier hs-var">arg</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104586"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-378"></span><span>    </span><span class="annot"><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-type">Unwrap</span></a></span><span> </span><span id="local-6989586621681104584"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104584"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span id="local-6989586621681104583"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104583"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-379"></span><span>        </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun a.
a -&gt; Term tyname name uni fun a -&gt; Term tyname name uni fun a
</span><a href="PlutusIR.Core.Type.html#Unwrap"><span class="hs-identifier hs-var">Unwrap</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104584"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104583"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-380"></span><span>
</span><span id="line-381"></span><span class="hs-comment">-- | Rename a 'Term' in the 'ScopedRenameM' monad.</span><span>
</span><span id="line-382"></span><span id="local-6989586621681105044"><span id="local-6989586621681105045"><span id="local-6989586621681105046"><span id="local-6989586621681105047"><span id="local-6989586621681105048"><span id="local-6989586621681105049"><span class="annot"><a href="PlutusIR.Transform.Rename.html#renameProgramM"><span class="hs-identifier hs-type">renameProgramM</span></a></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Transform.Rename.html#MonadRename"><span class="hs-identifier hs-type">MonadRename</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105049"><span class="hs-identifier hs-type">m</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Core.Type.html#HasUniques"><span class="hs-identifier hs-type">PLC.HasUniques</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Term"><span class="hs-identifier hs-type">Term</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105048"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105047"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105046"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105045"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105044"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-384"></span><span>    </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105048"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105047"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105046"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105045"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105044"><span class="hs-identifier hs-type">ann</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621681105049"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105048"><span class="hs-identifier hs-type">tyname</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105047"><span class="hs-identifier hs-type">name</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105046"><span class="hs-identifier hs-type">uni</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105045"><span class="hs-identifier hs-type">fun</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681105044"><span class="hs-identifier hs-type">ann</span></a></span><span class="hs-special">)</span></span></span></span></span></span></span><span>
</span><span id="line-385"></span><span id="renameProgramM"><span class="annot"><span class="annottext">renameProgramM :: forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Program tyname name uni fun ann
-&gt; m (Program tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameProgramM"><span class="hs-identifier hs-var hs-var">renameProgramM</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-type">Program</span></a></span><span> </span><span id="local-6989586621681104572"><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104572"><span class="hs-identifier hs-var">ann</span></a></span></span><span> </span><span id="local-6989586621681104571"><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104571"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall tyname name (uni :: * -&gt; *) fun ann.
ann
-&gt; Term tyname name uni fun ann -&gt; Program tyname name uni fun ann
</span><a href="PlutusIR.Core.Type.html#Program"><span class="hs-identifier hs-var">Program</span></a></span><span> </span><span class="annot"><span class="annottext">ann
</span><a href="#local-6989586621681104572"><span class="hs-identifier hs-var">ann</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) tyname name (uni :: * -&gt; *) fun ann.
(MonadRename m, HasUniques (Term tyname name uni fun ann)) =&gt;
Term tyname name uni fun ann -&gt; m (Term tyname name uni fun ann)
</span><a href="PlutusIR.Transform.Rename.html#renameTermM"><span class="hs-identifier hs-var">renameTermM</span></a></span><span> </span><span class="annot"><span class="annottext">Term tyname name uni fun ann
</span><a href="#local-6989586621681104571"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-386"></span></pre></body></html>