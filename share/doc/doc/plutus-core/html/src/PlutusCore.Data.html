<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621681024300"><span id="local-6989586621681024301"><span id="local-6989586621681024302"><span id="local-6989586621681024303"><span id="local-6989586621681024304"><span id="local-6989586621681024305"></span></span></span></span></span></span><span class="hs-comment">-- editorconfig-checker-disable-file</span><span>
</span><span id="line-2"></span><span class="hs-pragma">{-# LANGUAGE BangPatterns       #-}</span><span>
</span><span id="line-3"></span><span class="hs-pragma">{-# LANGUAGE DeriveAnyClass     #-}</span><span>
</span><span id="line-4"></span><span class="hs-pragma">{-# LANGUAGE DeriveDataTypeable #-}</span><span>
</span><span id="line-5"></span><span class="hs-pragma">{-# LANGUAGE DerivingStrategies #-}</span><span>
</span><span id="line-6"></span><span class="hs-pragma">{-# LANGUAGE LambdaCase         #-}</span><span>
</span><span id="line-7"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings  #-}</span><span>
</span><span id="line-8"></span><span class="hs-pragma">{-# LANGUAGE TypeApplications   #-}</span><span>
</span><span id="line-9"></span><span>
</span><span id="line-10"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">PlutusCore.Data</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier">Data</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Codec.CBOR.Decoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Decoder</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Codec.CBOR.Decoding</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CBOR</span></span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Codec.CBOR.Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Encoding</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Codec.CBOR.Encoding</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CBOR</span></span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">Codec.CBOR.Magic</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">CBOR</span></span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../serialise/html/src"><span class="hs-identifier">Codec.Serialise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../serialise/html/src"><span class="hs-identifier">Serialise</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../serialise/html/src"><span class="hs-identifier">decode</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../serialise/html/src"><span class="hs-identifier">encode</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../serialise/html/src"><span class="hs-identifier">Codec.Serialise.Decoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">decodeSequenceLenIndef</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier">decodeSequenceLenN</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">NFData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/mtl-2.2.2/src"><span class="hs-identifier">Control.Monad.Except</span></a></span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Bits</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">shiftR</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">Data.ByteString</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BS</span></span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../base64-bytestring/html/src"><span class="hs-identifier">Data.ByteString.Base64</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Base64</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">Data.ByteString.Lazy</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BSL</span></span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Data</span></a></span><span> </span><span class="hs-keyword">qualified</span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/text-1.2.5.0/src"><span class="hs-identifier">Data.Text.Encoding</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-27"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Word</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word64</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Word8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Prelude</span></a></span><span>
</span><span id="line-30"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../../prettyprinter/html/src"><span class="hs-identifier">Prettyprinter</span></a></span><span>
</span><span id="line-31"></span><span>
</span><span id="line-32"></span><span class="hs-comment">-- Attempting to make this strict made code slower by 2%,</span><span>
</span><span id="line-33"></span><span class="hs-comment">-- see https://github.com/input-output-hk/plutus/pull/4622</span><span>
</span><span id="line-34"></span><span class="hs-comment">-- | A generic &quot;data&quot; type.</span><span>
</span><span id="line-35"></span><span class="hs-comment">--</span><span>
</span><span id="line-36"></span><span class="hs-comment">-- The main constructor 'Constr' represents a datatype value in sum-of-products</span><span>
</span><span id="line-37"></span><span class="hs-comment">-- form: @Constr i args@ represents a use of the @i@th constructor along with its arguments.</span><span>
</span><span id="line-38"></span><span class="hs-comment">--</span><span>
</span><span id="line-39"></span><span class="hs-comment">-- The other constructors are various primitives.</span><span>
</span><span id="line-40"></span><span id="local-6989586621681024205"><span id="local-6989586621681024206"></span></span><span class="hs-keyword">data</span><span> </span><span id="Data"><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-var">Data</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-41"></span><span>      </span><span id="Constr"><span class="annot"><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="Map"><span class="annot"><a href="PlutusCore.Data.html#Map"><span class="hs-identifier hs-var">Map</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="List"><span class="annot"><a href="PlutusCore.Data.html#List"><span class="hs-identifier hs-var">List</span></a></span></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="I"><span class="annot"><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-var">I</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span id="B"><span class="annot"><a href="PlutusCore.Data.html#B"><span class="hs-identifier hs-var">B</span></a></span></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681024178"><span id="local-6989586621681024180"><span id="local-6989586621681024198"><span class="annot"><span class="annottext">Int -&gt; Data -&gt; ShowS
[Data] -&gt; ShowS
Data -&gt; String
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; String) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [Data] -&gt; ShowS
$cshowList :: [Data] -&gt; ShowS
show :: Data -&gt; String
$cshow :: Data -&gt; String
showsPrec :: Int -&gt; Data -&gt; ShowS
$cshowsPrec :: Int -&gt; Data -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024162"><span id="local-6989586621681024174"><span class="annot"><span class="annottext">Data -&gt; Data -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: Data -&gt; Data -&gt; Bool
$c/= :: Data -&gt; Data -&gt; Bool
== :: Data -&gt; Data -&gt; Bool
$c== :: Data -&gt; Data -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024134"><span id="local-6989586621681024136"><span id="local-6989586621681024138"><span id="local-6989586621681024140"><span id="local-6989586621681024142"><span id="local-6989586621681024144"><span id="local-6989586621681024156"><span class="annot"><span class="annottext">Eq Data
Data -&gt; Data -&gt; Bool
Data -&gt; Data -&gt; Ordering
Data -&gt; Data -&gt; Data
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: Data -&gt; Data -&gt; Data
$cmin :: Data -&gt; Data -&gt; Data
max :: Data -&gt; Data -&gt; Data
$cmax :: Data -&gt; Data -&gt; Data
&gt;= :: Data -&gt; Data -&gt; Bool
$c&gt;= :: Data -&gt; Data -&gt; Bool
&gt; :: Data -&gt; Data -&gt; Bool
$c&gt; :: Data -&gt; Data -&gt; Bool
&lt;= :: Data -&gt; Data -&gt; Bool
$c&lt;= :: Data -&gt; Data -&gt; Bool
&lt; :: Data -&gt; Data -&gt; Bool
$c&lt; :: Data -&gt; Data -&gt; Bool
compare :: Data -&gt; Data -&gt; Ordering
$ccompare :: Data -&gt; Data -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep Data x -&gt; Data
forall x. Data -&gt; Rep Data x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep Data x -&gt; Data
$cfrom :: forall x. Data -&gt; Rep Data x
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024080"><span id="local-6989586621681024082"><span id="local-6989586621681024084"><span id="local-6989586621681024086"><span id="local-6989586621681024088"><span id="local-6989586621681024090"><span id="local-6989586621681024092"><span id="local-6989586621681024094"><span id="local-6989586621681024096"><span id="local-6989586621681024098"><span id="local-6989586621681024100"><span id="local-6989586621681024102"><span id="local-6989586621681024112"><span id="local-6989586621681024125"><span class="annot"><span class="annottext">Typeable Data
Data -&gt; DataType
Data -&gt; Constr
(forall b. Data b =&gt; b -&gt; b) -&gt; Data -&gt; Data
forall a.
Typeable a
-&gt; (forall (c :: * -&gt; *).
    (forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
    -&gt; (forall g. g -&gt; c g) -&gt; a -&gt; c a)
-&gt; (forall (c :: * -&gt; *).
    (forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
    -&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c a)
-&gt; (a -&gt; Constr)
-&gt; (a -&gt; DataType)
-&gt; (forall (t :: * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d. Data d =&gt; c (t d)) -&gt; Maybe (c a))
-&gt; (forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
    Typeable t =&gt;
    (forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c a))
-&gt; ((forall b. Data b =&gt; b -&gt; b) -&gt; a -&gt; a)
-&gt; (forall r r'.
    (r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall r r'.
    (r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; a -&gt; r)
-&gt; (forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; [u])
-&gt; (forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; a -&gt; u)
-&gt; (forall (m :: * -&gt; *).
    Monad m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; (forall (m :: * -&gt; *).
    MonadPlus m =&gt;
    (forall d. Data d =&gt; d -&gt; m d) -&gt; a -&gt; m a)
-&gt; Data a
forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Data -&gt; u
forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Data -&gt; [u]
forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Data -&gt; r
forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Data -&gt; r
forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Data
forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Data -&gt; c Data
forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Data)
forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Data)
gmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
$cgmapMo :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
gmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
$cgmapMp :: forall (m :: * -&gt; *).
MonadPlus m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
gmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
$cgmapM :: forall (m :: * -&gt; *).
Monad m =&gt;
(forall d. Data d =&gt; d -&gt; m d) -&gt; Data -&gt; m Data
gmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Data -&gt; u
$cgmapQi :: forall u. Int -&gt; (forall d. Data d =&gt; d -&gt; u) -&gt; Data -&gt; u
gmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Data -&gt; [u]
$cgmapQ :: forall u. (forall d. Data d =&gt; d -&gt; u) -&gt; Data -&gt; [u]
gmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Data -&gt; r
$cgmapQr :: forall r r'.
(r' -&gt; r -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Data -&gt; r
gmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Data -&gt; r
$cgmapQl :: forall r r'.
(r -&gt; r' -&gt; r) -&gt; r -&gt; (forall d. Data d =&gt; d -&gt; r') -&gt; Data -&gt; r
gmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Data -&gt; Data
$cgmapT :: (forall b. Data b =&gt; b -&gt; b) -&gt; Data -&gt; Data
dataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Data)
$cdataCast2 :: forall (t :: * -&gt; * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d e. (Data d, Data e) =&gt; c (t d e)) -&gt; Maybe (c Data)
dataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Data)
$cdataCast1 :: forall (t :: * -&gt; *) (c :: * -&gt; *).
Typeable t =&gt;
(forall d. Data d =&gt; c (t d)) -&gt; Maybe (c Data)
dataTypeOf :: Data -&gt; DataType
$cdataTypeOf :: Data -&gt; DataType
toConstr :: Data -&gt; Constr
$ctoConstr :: Data -&gt; Constr
gunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Data
$cgunfold :: forall (c :: * -&gt; *).
(forall b r. Data b =&gt; c (b -&gt; r) -&gt; c r)
-&gt; (forall r. r -&gt; c r) -&gt; Constr -&gt; c Data
gfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Data -&gt; c Data
$cgfoldl :: forall (c :: * -&gt; *).
(forall d b. Data d =&gt; c (d -&gt; b) -&gt; d -&gt; c b)
-&gt; (forall g. g -&gt; c g) -&gt; Data -&gt; c Data
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Data.Data.Data</span></a></span></span></span></span></span></span></span></span></span></span></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">anyclass</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621681024076"><span class="annot"><span class="annottext">Data -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: Data -&gt; ()
$crnf :: Data -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681024072"><span class="annot"><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-type">Pretty</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-50"></span><span>    </span><span id="local-6989586621681024054"><span class="annot"><span class="annottext">pretty :: forall ann. Data -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">pretty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-51"></span><span>        </span><span class="annot"><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-identifier">_</span></span><span> </span><span id="local-6989586621681024052"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024052"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">angles</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024052"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span>        </span><span class="annot"><a href="PlutusCore.Data.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span id="local-6989586621681024047"><span class="annot"><span class="annottext">[(Data, Data)]
</span><a href="#local-6989586621681024047"><span class="hs-identifier hs-var">entries</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">braces</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621681024045"><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681024045"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681024044"><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681024044"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681024045"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Doc ann
</span><span class="hs-string">&quot;:&quot;</span></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-operator hs-var">&lt;+&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681024044"><span class="hs-identifier hs-var">v</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[(Data, Data)]
</span><a href="#local-6989586621681024047"><span class="hs-identifier hs-var">entries</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span>        </span><span class="annot"><a href="PlutusCore.Data.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span id="local-6989586621681024042"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024042"><span class="hs-identifier hs-var">ds</span></a></span></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">brackets</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. [Doc ann] -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">sep</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ann. Doc ann -&gt; [Doc ann] -&gt; [Doc ann]
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">punctuate</span></a></span><span> </span><span class="annot"><span class="annottext">forall ann. Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">comma</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024042"><span class="hs-identifier hs-var">ds</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-54"></span><span>        </span><span class="annot"><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621681024040"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024040"><span class="hs-identifier hs-var">i</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024040"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-55"></span><span>        </span><span class="annot"><a href="PlutusCore.Data.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span id="local-6989586621681024039"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681024039"><span class="hs-identifier hs-var">b</span></a></span></span><span>         </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-56"></span><span>            </span><span class="hs-comment">-- Base64 encode the ByteString since it may contain arbitrary bytes</span><span>
</span><span id="line-57"></span><span>            </span><span class="annot"><span class="annottext">forall a ann. Pretty a =&gt; a -&gt; Doc ann
</span><a href="../../../../prettyprinter/html/src"><span class="hs-identifier hs-var">pretty</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Text
</span><a href="../../../../ghc/html/libraries/text-1.2.5.0/src"><span class="hs-identifier hs-var">Text.decodeLatin1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../base64-bytestring/html/src"><span class="hs-identifier hs-var">Base64.encode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681024039"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span>
</span><span id="line-59"></span><span class="hs-comment">{- Note [Encoding via Term]
We want to write a custom encoder/decoder for Data (i.e. not use the Generic version), but actually
doing this is a pain. So instead we go via the CBOR 'Term' representation, which lets us process a
more structured representation, which is a lot easier.
-}</span><span>
</span><span id="line-64"></span><span>
</span><span id="line-65"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621681024031"><span id="local-6989586621681024033"><span class="annot"><a href="../../../../serialise/html/src"><span class="hs-identifier hs-type">Serialise</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-66"></span><span>    </span><span class="hs-comment">-- See Note [Encoding via Term]</span><span>
</span><span id="line-67"></span><span>    </span><span id="local-6989586621681024029"><span class="annot"><span class="annottext">encode :: Data -&gt; Encoding
</span><a href="#local-6989586621681024029"><span class="hs-identifier hs-var hs-var hs-var hs-var">encode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Data -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeData"><span class="hs-identifier hs-var">encodeData</span></a></span><span>
</span><span id="line-68"></span><span>    </span><span id="local-6989586621681024027"><span class="annot"><span class="annottext">decode :: forall s. Decoder s Data
</span><a href="#local-6989586621681024027"><span class="hs-identifier hs-var hs-var hs-var hs-var">decode</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var">decodeData</span></a></span><span>
</span><span id="line-69"></span><span>
</span><span id="line-70"></span><span class="hs-comment">{- Note [CBOR alternative tags]
We've proposed to add additional tags to the CBOR standard to cover (essentially) sum types.
This is exactly what we need to encode the 'Constr' constructor of 'Data' in an unambiguous way.

The tags aren't *quite* accepted yet, but they're clearly going to accept so we might as well
start using them.

The scheme is:
- Alternatives 0-6 -&gt; tags 121-127, followed by the arguments in a list
- Alternatives 7-127 -&gt; tags 1280-1400, followed by the arguments in a list
- Any alternatives, including those that don't fit in the above -&gt; tag 102 followed by a list containing
an unsigned integer for the actual alternative, and then the arguments in a (nested!) list.
-}</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-comment">{- Note [The 64-byte limit]
We impose a 64-byte *on-the-wire* limit on the leaves of a serialized 'Data'. This prevents people from inserting
Mickey Mouse entire.

The simplest way of doing this is to check during deserialization that we never deserialize something that uses
more than 64-bytes, and this is largely what we do. Then it's the user's problem to not produce something too big.

But this is quite inconvenient, so see Note [Evading the 64-byte limit] for how we get around this.
-}</span><span>
</span><span id="line-93"></span><span>
</span><span id="line-94"></span><span class="hs-comment">{- Note [Evading the 64-byte limit]
Implementing Note [The 64-byte limit] naively would be quite annoying:
- Users would be responsible for not creating Data values with leaves that were too big.
- If a script *required* such a thing (e.g. a counter that somehow got above 64 bytes), then the user is totally
stuck: the script demands something they cannot represent.

This is unpleasant and introduces limits. Probably limits that nobody will hit, but it's nicer to just not have them.
And it turns out that we can evade the problem with some clever encoding.

The fundamental
 trick is that an *indefinite-length* CBOR bytestring is just as obfuscated as a list of bytestrings,
since it consists of a list of definite-length chunks, and each definite-length chunk must be *tagged* (at least with the size).
So we get a sequence like:

   &lt;list start&gt;
   &lt;chunk length metadata&gt;
   &lt;chunk&gt;
   &lt;chunk length metadata&gt;
   ...
   &lt;list end&gt;

The chunk length metadata has a prescribed format, such that it's difficult to manipulate it so that it
matches your &quot;desired&quot; data.
So this effectively breaks up the bytestring in much the same way as a list of &lt;64 byte bytestrings.

So that solves the problem for bytestrings on the encoding side:
- if they are &lt;=64 bytes, we can just encode them as a normal bytestring
- if they are &gt;64 bytes, we encode them as indefinite-length bytestrings with 64-byte chunks

On the decoding side, we need to check when we decode that we never decode a definite-length
bytestring of &gt;64 bytes. That covers our two cases:
- Short definite-length bytestrings are fine
- Long indefinite-length bytestrings are just made of short definite-length bytestings.

Unfortunately this all means that we have to write our own encoders/decoders so we can produce
chunks of the right size and check the sizes when we decode, but that's okay. Users need to do the same
thing: anyone encoding `Data` with their own encoders who doesn't split up big bytestrings in this way
will get failures when we decode them.

For integers, we have two cases. Small integers (&lt;=64bits) can be encoded normally. Big integers are already
encoded *with a byte string*. The spec allows this to be an indefinite-length bytestring (although cborg doesn't
like it), so we can reuse our trick. Again, we need to write some manual encoders/decoders.
-}</span><span>
</span><span id="line-137"></span><span>
</span><span id="line-138"></span><span class="hs-comment">-- | Turn Data into a CBOR Term.</span><span>
</span><span id="line-139"></span><span class="annot"><a href="PlutusCore.Data.html#encodeData"><span class="hs-identifier hs-type">encodeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Encoding</span></a></span><span>
</span><span id="line-140"></span><span id="encodeData"><span class="annot"><span class="annottext">encodeData :: Data -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeData"><span class="hs-identifier hs-var hs-var">encodeData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-141"></span><span>    </span><span class="hs-comment">-- See Note [CBOR alternative tags]</span><span>
</span><span id="line-142"></span><span>    </span><span class="annot"><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span id="local-6989586621681024025"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024025"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681024024"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024024"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024025"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024025"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">121</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024025"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Serialise a =&gt; a -&gt; Encoding
</span><a href="../../../../serialise/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024024"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span id="local-6989586621681024018"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024018"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681024017"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024017"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024018"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024018"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">128</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeTag</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1280</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024018"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Serialise a =&gt; a -&gt; Encoding
</span><a href="../../../../serialise/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024017"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-144"></span><span>    </span><span class="annot"><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-type">Constr</span></a></span><span> </span><span id="local-6989586621681024016"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024016"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span id="local-6989586621681024015"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024015"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-145"></span><span>                  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621681024003"><span class="annot"><span class="annottext">tagEncoding :: Encoding
</span><a href="#local-6989586621681024003"><span class="hs-identifier hs-var hs-var">tagEncoding</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024016"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024016"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-146"></span><span>                                    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Word64 -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeWord64</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024016"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-147"></span><span>                                    </span><span class="hs-comment">-- This is a &quot;correct&quot;-ish encoding of the tag, but it will *not* deserialise, since we insist on a</span><span>
</span><span id="line-148"></span><span>                                    </span><span class="hs-comment">-- 'Word64' when we deserialise. So this is really a &quot;soft&quot; failure, without using 'error' or something.</span><span>
</span><span id="line-149"></span><span>                                    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681024016"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-150"></span><span>                  </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeTag</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">102</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeListLen</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="#local-6989586621681024003"><span class="hs-identifier hs-var">tagEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Serialise a =&gt; a -&gt; Encoding
</span><a href="../../../../serialise/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681024015"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-151"></span><span>    </span><span class="annot"><a href="PlutusCore.Data.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span id="local-6989586621681023997"><span class="annot"><span class="annottext">[(Data, Data)]
</span><a href="#local-6989586621681023997"><span class="hs-identifier hs-var">es</span></a></span></span><span>                          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeMapLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[(Data, Data)]
</span><a href="#local-6989586621681023997"><span class="hs-identifier hs-var">es</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Monoid a =&gt; [a] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">mconcat</span></a></span><span> </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">forall a. Serialise a =&gt; a -&gt; Encoding
</span><a href="../../../../serialise/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681023994"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Serialise a =&gt; a -&gt; Encoding
</span><a href="../../../../serialise/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681023993"><span class="hs-identifier hs-var">t'</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681023994"><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681023994"><span class="hs-identifier hs-var">t</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681023993"><span class="annot"><span class="annottext">Data
</span><a href="#local-6989586621681023993"><span class="hs-identifier hs-var">t'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span class="annot"><span class="annottext">[(Data, Data)]
</span><a href="#local-6989586621681023997"><span class="hs-identifier hs-var">es</span></a></span><span> </span><span class="hs-special">]</span><span>
</span><span id="line-152"></span><span>    </span><span class="annot"><a href="PlutusCore.Data.html#List"><span class="hs-identifier hs-type">List</span></a></span><span> </span><span id="local-6989586621681023992"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681023992"><span class="hs-identifier hs-var">ds</span></a></span></span><span>                         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. Serialise a =&gt; a -&gt; Encoding
</span><a href="../../../../serialise/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681023992"><span class="hs-identifier hs-var">ds</span></a></span><span>
</span><span id="line-153"></span><span>    </span><span class="annot"><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-type">I</span></a></span><span> </span><span id="local-6989586621681023991"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023991"><span class="hs-identifier hs-var">i</span></a></span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeInteger"><span class="hs-identifier hs-var">encodeInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023991"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-154"></span><span>    </span><span class="annot"><a href="PlutusCore.Data.html#B"><span class="hs-identifier hs-type">B</span></a></span><span> </span><span id="local-6989586621681023989"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023989"><span class="hs-identifier hs-var">b</span></a></span></span><span>                             </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeBs"><span class="hs-identifier hs-var">encodeBs</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023989"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-155"></span><span>
</span><span id="line-156"></span><span class="hs-comment">-- Logic for choosing encoding borrowed from Codec.CBOR.Write</span><span>
</span><span id="line-157"></span><span class="hs-comment">-- | Given an integer, create a 'CBOR.Term' that encodes it, following our size restrictions.</span><span>
</span><span id="line-158"></span><span class="annot"><a href="PlutusCore.Data.html#encodeInteger"><span class="hs-identifier hs-type">encodeInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Encoding</span></a></span><span>
</span><span id="line-159"></span><span class="hs-comment">-- If it fits in a Word64, then it's less than 64 bytes for sure, and we can just send it off</span><span>
</span><span id="line-160"></span><span class="hs-comment">-- as a normal integer for cborg to deal with</span><span>
</span><span id="line-161"></span><span id="encodeInteger"><span class="annot"><span class="annottext">encodeInteger :: Integer -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeInteger"><span class="hs-identifier hs-var hs-var">encodeInteger</span></a></span></span><span> </span><span id="local-6989586621681023987"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023987"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023987"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023987"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023987"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-162"></span><span>                </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023987"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span>  </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023987"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Bounded a =&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maxBound</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word64</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeInteger</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023987"><span class="hs-identifier hs-var">i</span></a></span><span>
</span><span id="line-163"></span><span class="hs-comment">-- Otherwise, it would be encoded as a bignum anyway, so we manually do the bignum</span><span>
</span><span id="line-164"></span><span class="hs-comment">-- encoding with a bytestring inside, and since we use bsToTerm, that bytestring will</span><span>
</span><span id="line-165"></span><span class="hs-comment">-- get chunked up if it's too big.</span><span>
</span><span id="line-166"></span><span class="hs-comment">-- See Note [Evading the 64-byte limit]</span><span>
</span><span id="line-167"></span><span class="annot"><a href="PlutusCore.Data.html#encodeInteger"><span class="hs-identifier hs-var">encodeInteger</span></a></span><span> </span><span id="local-6989586621681023986"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023986"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023986"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeTag</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeBs"><span class="hs-identifier hs-var">encodeBs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="PlutusCore.Data.html#integerToBytes"><span class="hs-identifier hs-var">integerToBytes</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023986"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-168"></span><span class="annot"><a href="PlutusCore.Data.html#encodeInteger"><span class="hs-identifier hs-var">encodeInteger</span></a></span><span> </span><span id="local-6989586621681023984"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023984"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Word -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeTag</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeBs"><span class="hs-identifier hs-var">encodeBs</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; ByteString
</span><a href="PlutusCore.Data.html#integerToBytes"><span class="hs-identifier hs-var">integerToBytes</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023984"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-169"></span><span>
</span><span id="line-170"></span><span class="hs-comment">-- Taken exactly from Codec.CBOR.Write</span><span>
</span><span id="line-171"></span><span class="annot"><a href="PlutusCore.Data.html#integerToBytes"><span class="hs-identifier hs-type">integerToBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span>
</span><span id="line-172"></span><span id="integerToBytes"><span class="annot"><span class="annottext">integerToBytes :: Integer -&gt; ByteString
</span><a href="PlutusCore.Data.html#integerToBytes"><span class="hs-identifier hs-var hs-var">integerToBytes</span></a></span></span><span> </span><span id="local-6989586621681023983"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023983"><span class="hs-identifier hs-var">n0</span></a></span></span><span>
</span><span id="line-173"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023983"><span class="hs-identifier hs-var">n0</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>   </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BS.pack</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Word8
</span><span class="hs-number">0</span></span><span class="hs-special">]</span><span>
</span><span id="line-174"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Word8] -&gt; ByteString
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BS.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; [Word8]
</span><a href="#local-6989586621681023980"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023983"><span class="hs-identifier hs-var">n0</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-175"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-176"></span><span>    </span><span id="local-6989586621681023980"><span class="annot"><span class="annottext">go :: Integer -&gt; [Word8]
</span><a href="#local-6989586621681023980"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span id="local-6989586621681023975"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023975"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023975"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">0</span></span><span>    </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-177"></span><span>         </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Word8
</span><a href="#local-6989586621681023974"><span class="hs-identifier hs-var">narrow</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023975"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Word8]
</span><a href="#local-6989586621681023980"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621681023975"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Bits a =&gt; a -&gt; Int -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">`shiftR`</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">8</span></span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span>    </span><span class="annot"><a href="#local-6989586621681023974"><span class="hs-identifier hs-type">narrow</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word8</span></a></span><span>
</span><span id="line-180"></span><span>    </span><span id="local-6989586621681023974"><span class="annot"><span class="annottext">narrow :: Integer -&gt; Word8
</span><a href="#local-6989586621681023974"><span class="hs-identifier hs-var hs-var">narrow</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span>
</span><span id="line-181"></span><span>
</span><span id="line-182"></span><span class="hs-comment">-- | Given an bytestring, create a 'CBOR.Term' that encodes it, following our size restrictions.</span><span>
</span><span id="line-183"></span><span class="annot"><a href="PlutusCore.Data.html#encodeBs"><span class="hs-identifier hs-type">encodeBs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Encoding</span></a></span><span>
</span><span id="line-184"></span><span id="encodeBs"><span class="annot"><span class="annottext">encodeBs :: ByteString -&gt; Encoding
</span><a href="PlutusCore.Data.html#encodeBs"><span class="hs-identifier hs-var hs-var">encodeBs</span></a></span></span><span> </span><span id="local-6989586621681023973"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023973"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023973"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023973"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-185"></span><span class="hs-comment">-- It's a bit tricky to get cborg to emit an indefinite-length bytestring with chunks that we control,</span><span>
</span><span id="line-186"></span><span class="hs-comment">-- so we encode it manually</span><span>
</span><span id="line-187"></span><span class="hs-comment">-- See Note [Evading the 64-byte limit]</span><span>
</span><span id="line-188"></span><span class="annot"><a href="PlutusCore.Data.html#encodeBs"><span class="hs-identifier hs-var">encodeBs</span></a></span><span> </span><span id="local-6989586621681023970"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023970"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeBytesIndef</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall (t :: * -&gt; *) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Serialise a =&gt; a -&gt; Encoding
</span><a href="../../../../serialise/html/src"><span class="hs-identifier hs-var">encode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="PlutusCore.Data.html#to64ByteChunks"><span class="hs-identifier hs-var">to64ByteChunks</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023970"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Encoding
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.encodeBreak</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span class="hs-comment">-- | Turns a 'BS.ByteString' into a list of &lt;=64 byte chunks.</span><span>
</span><span id="line-191"></span><span class="annot"><a href="PlutusCore.Data.html#to64ByteChunks"><span class="hs-identifier hs-type">to64ByteChunks</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-192"></span><span id="to64ByteChunks"><span class="annot"><span class="annottext">to64ByteChunks :: ByteString -&gt; [ByteString]
</span><a href="PlutusCore.Data.html#to64ByteChunks"><span class="hs-identifier hs-var hs-var">to64ByteChunks</span></a></span></span><span> </span><span id="local-6989586621681023965"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023965"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023965"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-193"></span><span>                   </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621681023963"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023963"><span class="hs-identifier hs-var">chunk</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621681023962"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023962"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; ByteString -&gt; (ByteString, ByteString)
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BS.splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023965"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-194"></span><span>                   </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023963"><span class="hs-identifier hs-var">chunk</span></a></span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span class="annot"><span class="annottext">ByteString -&gt; [ByteString]
</span><a href="PlutusCore.Data.html#to64ByteChunks"><span class="hs-identifier hs-var">to64ByteChunks</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023962"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-195"></span><span class="annot"><a href="PlutusCore.Data.html#to64ByteChunks"><span class="hs-identifier hs-var">to64ByteChunks</span></a></span><span> </span><span id="local-6989586621681023960"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023960"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023960"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-196"></span><span>
</span><span id="line-197"></span><span class="hs-comment">{- Note [Definite and indefinite forms of CBOR]
CBOR is annoying and you can have both definite (with a fixed length) and indefinite lists, maps, etc.

So we have to be careful to handle both cases when decoding. When encoding we mostly don't make
the indefinite kinds, but see Note [Avoiding the 64-byte limit] for some cases where we do.
-}</span><span>
</span><span id="line-203"></span><span>
</span><span id="line-204"></span><span class="hs-comment">-- | Turn a CBOR Term into Data if possible.</span><span>
</span><span id="line-205"></span><span id="local-6989586621681023959"><span class="annot"><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-type">decodeData</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681023959"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span></span><span>
</span><span id="line-206"></span><span id="decodeData"><span class="annot"><span class="annottext">decodeData :: forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var hs-var">decodeData</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.peekTokenType</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-207"></span><span>  </span><span class="hs-comment">-- These integers are at most 64 *bits*, so certainly less than 64 *bytes*</span><span>
</span><span id="line-208"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeUInt</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Data
</span><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Integer
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeInteger</span></a></span><span>
</span><span id="line-209"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeUInt64</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Data
</span><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Integer
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeInteger</span></a></span><span>
</span><span id="line-210"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeNInt</span></a></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Data
</span><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Integer
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeInteger</span></a></span><span>
</span><span id="line-211"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeNInt64</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Data
</span><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Integer
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeInteger</span></a></span><span>
</span><span id="line-212"></span><span>  </span><span class="hs-comment">-- See Note [The 64-byte limit]</span><span>
</span><span id="line-213"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeInteger</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Data
</span><a href="PlutusCore.Data.html#I"><span class="hs-identifier hs-var">I</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Integer
</span><a href="PlutusCore.Data.html#decodeBoundedBigInteger"><span class="hs-identifier hs-var">decodeBoundedBigInteger</span></a></span><span>
</span><span id="line-214"></span><span>
</span><span id="line-215"></span><span>  </span><span class="hs-comment">-- See Note [The 64-byte limit]</span><span>
</span><span id="line-216"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeBytes</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Data
</span><a href="PlutusCore.Data.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytes"><span class="hs-identifier hs-var">decodeBoundedBytes</span></a></span><span>
</span><span id="line-217"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeBytesIndef</span></a></span><span>   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Data
</span><a href="PlutusCore.Data.html#B"><span class="hs-identifier hs-var">B</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BSL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytesIndef"><span class="hs-identifier hs-var">decodeBoundedBytesIndef</span></a></span><span>
</span><span id="line-218"></span><span>
</span><span id="line-219"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeListLen</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeList"><span class="hs-identifier hs-var">decodeList</span></a></span><span>
</span><span id="line-220"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeListLen64</span></a></span><span>    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeList"><span class="hs-identifier hs-var">decodeList</span></a></span><span>
</span><span id="line-221"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeListLenIndef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeList"><span class="hs-identifier hs-var">decodeList</span></a></span><span>
</span><span id="line-222"></span><span>
</span><span id="line-223"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeMapLen</span></a></span><span>       </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeMap"><span class="hs-identifier hs-var">decodeMap</span></a></span><span>
</span><span id="line-224"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeMapLen64</span></a></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeMap"><span class="hs-identifier hs-var">decodeMap</span></a></span><span>
</span><span id="line-225"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeMapLenIndef</span></a></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeMap"><span class="hs-identifier hs-var">decodeMap</span></a></span><span>
</span><span id="line-226"></span><span>
</span><span id="line-227"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeTag</span></a></span><span>          </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeConstr"><span class="hs-identifier hs-var">decodeConstr</span></a></span><span>
</span><span id="line-228"></span><span>  </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeTag64</span></a></span><span>        </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeConstr"><span class="hs-identifier hs-var">decodeConstr</span></a></span><span>
</span><span id="line-229"></span><span>
</span><span id="line-230"></span><span>  </span><span id="local-6989586621681023915"><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621681023915"><span class="hs-identifier hs-var">t</span></a></span></span><span>                     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unrecognized value of type &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621681023915"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-231"></span><span>
</span><span id="line-232"></span><span id="local-6989586621681023913"><span class="annot"><a href="PlutusCore.Data.html#decodeBoundedBigInteger"><span class="hs-identifier hs-type">decodeBoundedBigInteger</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681023913"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-bignum-1.2/src"><span class="hs-identifier hs-type">Integer</span></a></span></span><span>
</span><span id="line-233"></span><span id="decodeBoundedBigInteger"><span class="annot"><span class="annottext">decodeBoundedBigInteger :: forall s. Decoder s Integer
</span><a href="PlutusCore.Data.html#decodeBoundedBigInteger"><span class="hs-identifier hs-var hs-var">decodeBoundedBigInteger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-234"></span><span>    </span><span id="local-6989586621681023892"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681023892"><span class="hs-identifier hs-var">tag</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Word
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeTag</span></a></span><span>
</span><span id="line-235"></span><span>    </span><span class="hs-comment">-- Bignums contain a bytestring as the payload</span><span>
</span><span id="line-236"></span><span>    </span><span id="local-6989586621681023890"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023890"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.peekTokenType</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-237"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeBytes</span></a></span><span>      </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytes"><span class="hs-identifier hs-var">decodeBoundedBytes</span></a></span><span>
</span><span id="line-238"></span><span>        </span><span class="annot"><span class="annottext">TokenType
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.TypeBytesIndef</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ByteString
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BSL.toStrict</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytesIndef"><span class="hs-identifier hs-var">decodeBoundedBytesIndef</span></a></span><span>
</span><span id="line-239"></span><span>        </span><span id="local-6989586621681023889"><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621681023889"><span class="hs-identifier hs-var">t</span></a></span></span><span>                   </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bignum must contain a byte string, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">TokenType
</span><a href="#local-6989586621681023889"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-240"></span><span>    </span><span class="hs-comment">-- Depending on the tag, the bytestring is either a positive or negative integer</span><span>
</span><span id="line-241"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681023892"><span class="hs-identifier hs-var">tag</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-242"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">2</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.uintegerFromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023890"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-243"></span><span>        </span><span class="annot"><span class="annottext">Word
</span><span class="hs-number">3</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Integer
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.nintegerFromBytes</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023890"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-244"></span><span>        </span><span id="local-6989586621681023886"><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681023886"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Bignum tag must be one of 2 or 3, got: &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word
</span><a href="#local-6989586621681023886"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>
</span><span id="line-246"></span><span class="hs-comment">-- Adapted from Codec.CBOR.Read</span><span>
</span><span id="line-247"></span><span id="local-6989586621681024446"><span class="annot"><a href="PlutusCore.Data.html#decodeBoundedBytesIndef"><span class="hs-identifier hs-type">decodeBoundedBytesIndef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681024446"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BSL.ByteString</span></a></span></span><span>
</span><span id="line-248"></span><span id="decodeBoundedBytesIndef"><span class="annot"><span class="annottext">decodeBoundedBytesIndef :: forall s. Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytesIndef"><span class="hs-identifier hs-var hs-var">decodeBoundedBytesIndef</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s ()
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeBytesIndef</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; m b -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. [ByteString] -&gt; Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytesIndefLen"><span class="hs-identifier hs-var">decodeBoundedBytesIndefLen</span></a></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-249"></span><span>
</span><span id="line-250"></span><span class="hs-comment">-- Adapted from Codec.CBOR.Read, to call the size-checking bytestring decoder</span><span>
</span><span id="line-251"></span><span id="local-6989586621681024433"><span class="annot"><a href="PlutusCore.Data.html#decodeBoundedBytesIndefLen"><span class="hs-identifier hs-type">decodeBoundedBytesIndefLen</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681024433"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BSL.ByteString</span></a></span></span><span>
</span><span id="line-252"></span><span id="decodeBoundedBytesIndefLen"><span class="annot"><span class="annottext">decodeBoundedBytesIndefLen :: forall s. [ByteString] -&gt; Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytesIndefLen"><span class="hs-identifier hs-var hs-var">decodeBoundedBytesIndefLen</span></a></span></span><span> </span><span id="local-6989586621681023879"><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621681023879"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-253"></span><span>    </span><span id="local-6989586621681023878"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681023878"><span class="hs-identifier hs-var">stop</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Bool
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeBreakOr</span></a></span><span>
</span><span id="line-254"></span><span>    </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681023878"><span class="hs-identifier hs-var">stop</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. Monad m =&gt; a -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">return</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$!</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString] -&gt; ByteString
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BSL.fromChunks</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621681023879"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-255"></span><span>            </span><span class="hs-keyword">else</span><span> </span><span class="hs-keyword">do</span><span> </span><span class="hs-glyph">!</span><span id="local-6989586621681023874"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023874"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytes"><span class="hs-identifier hs-var">decodeBoundedBytes</span></a></span><span>
</span><span id="line-256"></span><span>                    </span><span class="annot"><span class="annottext">forall s. [ByteString] -&gt; Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytesIndefLen"><span class="hs-identifier hs-var">decodeBoundedBytesIndefLen</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023874"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[ByteString]
</span><a href="#local-6989586621681023879"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-257"></span><span>
</span><span id="line-258"></span><span id="local-6989586621681024451"><span class="annot"><a href="PlutusCore.Data.html#decodeBoundedBytes"><span class="hs-identifier hs-type">decodeBoundedBytes</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681024451"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">BS.ByteString</span></a></span></span><span>
</span><span id="line-259"></span><span id="decodeBoundedBytes"><span class="annot"><span class="annottext">decodeBoundedBytes :: forall s. Decoder s ByteString
</span><a href="PlutusCore.Data.html#decodeBoundedBytes"><span class="hs-identifier hs-var hs-var">decodeBoundedBytes</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>  </span><span class="hs-keyword">do</span><span>
</span><span id="line-260"></span><span>  </span><span id="local-6989586621681023866"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023866"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s ByteString
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeBytes</span></a></span><span>
</span><span id="line-261"></span><span>  </span><span class="hs-comment">-- See Note [The 64-byte limit]</span><span>
</span><span id="line-262"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; Int
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BS.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023866"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;ByteString exceeds 64 bytes&quot;</span></span><span>
</span><span id="line-263"></span><span>  </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621681023866"><span class="hs-identifier hs-var">b</span></a></span><span>
</span><span id="line-264"></span><span>
</span><span id="line-265"></span><span id="local-6989586621681023863"><span class="annot"><a href="PlutusCore.Data.html#decodeList"><span class="hs-identifier hs-type">decodeList</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681023863"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span></span><span>
</span><span id="line-266"></span><span id="decodeList"><span class="annot"><span class="annottext">decodeList :: forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeList"><span class="hs-identifier hs-var hs-var">decodeList</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Data] -&gt; Data
</span><a href="PlutusCore.Data.html#List"><span class="hs-identifier hs-var">List</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s x. Decoder s x -&gt; Decoder s [x]
</span><a href="PlutusCore.Data.html#decodeListOf"><span class="hs-identifier hs-var">decodeListOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var">decodeData</span></a></span><span>
</span><span id="line-267"></span><span>
</span><span id="line-268"></span><span id="local-6989586621681024425"><span id="local-6989586621681024426"><span class="annot"><a href="PlutusCore.Data.html#decodeListOf"><span class="hs-identifier hs-type">decodeListOf</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681024426"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681024425"><span class="hs-identifier hs-type">x</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681024426"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621681024425"><span class="hs-identifier hs-type">x</span></a></span><span class="hs-special">]</span></span></span><span>
</span><span id="line-269"></span><span id="decodeListOf"><span class="annot"><span class="annottext">decodeListOf :: forall s x. Decoder s x -&gt; Decoder s [x]
</span><a href="PlutusCore.Data.html#decodeListOf"><span class="hs-identifier hs-var hs-var">decodeListOf</span></a></span></span><span> </span><span id="local-6989586621681023859"><span class="annot"><span class="annottext">Decoder s x
</span><a href="#local-6989586621681023859"><span class="hs-identifier hs-var">decoder</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s (Maybe Int)
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeListLenOrIndef</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-270"></span><span>  </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall r a r' s.
(r -&gt; a -&gt; r) -&gt; r -&gt; (r -&gt; r') -&gt; Decoder s a -&gt; Decoder s r'
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">decodeSequenceLenIndef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span>   </span><span class="annot"><span class="annottext">Decoder s x
</span><a href="#local-6989586621681023859"><span class="hs-identifier hs-var">decoder</span></a></span><span>
</span><span id="line-271"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681023856"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681023856"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall r a r' s.
(r -&gt; a -&gt; r)
-&gt; r -&gt; (r -&gt; r') -&gt; Int -&gt; Decoder s a -&gt; Decoder s r'
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">decodeSequenceLenN</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681023856"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Decoder s x
</span><a href="#local-6989586621681023859"><span class="hs-identifier hs-var">decoder</span></a></span><span>
</span><span id="line-272"></span><span>
</span><span id="line-273"></span><span id="local-6989586621681023855"><span class="annot"><a href="PlutusCore.Data.html#decodeMap"><span class="hs-identifier hs-type">decodeMap</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681023855"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span></span><span>
</span><span id="line-274"></span><span id="decodeMap"><span class="annot"><span class="annottext">decodeMap :: forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeMap"><span class="hs-identifier hs-var hs-var">decodeMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s (Maybe Int)
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeMapLenOrIndef</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-275"></span><span>  </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Data, Data)] -&gt; Data
</span><a href="PlutusCore.Data.html#Map"><span class="hs-identifier hs-var">Map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall r a r' s.
(r -&gt; a -&gt; r) -&gt; r -&gt; (r -&gt; r') -&gt; Decoder s a -&gt; Decoder s r'
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">decodeSequenceLenIndef</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span>   </span><span class="annot"><span class="annottext">forall {s}. Decoder s (Data, Data)
</span><a href="#local-6989586621681023850"><span class="hs-identifier hs-var">decodePair</span></a></span><span>
</span><span id="line-276"></span><span>  </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681023849"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681023849"><span class="hs-identifier hs-var">n</span></a></span></span><span>  </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[(Data, Data)] -&gt; Data
</span><a href="PlutusCore.Data.html#Map"><span class="hs-identifier hs-var">Map</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall r a r' s.
(r -&gt; a -&gt; r)
-&gt; r -&gt; (r -&gt; r') -&gt; Int -&gt; Decoder s a -&gt; Decoder s r'
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">decodeSequenceLenN</span></a></span><span>     </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">:</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">reverse</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681023849"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall {s}. Decoder s (Data, Data)
</span><a href="#local-6989586621681023850"><span class="hs-identifier hs-var">decodePair</span></a></span><span>
</span><span id="line-277"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-278"></span><span>  </span><span id="local-6989586621681023850"><span class="annot"><span class="annottext">decodePair :: Decoder s (Data, Data)
</span><a href="#local-6989586621681023850"><span class="hs-identifier hs-var hs-var">decodePair</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var">decodeData</span></a></span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Applicative f =&gt; f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var">decodeData</span></a></span><span>
</span><span id="line-279"></span><span>
</span><span id="line-280"></span><span class="hs-comment">-- See note [CBOR alternative tags] for the encoding scheme.</span><span>
</span><span id="line-281"></span><span id="local-6989586621681023846"><span class="annot"><a href="PlutusCore.Data.html#decodeConstr"><span class="hs-identifier hs-type">decodeConstr</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../cborg/html/src"><span class="hs-identifier hs-type">Decoder</span></a></span><span> </span><span class="annot"><a href="#local-6989586621681023846"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="PlutusCore.Data.html#Data"><span class="hs-identifier hs-type">Data</span></a></span></span><span>
</span><span id="line-282"></span><span id="decodeConstr"><span class="annot"><span class="annottext">decodeConstr :: forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeConstr"><span class="hs-identifier hs-var hs-var">decodeConstr</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Word64
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeTag64</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span>
</span><span id="line-283"></span><span>  </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">102</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="#local-6989586621681023814"><span class="hs-identifier hs-var">decodeConstrExtended</span></a></span><span>
</span><span id="line-284"></span><span>  </span><span id="local-6989586621681023813"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023813"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">121</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023813"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023813"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">128</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-285"></span><span>         </span><span class="annot"><span class="annottext">Integer -&gt; [Data] -&gt; Data
</span><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023813"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">121</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s x. Decoder s x -&gt; Decoder s [x]
</span><a href="PlutusCore.Data.html#decodeListOf"><span class="hs-identifier hs-var">decodeListOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var">decodeData</span></a></span><span>
</span><span id="line-286"></span><span>  </span><span id="local-6989586621681023812"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023812"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1280</span></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023812"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023812"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><span class="hs-number">1401</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-287"></span><span>         </span><span class="annot"><span class="annottext">Integer -&gt; [Data] -&gt; Data
</span><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023812"><span class="hs-identifier hs-var">t</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-glyph hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1280</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">7</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">forall s x. Decoder s x -&gt; Decoder s [x]
</span><a href="PlutusCore.Data.html#decodeListOf"><span class="hs-identifier hs-var">decodeListOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var">decodeData</span></a></span><span>
</span><span id="line-288"></span><span>  </span><span id="local-6989586621681023811"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023811"><span class="hs-identifier hs-var">t</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Unrecognized tag &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; String
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023811"><span class="hs-identifier hs-var">t</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-290"></span><span>  </span><span id="local-6989586621681023814"><span class="annot"><span class="annottext">decodeConstrExtended :: Decoder s Data
</span><a href="#local-6989586621681023814"><span class="hs-identifier hs-var hs-var">decodeConstrExtended</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-291"></span><span>    </span><span id="local-6989586621681023795"><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621681023795"><span class="hs-identifier hs-var">len</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s (Maybe Int)
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeListLenOrIndef</span></a></span><span>
</span><span id="line-292"></span><span>    </span><span id="local-6989586621681023794"><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023794"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Word64
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeWord64</span></a></span><span>
</span><span id="line-293"></span><span>    </span><span id="local-6989586621681023792"><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681023792"><span class="hs-identifier hs-var">args</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s x. Decoder s x -&gt; Decoder s [x]
</span><a href="PlutusCore.Data.html#decodeListOf"><span class="hs-identifier hs-var">decodeListOf</span></a></span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Data
</span><a href="PlutusCore.Data.html#decodeData"><span class="hs-identifier hs-var">decodeData</span></a></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="#local-6989586621681023795"><span class="hs-identifier hs-var">len</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-295"></span><span>      </span><span class="annot"><span class="annottext">Maybe Int
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-296"></span><span>        </span><span id="local-6989586621681023791"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681023791"><span class="hs-identifier hs-var">done</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">forall s. Decoder s Bool
</span><a href="../../../../cborg/html/src"><span class="hs-identifier hs-var">CBOR.decodeBreakOr</span></a></span><span>
</span><span id="line-297"></span><span>        </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621681023791"><span class="hs-identifier hs-var">done</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected exactly two elements&quot;</span></span><span>
</span><span id="line-298"></span><span>      </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621681023790"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681023790"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">unless</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621681023790"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">2</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (m :: * -&gt; *) a. MonadFail m =&gt; String -&gt; m a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fail</span></a></span><span> </span><span class="annot"><span class="annottext">String
</span><span class="hs-string">&quot;Expected exactly two elements&quot;</span></span><span>
</span><span id="line-299"></span><span>    </span><span class="annot"><span class="annottext">forall (f :: * -&gt; *) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; [Data] -&gt; Data
</span><a href="PlutusCore.Data.html#Constr"><span class="hs-identifier hs-var">Constr</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Word64
</span><a href="#local-6989586621681023794"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[Data]
</span><a href="#local-6989586621681023792"><span class="hs-identifier hs-var">args</span></a></span><span>
</span><span id="line-300"></span></pre></body></html>