<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-comment">-- |</span><span>
</span><span id="line-2"></span><span class="hs-comment">-- Module      : Cardano.Crypto.Wallet</span><span>
</span><span id="line-3"></span><span class="hs-comment">-- Description : HD Wallet routines</span><span>
</span><span id="line-4"></span><span class="hs-comment">-- Maintainer  : vincent@typed.io</span><span>
</span><span id="line-5"></span><span class="hs-comment">--</span><span>
</span><span id="line-6"></span><span class="hs-comment">-- This provides similar functionality to BIP32 but using</span><span>
</span><span id="line-7"></span><span class="hs-comment">-- Ed25519 arithmetic instead of P256K1 arithmethic.</span><span>
</span><span id="line-8"></span><span class="hs-comment">--</span><span>
</span><span id="line-9"></span><span class="hs-comment">-- Key can be hierarchically derived from private key in two</span><span>
</span><span id="line-10"></span><span class="hs-comment">-- fashions: Hardened or Normal.</span><span>
</span><span id="line-11"></span><span class="hs-comment">--</span><span>
</span><span id="line-12"></span><span class="hs-comment">-- In the hardened scheme, the child secret key is not linearly</span><span>
</span><span id="line-13"></span><span class="hs-comment">-- derived, so that the child public key has no way</span><span>
</span><span id="line-14"></span><span class="hs-comment">-- to be efficiently computed from the parent public key.</span><span>
</span><span id="line-15"></span><span class="hs-comment">--</span><span>
</span><span id="line-16"></span><span class="hs-comment">-- The normal scheme allows anyone to derive public keys from</span><span>
</span><span id="line-17"></span><span class="hs-comment">-- public key.</span><span>
</span><span id="line-18"></span><span class="hs-comment">--</span><span>
</span><span id="line-19"></span><span class="hs-pragma">{-# LANGUAGE GADTs               #-}</span><span>
</span><span id="line-20"></span><span class="hs-pragma">{-# LANGUAGE OverloadedStrings   #-}</span><span>
</span><span id="line-21"></span><span class="hs-pragma">{-# LANGUAGE ScopedTypeVariables #-}</span><span>
</span><span id="line-22"></span><span class="hs-pragma">{-# LANGUAGE TypeOperators       #-}</span><span>
</span><span id="line-23"></span><span class="hs-pragma">{-# LANGUAGE DeriveGeneric       #-}</span><span>
</span><span id="line-24"></span><span class="hs-pragma">{-# LANGUAGE PatternSynonyms     #-}</span><span>
</span><span id="line-25"></span><span>
</span><span id="line-26"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Cardano.Crypto.Wallet</span><span>
</span><span id="line-27"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier">ChainCode</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-28"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier">DerivationScheme</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-29"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationIndex"><span class="hs-identifier">DerivationIndex</span></a></span><span>
</span><span id="line-30"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="hs-keyword">pattern</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#LatestScheme"><span class="hs-identifier">LatestScheme</span></a></span><span>
</span><span id="line-31"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Extended Private &amp; Public types</span></span><span>
</span><span id="line-32"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier">XPrv</span></a></span><span>
</span><span id="line-33"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier">XPub</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span>
</span><span id="line-34"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier">XSignature</span></a></span><span>
</span><span id="line-35"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#generate"><span class="hs-identifier">generate</span></a></span><span>
</span><span id="line-36"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#generateNew"><span class="hs-identifier">generateNew</span></a></span><span>
</span><span id="line-37"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xprv"><span class="hs-identifier">xprv</span></a></span><span>
</span><span id="line-38"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xpub"><span class="hs-identifier">xpub</span></a></span><span>
</span><span id="line-39"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xsignature"><span class="hs-identifier">xsignature</span></a></span><span>
</span><span id="line-40"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPrv"><span class="hs-identifier">unXPrv</span></a></span><span>
</span><span id="line-41"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPub"><span class="hs-identifier">unXPub</span></a></span><span>
</span><span id="line-42"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXSignature"><span class="hs-identifier">unXSignature</span></a></span><span>
</span><span id="line-43"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#toXPub"><span class="hs-identifier">toXPub</span></a></span><span>
</span><span id="line-44"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPubGetPublicKey"><span class="hs-identifier">xPubGetPublicKey</span></a></span><span>
</span><span id="line-45"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPrvChangePass"><span class="hs-identifier">xPrvChangePass</span></a></span><span>
</span><span id="line-46"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Derivation function</span></span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPrv"><span class="hs-identifier">deriveXPrv</span></a></span><span>
</span><span id="line-48"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPub"><span class="hs-identifier">deriveXPub</span></a></span><span>
</span><span id="line-49"></span><span>    </span><span class="annot"><span class="hs-comment">-- * Signature &amp; Verification from extended types</span></span><span>
</span><span id="line-50"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#sign"><span class="hs-identifier">sign</span></a></span><span>
</span><span id="line-51"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#verify"><span class="hs-identifier">verify</span></a></span><span>
</span><span id="line-52"></span><span>    </span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-53"></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../basement/html/src"><span class="hs-identifier">Basement.Compat.Typeable</span></a></span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">Control.DeepSeq</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier">NFData</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Control.Arrow</span></a></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">second</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.Error</span></a></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">throwCryptoError</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">CryptoFailable</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">CryptoError</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.MAC.HMAC</span></a></span><span>                 </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">HMAC</span></span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.PubKey.Ed25519</span></a></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Ed25519</span></span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Crypto.KDF.PBKDF2</span></a></span><span>               </span><span class="hs-special">(</span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">fastPBKDF2_SHA512</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier">Parameters</span></a></span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span>                  </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">ByteArrayAccess</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">convert</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">Data.ByteArray</span></a></span><span>                  </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">B</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">append</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">length</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier">splitAt</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">Data.ByteString</span></a></span><span>                 </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">ByteString</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier">Data.ByteString.Char8</span></a></span><span>           </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">BC</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../hashable/html/src"><span class="hs-identifier">Data.Hashable</span></a></span><span>                   </span><span class="hs-special">(</span><span class="annot"><a href="../../../../hashable/html/src"><span class="hs-identifier">Hashable</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Data.Word</span></a></span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Generics</span></a></span><span>                    </span><span class="hs-special">(</span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html"><span class="hs-identifier">Cardano.Crypto.Wallet.Encrypted</span></a></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Crypto.Wallet.Pure.html"><span class="hs-identifier">Cardano.Crypto.Wallet.Pure</span></a></span><span>      </span><span class="hs-special">(</span><span class="hs-comment">{-XPub (..),-}</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Pure.html#hFinalize"><span class="hs-identifier">hFinalize</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-71"></span><span>                                                  </span><span class="annot"><a href="Cardano.Crypto.Wallet.Pure.html#hInitSeed"><span class="hs-identifier">hInitSeed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html"><span class="hs-identifier">Cardano.Crypto.Wallet.Types</span></a></span><span>
</span><span id="line-73"></span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span>           </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier">GHC.Stack</span></a></span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="hs-keyword">newtype</span><span> </span><span id="XPrv"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XPrv"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#EncryptedKey"><span class="hs-identifier hs-type">EncryptedKey</span></a></span><span>
</span><span id="line-77"></span><span>    </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095415"><span class="annot"><span class="annottext">XPrv -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: XPrv -&gt; ()
$crnf :: XPrv -&gt; ()
</span><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095399"><span id="local-6989586621679095403"><span id="local-6989586621679095408"><span class="annot"><span class="annottext">XPrv -&gt; Int
forall p. XPrv -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall p a. XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: forall p. XPrv -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall p. XPrv -&gt; Ptr p -&gt; IO ()
withByteArray :: forall p a. XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall p a. XPrv -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: XPrv -&gt; Int
$clength :: XPrv -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-78"></span><span>
</span><span id="line-79"></span><span id="local-6989586621679095393"><span id="local-6989586621679095394"></span></span><span class="hs-keyword">data</span><span> </span><span id="XPub"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XPub"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span></span><span>
</span><span id="line-80"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="xpubPublicKey"><span class="annot"><span class="annottext">XPub -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#xpubPublicKey"><span class="hs-identifier hs-var hs-var">xpubPublicKey</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-81"></span><span>    </span><span class="hs-special">,</span><span> </span><span id="xpubChaincode"><span class="annot"><span class="annottext">XPub -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.html#xpubChaincode"><span class="hs-identifier hs-var hs-var">xpubChaincode</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095382"><span id="local-6989586621679095388"><span class="annot"><span class="annottext">XPub -&gt; XPub -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: XPub -&gt; XPub -&gt; Bool
$c/= :: XPub -&gt; XPub -&gt; Bool
== :: XPub -&gt; XPub -&gt; Bool
$c== :: XPub -&gt; XPub -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095369"><span id="local-6989586621679095371"><span id="local-6989586621679095379"><span class="annot"><span class="annottext">Int -&gt; XPub -&gt; ShowS
[XPub] -&gt; ShowS
XPub -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [XPub] -&gt; ShowS
$cshowList :: [XPub] -&gt; ShowS
show :: XPub -&gt; [Char]
$cshow :: XPub -&gt; [Char]
showsPrec :: Int -&gt; XPub -&gt; ShowS
$cshowsPrec :: Int -&gt; XPub -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095343"><span id="local-6989586621679095345"><span id="local-6989586621679095348"><span id="local-6989586621679095351"><span id="local-6989586621679095354"><span id="local-6989586621679095358"><span id="local-6989586621679095364"><span class="annot"><span class="annottext">Eq XPub
XPub -&gt; XPub -&gt; Bool
XPub -&gt; XPub -&gt; Ordering
XPub -&gt; XPub -&gt; XPub
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: XPub -&gt; XPub -&gt; XPub
$cmin :: XPub -&gt; XPub -&gt; XPub
max :: XPub -&gt; XPub -&gt; XPub
$cmax :: XPub -&gt; XPub -&gt; XPub
&gt;= :: XPub -&gt; XPub -&gt; Bool
$c&gt;= :: XPub -&gt; XPub -&gt; Bool
&gt; :: XPub -&gt; XPub -&gt; Bool
$c&gt; :: XPub -&gt; XPub -&gt; Bool
&lt;= :: XPub -&gt; XPub -&gt; Bool
$c&lt;= :: XPub -&gt; XPub -&gt; Bool
&lt; :: XPub -&gt; XPub -&gt; Bool
$c&lt; :: XPub -&gt; XPub -&gt; Bool
compare :: XPub -&gt; XPub -&gt; Ordering
$ccompare :: XPub -&gt; XPub -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Typeable</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">forall x. Rep XPub x -&gt; XPub
forall x. XPub -&gt; Rep XPub x
forall a.
(forall x. a -&gt; Rep a x) -&gt; (forall x. Rep a x -&gt; a) -&gt; Generic a
$cto :: forall x. Rep XPub x -&gt; XPub
$cfrom :: forall x. XPub -&gt; Rep XPub x
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var">Generic</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-83"></span><span>
</span><span id="line-84"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095337"><span class="annot"><a href="../../../../ghc/html/libraries/deepseq-1.4.6.1/src"><span class="hs-identifier hs-type">NFData</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span></span><span>
</span><span id="line-85"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679095331"><span id="local-6989586621679095333"><span class="annot"><a href="../../../../hashable/html/src"><span class="hs-identifier hs-type">Hashable</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span></span></span><span>
</span><span id="line-86"></span><span>
</span><span id="line-87"></span><span class="hs-keyword">newtype</span><span> </span><span id="XSignature"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="XSignature"><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span></span><span>
</span><span id="line-88"></span><span>    </span><span class="hs-special">{</span><span> </span><span id="unXSignature"><span class="annot"><span class="annottext">XSignature -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#unXSignature"><span class="hs-identifier hs-var hs-var">unXSignature</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-89"></span><span>    </span><span class="hs-special">}</span><span> </span><span class="hs-keyword">deriving</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095321"><span id="local-6989586621679095323"><span id="local-6989586621679095327"><span class="annot"><span class="annottext">Int -&gt; XSignature -&gt; ShowS
[XSignature] -&gt; ShowS
XSignature -&gt; [Char]
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
showList :: [XSignature] -&gt; ShowS
$cshowList :: [XSignature] -&gt; ShowS
show :: XSignature -&gt; [Char]
$cshow :: XSignature -&gt; [Char]
showsPrec :: Int -&gt; XSignature -&gt; ShowS
$cshowsPrec :: Int -&gt; XSignature -&gt; ShowS
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095315"><span id="local-6989586621679095319"><span class="annot"><span class="annottext">XSignature -&gt; XSignature -&gt; Bool
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
/= :: XSignature -&gt; XSignature -&gt; Bool
$c/= :: XSignature -&gt; XSignature -&gt; Bool
== :: XSignature -&gt; XSignature -&gt; Bool
$c== :: XSignature -&gt; XSignature -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095284"><span id="local-6989586621679095288"><span id="local-6989586621679095292"><span id="local-6989586621679095296"><span id="local-6989586621679095300"><span id="local-6989586621679095304"><span id="local-6989586621679095308"><span class="annot"><span class="annottext">Eq XSignature
XSignature -&gt; XSignature -&gt; Bool
XSignature -&gt; XSignature -&gt; Ordering
XSignature -&gt; XSignature -&gt; XSignature
forall a.
Eq a
-&gt; (a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
min :: XSignature -&gt; XSignature -&gt; XSignature
$cmin :: XSignature -&gt; XSignature -&gt; XSignature
max :: XSignature -&gt; XSignature -&gt; XSignature
$cmax :: XSignature -&gt; XSignature -&gt; XSignature
&gt;= :: XSignature -&gt; XSignature -&gt; Bool
$c&gt;= :: XSignature -&gt; XSignature -&gt; Bool
&gt; :: XSignature -&gt; XSignature -&gt; Bool
$c&gt; :: XSignature -&gt; XSignature -&gt; Bool
&lt;= :: XSignature -&gt; XSignature -&gt; Bool
$c&lt;= :: XSignature -&gt; XSignature -&gt; Bool
&lt; :: XSignature -&gt; XSignature -&gt; Bool
$c&lt; :: XSignature -&gt; XSignature -&gt; Bool
compare :: XSignature -&gt; XSignature -&gt; Ordering
$ccompare :: XSignature -&gt; XSignature -&gt; Ordering
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095279"><span class="annot"><span class="annottext">XSignature -&gt; ()
forall a. (a -&gt; ()) -&gt; NFData a
rnf :: XSignature -&gt; ()
$crnf :: XSignature -&gt; ()
</span><a href="#local-6989586621679095279"><span class="hs-identifier hs-var hs-var hs-var hs-var">NFData</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095268"><span id="local-6989586621679095272"><span class="annot"><span class="annottext">Eq XSignature
Int -&gt; XSignature -&gt; Int
XSignature -&gt; Int
forall a. Eq a -&gt; (Int -&gt; a -&gt; Int) -&gt; (a -&gt; Int) -&gt; Hashable a
hash :: XSignature -&gt; Int
$chash :: XSignature -&gt; Int
hashWithSalt :: Int -&gt; XSignature -&gt; Int
$chashWithSalt :: Int -&gt; XSignature -&gt; Int
</span><a href="#local-6989586621679095268"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Hashable</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095255"><span id="local-6989586621679095259"><span id="local-6989586621679095263"><span class="annot"><span class="annottext">XSignature -&gt; Int
forall p. XSignature -&gt; Ptr p -&gt; IO ()
forall ba.
(ba -&gt; Int)
-&gt; (forall p a. ba -&gt; (Ptr p -&gt; IO a) -&gt; IO a)
-&gt; (forall p. ba -&gt; Ptr p -&gt; IO ())
-&gt; ByteArrayAccess ba
forall p a. XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a
copyByteArrayToPtr :: forall p. XSignature -&gt; Ptr p -&gt; IO ()
$ccopyByteArrayToPtr :: forall p. XSignature -&gt; Ptr p -&gt; IO ()
withByteArray :: forall p a. XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a
$cwithByteArray :: forall p a. XSignature -&gt; (Ptr p -&gt; IO a) -&gt; IO a
length :: XSignature -&gt; Int
$clength :: XSignature -&gt; Int
</span><a href="#local-6989586621679095255"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">ByteArrayAccess</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-90"></span><span>
</span><span id="line-91"></span><span class="hs-comment">-- | Generate a new XPrv</span><span>
</span><span id="line-92"></span><span class="hs-comment">--</span><span>
</span><span id="line-93"></span><span class="hs-comment">-- The seed needs to be at least 32 bytes, otherwise an asynchronous error is thrown</span><span>
</span><span id="line-94"></span><span id="local-6989586621679095607"><span id="local-6989586621679095608"><span class="annot"><a href="Cardano.Crypto.Wallet.html#generate"><span class="hs-identifier hs-type">generate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095608"><span class="hs-identifier hs-type">passPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095607"><span class="hs-identifier hs-type">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-95"></span><span>         </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095607"><span class="hs-identifier hs-type">seed</span></a></span><span>
</span><span id="line-96"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095608"><span class="hs-identifier hs-type">passPhrase</span></a></span><span>
</span><span id="line-97"></span><span>         </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span></span><span>
</span><span id="line-98"></span><span id="generate"><span class="annot"><span class="annottext">generate :: forall passPhrase seed.
(ByteArrayAccess passPhrase, ByteArrayAccess seed) =&gt;
seed -&gt; passPhrase -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#generate"><span class="hs-identifier hs-var hs-var">generate</span></a></span></span><span> </span><span id="local-6989586621679095218"><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679095218"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span id="local-6989586621679095217"><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679095217"><span class="hs-identifier hs-var">passPhrase</span></a></span></span><span>
</span><span id="line-99"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679095218"><span class="hs-identifier hs-var">seed</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;Wallet.generate: seed needs to be &gt;= 32 bytes, got : &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679095218"><span class="hs-identifier hs-var">seed</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-100"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>          </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; XPrv
</span><a href="#local-6989586621679095213"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span>
</span><span id="line-101"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-102"></span><span>    </span><span class="annot"><a href="#local-6989586621679095212"><span class="hs-identifier hs-type">phrase</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Int</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-103"></span><span>    </span><span id="local-6989586621679095212"><span class="annot"><span class="annottext">phrase :: Int -&gt; ByteString
</span><a href="#local-6989586621679095212"><span class="hs-identifier hs-var hs-var">phrase</span></a></span></span><span> </span><span id="local-6989586621679095211"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095211"><span class="hs-identifier hs-var">i</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-string">&quot;Root Seed Chain &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; bs -&gt; bs -&gt; bs
</span><a href="../../../../memory/html/src"><span class="hs-operator hs-var">`B.append`</span></a></span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; ByteString
</span><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-var">BC.pack</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095211"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-104"></span><span>
</span><span id="line-105"></span><span>    </span><span class="hs-comment">-- repeatdly try to generate from a seed, if we reach 1000th iteration we just bail</span><span>
</span><span id="line-106"></span><span>    </span><span class="hs-comment">-- this should find a candidate after 2 tries on average</span><span>
</span><span id="line-107"></span><span>    </span><span id="local-6989586621679095213"><span class="annot"><span class="annottext">loop :: Int -&gt; XPrv
</span><a href="#local-6989586621679095213"><span class="hs-identifier hs-var hs-var">loop</span></a></span></span><span> </span><span id="local-6989586621679095209"><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095209"><span class="hs-identifier hs-var">i</span></a></span></span><span>
</span><span id="line-108"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095209"><span class="hs-identifier hs-var">i</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1000</span></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;internal error: Wallet.generate looping forever&quot;</span></span><span>
</span><span id="line-109"></span><span>        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-110"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">forall passphrase secret cc.
(ByteArrayAccess passphrase, ByteArrayAccess secret,
 ByteArrayAccess cc) =&gt;
secret -&gt; passphrase -&gt; cc -&gt; CryptoFailable EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreate"><span class="hs-identifier hs-var">encryptedCreate</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095206"><span class="hs-identifier hs-var">iL</span></a></span><span> </span><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679095217"><span class="hs-identifier hs-var">passPhrase</span></a></span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679095205"><span class="hs-identifier hs-var">iR</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-111"></span><span>                    </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-type">CryptoPassed</span></a></span><span> </span><span id="local-6989586621679095203"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095203"><span class="hs-identifier hs-var">k</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095203"><span class="hs-identifier hs-var">k</span></a></span><span>
</span><span id="line-112"></span><span>                    </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-type">CryptoFailed</span></a></span><span> </span><span id="local-6989586621679095201"><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679095201"><span class="hs-identifier hs-var">err</span></a></span></span><span>
</span><span id="line-113"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="#local-6989586621679095201"><span class="hs-identifier hs-var">err</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">CryptoError
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">CryptoError_SecretKeyStructureInvalid</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Int -&gt; XPrv
</span><a href="#local-6989586621679095213"><span class="hs-identifier hs-var">loop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095209"><span class="hs-identifier hs-var">i</span></a></span><span class="annot"><span class="annottext">forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">+</span></a></span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-114"></span><span>                        </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>                                    </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">forall a. HasCallStack =&gt; [Char] -&gt; a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;internal error: Wallet.generate: got error from encryptedCreate&quot;</span></span><span>
</span><span id="line-115"></span><span>      </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095206"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095206"><span class="hs-identifier hs-var">iL</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095205"><span class="annot"><span class="annottext">ChainCode
</span><a href="#local-6989586621679095205"><span class="hs-identifier hs-var">iR</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Context SHA512 -&gt; (ByteString, ChainCode)
</span><a href="Cardano.Crypto.Wallet.Pure.html#hFinalize"><span class="hs-identifier hs-var">hFinalize</span></a></span><span>
</span><span id="line-116"></span><span>                     </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">forall message a.
(ByteArrayAccess message, HashAlgorithm a) =&gt;
Context a -&gt; message -&gt; Context a
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">HMAC.update</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; ByteString
</span><a href="#local-6989586621679095212"><span class="hs-identifier hs-var">phrase</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679095209"><span class="hs-identifier hs-var">i</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-117"></span><span>                     </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall seed. ByteArrayAccess seed =&gt; seed -&gt; Context SHA512
</span><a href="Cardano.Crypto.Wallet.Pure.html#hInitSeed"><span class="hs-identifier hs-var">hInitSeed</span></a></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679095218"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-118"></span><span>
</span><span id="line-119"></span><span class="hs-comment">-- | Generate a new XPrv from an entropy seed</span><span>
</span><span id="line-120"></span><span class="hs-comment">--</span><span>
</span><span id="line-121"></span><span class="hs-comment">-- The seed should be at least 16 bytes, although it is not enforced</span><span>
</span><span id="line-122"></span><span class="hs-comment">--</span><span>
</span><span id="line-123"></span><span class="hs-comment">-- The passphrase encrypt the secret key in memory</span><span>
</span><span id="line-124"></span><span id="local-6989586621679095579"><span id="local-6989586621679095580"><span id="local-6989586621679095581"><span class="annot"><a href="Cardano.Crypto.Wallet.html#generateNew"><span class="hs-identifier hs-type">generateNew</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095581"><span class="hs-identifier hs-type">keyPassPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095580"><span class="hs-identifier hs-type">generationPassPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095579"><span class="hs-identifier hs-type">seed</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-125"></span><span>            </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095579"><span class="hs-identifier hs-type">seed</span></a></span><span>                 </span><span class="hs-comment">-- ^ Raw entropy used as source of randomness for this algorithm</span><span>
</span><span id="line-126"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095580"><span class="hs-identifier hs-type">generationPassPhrase</span></a></span><span> </span><span class="hs-comment">-- ^ User chosen passphrase for the generation phase</span><span>
</span><span id="line-127"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095581"><span class="hs-identifier hs-type">keyPassPhrase</span></a></span><span>        </span><span class="hs-comment">-- ^ Symmetric encryption key passphrase used for the in-memory security</span><span>
</span><span id="line-128"></span><span>            </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span></span></span><span>
</span><span id="line-129"></span><span id="generateNew"><span class="annot"><span class="annottext">generateNew :: forall keyPassPhrase generationPassPhrase seed.
(ByteArrayAccess keyPassPhrase,
 ByteArrayAccess generationPassPhrase, ByteArrayAccess seed) =&gt;
seed -&gt; generationPassPhrase -&gt; keyPassPhrase -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#generateNew"><span class="hs-identifier hs-var hs-var">generateNew</span></a></span></span><span> </span><span id="local-6989586621679095188"><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679095188"><span class="hs-identifier hs-var">seed</span></a></span></span><span> </span><span id="local-6989586621679095187"><span class="annot"><span class="annottext">generationPassPhrase
</span><a href="#local-6989586621679095187"><span class="hs-identifier hs-var">genPassPhrase</span></a></span></span><span> </span><span id="local-6989586621679095186"><span class="annot"><span class="annottext">keyPassPhrase
</span><a href="#local-6989586621679095186"><span class="hs-identifier hs-var">memPassPhrase</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-130"></span><span>    </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall passphrase secret.
(ByteArrayAccess passphrase, ByteArrayAccess secret) =&gt;
secret -&gt; passphrase -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedCreateDirectWithTweak"><span class="hs-identifier hs-var">encryptedCreateDirectWithTweak</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095184"><span class="hs-identifier hs-var">out</span></a></span><span> </span><span class="annot"><span class="annottext">keyPassPhrase
</span><a href="#local-6989586621679095186"><span class="hs-identifier hs-var">memPassPhrase</span></a></span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-132"></span><span>    </span><span class="annot"><a href="#local-6989586621679095184"><span class="hs-identifier hs-type">out</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-133"></span><span>    </span><span id="local-6989586621679095184"><span class="annot"><span class="annottext">out :: ByteString
</span><a href="#local-6989586621679095184"><span class="hs-identifier hs-var hs-var">out</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall password salt out.
(ByteArrayAccess password, ByteArrayAccess salt, ByteArray out) =&gt;
Parameters -&gt; password -&gt; salt -&gt; out
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">fastPBKDF2_SHA512</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Int -&gt; Int -&gt; Parameters
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">Parameters</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">4096</span></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">96</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">generationPassPhrase
</span><a href="#local-6989586621679095187"><span class="hs-identifier hs-var">genPassPhrase</span></a></span><span> </span><span class="annot"><span class="annottext">seed
</span><a href="#local-6989586621679095188"><span class="hs-identifier hs-var">seed</span></a></span><span>
</span><span id="line-134"></span><span>
</span><span id="line-135"></span><span class="hs-comment">-- | Simple constructor</span><span>
</span><span id="line-136"></span><span id="local-6989586621679095569"><span class="annot"><a href="Cardano.Crypto.Wallet.html#xprv"><span class="hs-identifier hs-type">xprv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095569"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095569"><span class="hs-identifier hs-type">bin</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span><span>
</span><span id="line-137"></span><span id="xprv"><span class="annot"><span class="annottext">xprv :: forall bin. ByteArrayAccess bin =&gt; bin -&gt; Either [Char] XPrv
</span><a href="Cardano.Crypto.Wallet.html#xprv"><span class="hs-identifier hs-var hs-var">xprv</span></a></span></span><span> </span><span id="local-6989586621679095178"><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679095178"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-138"></span><span>      </span><span class="annot"><span class="annottext">forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;error: xprv needs to be 128 bytes&quot;</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-139"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; Maybe EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedKey"><span class="hs-identifier hs-var">encryptedKey</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="annot"><span class="annottext">bin
</span><a href="#local-6989586621679095178"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-141"></span><span>
</span><span id="line-142"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPrv"><span class="hs-identifier hs-type">unXPrv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-143"></span><span id="unXPrv"><span class="annot"><span class="annottext">unXPrv :: XPrv -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#unXPrv"><span class="hs-identifier hs-var hs-var">unXPrv</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679095174"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095174"><span class="hs-identifier hs-var">e</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">EncryptedKey -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#unEncryptedKey"><span class="hs-identifier hs-var">unEncryptedKey</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095174"><span class="hs-identifier hs-var">e</span></a></span><span>
</span><span id="line-144"></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xpub"><span class="hs-identifier hs-type">xpub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span>
</span><span id="line-146"></span><span id="xpub"><span class="annot"><span class="annottext">xpub :: ByteString -&gt; Either [Char] XPub
</span><a href="Cardano.Crypto.Wallet.html#xpub"><span class="hs-identifier hs-var hs-var">xpub</span></a></span></span><span> </span><span id="local-6989586621679095172"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095172"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-147"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095172"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;error: xprv needs to be 64 bytes: got &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095172"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; bytes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-148"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">=</span><span>
</span><span id="line-149"></span><span>        </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679095170"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095170"><span class="hs-identifier hs-var">b1</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095169"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095169"><span class="hs-identifier hs-var">b2</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095172"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-150"></span><span>         </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095170"><span class="hs-identifier hs-var">b1</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095169"><span class="hs-identifier hs-var">b2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-151"></span><span>
</span><span id="line-152"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#unXPub"><span class="hs-identifier hs-type">unXPub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span>
</span><span id="line-153"></span><span id="unXPub"><span class="annot"><span class="annottext">unXPub :: XPub -&gt; ByteString
</span><a href="Cardano.Crypto.Wallet.html#unXPub"><span class="hs-identifier hs-var hs-var">unXPub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679095167"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095167"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span> </span><span id="local-6989586621679095166"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095166"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; bs -&gt; bs -&gt; bs
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.append</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095167"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095166"><span class="hs-identifier hs-var">cc</span></a></span><span>
</span><span id="line-154"></span><span>
</span><span id="line-155"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xsignature"><span class="hs-identifier hs-type">xsignature</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/bytestring-0.11.3.1/src"><span class="hs-identifier hs-type">ByteString</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Either</span></a></span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span><span>
</span><span id="line-156"></span><span id="xsignature"><span class="annot"><span class="annottext">xsignature :: ByteString -&gt; Either [Char] XSignature
</span><a href="Cardano.Crypto.Wallet.html#xsignature"><span class="hs-identifier hs-var hs-var">xsignature</span></a></span></span><span> </span><span id="local-6989586621679095165"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095165"><span class="hs-identifier hs-var">bs</span></a></span></span><span>
</span><span id="line-157"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095165"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. a -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Left</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot;error: xsignature needs to be 64 bytes: got &quot;</span></span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; Int
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.length</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095165"><span class="hs-identifier hs-var">bs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[Char]
</span><span class="hs-string">&quot; bytes&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-158"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>         </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a b. b -&gt; Either a b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; XSignature
</span><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095165"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="hs-comment">-- | Generate extended public key from private key</span><span>
</span><span id="line-161"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#toXPub"><span class="hs-identifier hs-type">toXPub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">HasCallStack</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span>
</span><span id="line-162"></span><span id="toXPub"><span class="annot"><span class="annottext">toXPub :: HasCallStack =&gt; XPrv -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#toXPub"><span class="hs-identifier hs-var hs-var">toXPub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679095159"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095159"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095158"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095157"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-keyword">where</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span id="local-6989586621679095156"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095156"><span class="hs-identifier hs-var">r</span></a></span></span><span class="hs-special">)</span><span>     </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">64</span></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall bin bout.
(ByteArrayAccess bin, ByteArray bout) =&gt;
bin -&gt; bout
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">convert</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095159"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-164"></span><span>        </span><span class="hs-special">(</span><span id="local-6989586621679095158"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095158"><span class="hs-identifier hs-var">pub</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679095157"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095157"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall bs. ByteArray bs =&gt; Int -&gt; bs -&gt; (bs, bs)
</span><a href="../../../../memory/html/src"><span class="hs-identifier hs-var">B.splitAt</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><span class="hs-number">32</span></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095156"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-165"></span><span>
</span><span id="line-166"></span><span class="hs-comment">-- | Return the Ed25519 public key associated with a XPub context</span><span>
</span><span id="line-167"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPubGetPublicKey"><span class="hs-identifier hs-type">xPubGetPublicKey</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-type">Ed25519.PublicKey</span></a></span><span>
</span><span id="line-168"></span><span id="xPubGetPublicKey"><span class="annot"><span class="annottext">xPubGetPublicKey :: XPub -&gt; PublicKey
</span><a href="Cardano.Crypto.Wallet.html#xPubGetPublicKey"><span class="hs-identifier hs-var hs-var">xPubGetPublicKey</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679095155"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095155"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-169"></span><span>    </span><span class="annot"><span class="annottext">forall a. CryptoFailable a -&gt; a
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">throwCryptoError</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable PublicKey
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">Ed25519.publicKey</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095155"><span class="hs-identifier hs-var">pub</span></a></span><span>
</span><span id="line-170"></span><span>
</span><span id="line-171"></span><span id="local-6989586621679095553"><span id="local-6989586621679095554"><span class="annot"><a href="Cardano.Crypto.Wallet.html#xPrvChangePass"><span class="hs-identifier hs-type">xPrvChangePass</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095554"><span class="hs-identifier hs-type">oldPassPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095553"><span class="hs-identifier hs-type">newPassPhrase</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>               </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095554"><span class="hs-identifier hs-type">oldPassPhrase</span></a></span><span> </span><span class="hs-comment">-- ^ passphrase to decrypt the current encrypted key</span><span>
</span><span id="line-173"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095553"><span class="hs-identifier hs-type">newPassPhrase</span></a></span><span> </span><span class="hs-comment">-- ^ new passphrase to use for the new encrypted key</span><span>
</span><span id="line-174"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-175"></span><span>               </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span></span><span>
</span><span id="line-176"></span><span id="xPrvChangePass"><span class="annot"><span class="annottext">xPrvChangePass :: forall oldPassPhrase newPassPhrase.
(ByteArrayAccess oldPassPhrase, ByteArrayAccess newPassPhrase) =&gt;
oldPassPhrase -&gt; newPassPhrase -&gt; XPrv -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#xPrvChangePass"><span class="hs-identifier hs-var hs-var">xPrvChangePass</span></a></span></span><span> </span><span id="local-6989586621679095149"><span class="annot"><span class="annottext">oldPassPhrase
</span><a href="#local-6989586621679095149"><span class="hs-identifier hs-var">oldPass</span></a></span></span><span> </span><span id="local-6989586621679095148"><span class="annot"><span class="annottext">newPassPhrase
</span><a href="#local-6989586621679095148"><span class="hs-identifier hs-var">newPass</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679095147"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095147"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-177"></span><span>    </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall oldPassPhrase newPassPhrase.
(ByteArrayAccess oldPassPhrase, ByteArrayAccess newPassPhrase) =&gt;
oldPassPhrase -&gt; newPassPhrase -&gt; EncryptedKey -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedChangePass"><span class="hs-identifier hs-var">encryptedChangePass</span></a></span><span> </span><span class="annot"><span class="annottext">oldPassPhrase
</span><a href="#local-6989586621679095149"><span class="hs-identifier hs-var">oldPass</span></a></span><span> </span><span class="annot"><span class="annottext">newPassPhrase
</span><a href="#local-6989586621679095148"><span class="hs-identifier hs-var">newPass</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095147"><span class="hs-identifier hs-var">ekey</span></a></span><span>
</span><span id="line-178"></span><span>
</span><span id="line-179"></span><span class="hs-comment">-- | Derive a child extended private key from an extended private key</span><span>
</span><span id="line-180"></span><span id="local-6989586621679095548"><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPrv"><span class="hs-identifier hs-type">deriveXPrv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095548"><span class="hs-identifier hs-type">passPhrase</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier hs-type">DerivationScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095548"><span class="hs-identifier hs-type">passPhrase</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span></span><span>
</span><span id="line-181"></span><span id="deriveXPrv"><span class="annot"><span class="annottext">deriveXPrv :: forall passPhrase.
ByteArrayAccess passPhrase =&gt;
DerivationScheme -&gt; passPhrase -&gt; XPrv -&gt; Word32 -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#deriveXPrv"><span class="hs-identifier hs-var hs-var">deriveXPrv</span></a></span></span><span> </span><span id="local-6989586621679095143"><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679095143"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span id="local-6989586621679095142"><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679095142"><span class="hs-identifier hs-var">passPhrase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679095141"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095141"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679095140"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679095140"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-182"></span><span>    </span><span class="annot"><span class="annottext">EncryptedKey -&gt; XPrv
</span><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-var">XPrv</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">forall passphrase.
ByteArrayAccess passphrase =&gt;
DerivationScheme
-&gt; EncryptedKey -&gt; passphrase -&gt; Word32 -&gt; EncryptedKey
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePrivate"><span class="hs-identifier hs-var">encryptedDerivePrivate</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679095143"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095141"><span class="hs-identifier hs-var">ekey</span></a></span><span> </span><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679095142"><span class="hs-identifier hs-var">passPhrase</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679095140"><span class="hs-identifier hs-var">n</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-183"></span><span>
</span><span id="line-184"></span><span class="hs-comment">-- | Derive a child extended public key from an extended public key</span><span>
</span><span id="line-185"></span><span class="annot"><a href="Cardano.Crypto.Wallet.html#deriveXPub"><span class="hs-identifier hs-type">deriveXPub</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#DerivationScheme"><span class="hs-identifier hs-type">DerivationScheme</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Word32</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span>
</span><span id="line-186"></span><span id="deriveXPub"><span class="annot"><span class="annottext">deriveXPub :: DerivationScheme -&gt; XPub -&gt; Word32 -&gt; Maybe XPub
</span><a href="Cardano.Crypto.Wallet.html#deriveXPub"><span class="hs-identifier hs-var hs-var">deriveXPub</span></a></span></span><span> </span><span id="local-6989586621679095138"><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679095138"><span class="hs-identifier hs-var">ds</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679095137"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095137"><span class="hs-identifier hs-var">pub</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-type">ChainCode</span></a></span><span> </span><span id="local-6989586621679095136"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095136"><span class="hs-identifier hs-var">cc</span></a></span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679095135"><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679095135"><span class="hs-identifier hs-var">n</span></a></span></span><span>
</span><span id="line-187"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679095135"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Word32
</span><span class="hs-number">0x80000000</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-188"></span><span>    </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">otherwise</span></a></span><span>       </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. a -&gt; Maybe a
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b c. (a -&gt; b -&gt; c) -&gt; (a, b) -&gt; c
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">uncurry</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode -&gt; XPub
</span><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-var">XPub</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall (a :: Type -&gt; Type -&gt; Type) b c d.
Arrow a =&gt;
a b c -&gt; a (d, b) (d, c)
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString -&gt; ChainCode
</span><a href="Cardano.Crypto.Wallet.Types.html#ChainCode"><span class="hs-identifier hs-var">ChainCode</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
-&gt; (ByteString, ByteString) -&gt; Word32 -&gt; (ByteString, ByteString)
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedDerivePublic"><span class="hs-identifier hs-var">encryptedDerivePublic</span></a></span><span> </span><span class="annot"><span class="annottext">DerivationScheme
</span><a href="#local-6989586621679095138"><span class="hs-identifier hs-var">ds</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095137"><span class="hs-identifier hs-var">pub</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095136"><span class="hs-identifier hs-var">cc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Word32
</span><a href="#local-6989586621679095135"><span class="hs-identifier hs-var">n</span></a></span><span>
</span><span id="line-189"></span><span>
</span><span id="line-190"></span><span id="local-6989586621679095535"><span id="local-6989586621679095536"><span class="annot"><a href="Cardano.Crypto.Wallet.html#sign"><span class="hs-identifier hs-type">sign</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095536"><span class="hs-identifier hs-type">passPhrase</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095535"><span class="hs-identifier hs-type">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-191"></span><span>     </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095536"><span class="hs-identifier hs-type">passPhrase</span></a></span><span>
</span><span id="line-192"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span>
</span><span id="line-193"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095535"><span class="hs-identifier hs-type">msg</span></a></span><span>
</span><span id="line-194"></span><span>     </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span></span></span><span>
</span><span id="line-195"></span><span id="sign"><span class="annot"><span class="annottext">sign :: forall passPhrase msg.
(ByteArrayAccess passPhrase, ByteArrayAccess msg) =&gt;
passPhrase -&gt; XPrv -&gt; msg -&gt; XSignature
</span><a href="Cardano.Crypto.Wallet.html#sign"><span class="hs-identifier hs-var hs-var">sign</span></a></span></span><span> </span><span id="local-6989586621679095128"><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679095128"><span class="hs-identifier hs-var">passphrase</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPrv"><span class="hs-identifier hs-type">XPrv</span></a></span><span> </span><span id="local-6989586621679095127"><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095127"><span class="hs-identifier hs-var">ekey</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679095126"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679095126"><span class="hs-identifier hs-var">ba</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-196"></span><span>    </span><span class="annot"><span class="annottext">ByteString -&gt; XSignature
</span><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-var">XSignature</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">let</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.Encrypted.html#Signature"><span class="hs-identifier hs-type">Signature</span></a></span><span> </span><span id="local-6989586621679095124"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095124"><span class="hs-identifier hs-var">sig</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall passphrase msg.
(ByteArrayAccess passphrase, ByteArrayAccess msg) =&gt;
EncryptedKey -&gt; passphrase -&gt; msg -&gt; Signature
</span><a href="Cardano.Crypto.Wallet.Encrypted.html#encryptedSign"><span class="hs-identifier hs-var">encryptedSign</span></a></span><span> </span><span class="annot"><span class="annottext">EncryptedKey
</span><a href="#local-6989586621679095127"><span class="hs-identifier hs-var">ekey</span></a></span><span> </span><span class="annot"><span class="annottext">passPhrase
</span><a href="#local-6989586621679095128"><span class="hs-identifier hs-var">passphrase</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679095126"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095124"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-197"></span><span>
</span><span id="line-198"></span><span id="local-6989586621679095529"><span class="annot"><a href="Cardano.Crypto.Wallet.html#verify"><span class="hs-identifier hs-type">verify</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../../memory/html/src"><span class="hs-identifier hs-type">ByteArrayAccess</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679095529"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679095529"><span class="hs-identifier hs-type">msg</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../../ghc/html/libraries/ghc-prim-0.8.0/src"><span class="hs-identifier hs-type">Bool</span></a></span></span><span>
</span><span id="line-199"></span><span id="verify"><span class="annot"><span class="annottext">verify :: forall msg.
ByteArrayAccess msg =&gt;
XPub -&gt; msg -&gt; XSignature -&gt; Bool
</span><a href="Cardano.Crypto.Wallet.html#verify"><span class="hs-identifier hs-var hs-var">verify</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XPub"><span class="hs-identifier hs-type">XPub</span></a></span><span> </span><span id="local-6989586621679095118"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095118"><span class="hs-identifier hs-var">point</span></a></span></span><span> </span><span class="annot"><span class="annottext">ChainCode
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679095117"><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679095117"><span class="hs-identifier hs-var">ba</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Cardano.Crypto.Wallet.html#XSignature"><span class="hs-identifier hs-type">XSignature</span></a></span><span> </span><span id="local-6989586621679095116"><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095116"><span class="hs-keyword hs-var">signature</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-200"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679095115"><span class="annot"><span class="annottext">pub :: PublicKey
</span><a href="#local-6989586621679095115"><span class="hs-identifier hs-var hs-var">pub</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. CryptoFailable a -&gt; a
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">throwCryptoError</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable PublicKey
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">Ed25519.publicKey</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095118"><span class="hs-identifier hs-var">point</span></a></span><span>
</span><span id="line-201"></span><span>        </span><span id="local-6989586621679095114"><span class="annot"><span class="annottext">sig :: Signature
</span><a href="#local-6989586621679095114"><span class="hs-identifier hs-var hs-var">sig</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">forall a. CryptoFailable a -&gt; a
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">throwCryptoError</span></a></span><span> </span><span class="annot"><span class="annottext">forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../../ghc/html/libraries/base-4.16.4.0/src"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">forall ba. ByteArrayAccess ba =&gt; ba -&gt; CryptoFailable Signature
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">Ed25519.signature</span></a></span><span> </span><span class="annot"><span class="annottext">ByteString
</span><a href="#local-6989586621679095116"><span class="hs-keyword hs-var">signature</span></a></span><span>
</span><span id="line-202"></span><span>     </span><span class="hs-keyword">in</span><span> </span><span class="annot"><span class="annottext">forall ba.
ByteArrayAccess ba =&gt;
PublicKey -&gt; ba -&gt; Signature -&gt; Bool
</span><a href="../../../../cryptonite/html/src"><span class="hs-identifier hs-var">Ed25519.verify</span></a></span><span> </span><span class="annot"><span class="annottext">PublicKey
</span><a href="#local-6989586621679095115"><span class="hs-identifier hs-var">pub</span></a></span><span> </span><span class="annot"><span class="annottext">msg
</span><a href="#local-6989586621679095117"><span class="hs-identifier hs-var">ba</span></a></span><span> </span><span class="annot"><span class="annottext">Signature
</span><a href="#local-6989586621679095114"><span class="hs-identifier hs-var">sig</span></a></span><span>
</span><span id="line-203"></span></pre></body></html>