<!DOCTYPE HTML>
<html lang="en" class="light sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Introduction</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="favicon.svg">
        <link rel="shortcut icon" href="favicon.png">
        <link rel="stylesheet" href="css/variables.css">
        <link rel="stylesheet" href="css/general.css">
        <link rel="stylesheet" href="css/chrome.css">
        <link rel="stylesheet" href="css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="highlight.css">
        <link rel="stylesheet" href="tomorrow-night.css">
        <link rel="stylesheet" href="ayu-highlight.css">

        <!-- Custom theme stylesheets -->


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "light";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('light')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title"></h1>

                    <div class="right-buttons">
                        <a href="print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <details>
<summary> imports </summary>
<p>
<pre><code class="language-haskell">module Plutarch.Docs.Introduction (hf) where
import Plutarch.Prelude
</code></pre>
</p>
</details>
> Note: If you spot any mistakes/have any related questions that this guide lacks the answer to, please don't hesitate to raise an issue. The goal is to have high-quality documentation for Plutarch users!
<h1 id="overview"><a class="header" href="#overview">Overview</a></h1>
<p>Plutarch is an eDSL in Haskell for writing on-chain scripts for Cardano. With some caveats, Plutarch is a <a href="https://en.wikipedia.org/wiki/Simply_typed_lambda_calculus">simply-typed lambda calculus</a> (or STLC). Writing a script in Plutarch allows us to leverage the language features provided by Haskell while retaining the ability to compile to compact Untyped Plutus Core (or UPLC, which is an untyped lambda calculus).</p>
<p>When we talk about "Plutarch scripts," we are referring to values of type <code>Term (s :: S) (a :: PType)</code>. <code>Term</code> is a <code>newtype</code> wrapper around a more complex type, the details of which Plutarch end-users can ignore. A <code>Term</code> is a typed lambda term; it can be thought of as representing a computation that, if successfully evaluated, will return a value of type <code>a</code>.</p>
<p>The two type variables of the <code>Term s a</code> declaration have particular kinds:</p>
<ul>
<li><code>s :: S</code> is like the <code>s</code> of <code>ST s a</code>. It represents the computation context in a manner that mimics mutable state while providing a familiar functional interface. Sections 1 through 4 of [<a href="#references">1</a>] give an accessible introduction to how this works. <code>s</code> is never instantiated with a concrete value; it is merely a type-level way to ensure that computational contexts remain properly encapsulated (i.e., different state threads don't interact). For more in-depth coverage of this and other eDSL design principles used in Plutarch, see [<a href="#references">2</a>].</li>
<li><code>a :: PType</code> is short-hand for "Plutarch Type". We prefix these types with a capital <code>P</code>, such as <code>PInteger</code>, <code>PBool</code>, and so forth. <em>Tagging</em> a <code>Term</code> with a <code>PType</code> indicates the type of the <code>Term</code>'s return value. Doing this allows us to bridge between the simple type system of Plutarch and the untyped UPLC.</li>
</ul>
<p>Note that we <em>should not</em> think of a type of kind <code>PType</code> as carrying a value; it is a tag for a computation that may produce a value. For instance, the definition of <code>PInteger</code> is simply</p>
<pre><code class="language-hs">data PInteger s
</code></pre>
<p>That is, there are no data constructors. <em>If</em> a value of type <code>Term s PInteger</code> successfully executes the computation within context <code>s</code>, the value <em>computed</em> will be an integer. We will never encounter values such as <code>y :: PInteger; y = 3</code>; they simply do not exist. While readers new to Plutarch may need some time to fit this into their mental model, it is a crucial distinction to keep in mind.</p>
<blockquote>
<p>For brevity, we will say a "value of type <code>Term s a</code> will evaluate to (...)". This phrase will carry two implicit notions: one, that <code>Term s a</code> represents a computation executed in the context <code>s</code>; two, evaluating <code>Term s a</code> is not guaranteed to succeed.</p>
</blockquote>
<p>In brief, when writing Plutarch scripts, we have a few tasks:</p>
<ul>
<li>A.) Defining <em>Plutarch Types</em> (or <em><code>PType</code>s</em>). We prefix these types with a capital <code>P</code>, such as <code>PInteger</code>, <code>PMaybe a</code>, <code>PBool</code>, and so forth. As previously mentioned, these form the "tags" for Plutarch <code>Term</code>'s, representing the type of the result of compiling and evaluating a Plutarch Script.</li>
<li>B.) Working with <em>Plutarch <code>Terms</code></em>, which are values of the type <code>Term (s :: S) (a :: PType)</code>. These are the Plutarch scripts themselves, from which we build up more complex scripts before compiling and executing them on-chain.</li>
<li>C.) Writing Haskell-level functions <em>between Plutarch Terms</em> (i.e., with types like <code>Term s a -&gt; Term s b</code>). Doing so allows us to leverage Haskell's language features and ecosystem.</li>
<li>D.) Efficiently Converting the functions from <em>(C.)</em> to <em>Plutarch-level functions</em>, which are of the type <code>Term s (a :--&gt; b)</code>. We can <em>directly</em> convert the functions from (C.) to Plutarch-level functions at the most naive level using <code>plam</code>. Additional Plutarch utilities provide for optimization opportunities.</li>
<li>E.) Compiling and executing the functions from <em>(D.)</em>, targeting UPLC for on-chain usage.</li>
</ul>
<p>As a preview, the bridge Plutarch provides between Haskell and UPLC looks something like this:</p>
<pre><code>------------------------------------------------------
|                  *Haskell World*                   |
------------------------------------------------------
| Values with types like `Bool`, `Integer`, `Maybe a`|
| and regular Haskell functions like a -&gt; b          |
------------------------------------------------------
                           ^                     |
 (functions like `plift`)--|                     |--(functions like `pconstant` or `plam`)
                           |                     |
                           |                     v         (`pcon`)
-------------------------------------------------------    |                     -------------------------------------------------------
|                  *Plutarch Term World*              | &lt;----------------------- |                  *Plutarch Type World*              |
-------------------------------------------------------                          -------------------------------------------------------
| STLC terms; constants like `Term s PInteger` and    | -----------------------&gt; | Types like `PInteger`, `PMaybe a`                   |
| lambdas like `Term s (PInteger :--&gt; PBool)`         |        |                 |                                                     |
-------------------------------------------------------        (`pmatch`)        -------------------------------------------------------
                              |
                              |
                              |--(`compile`)
                              |
                              |
                              v
-------------------------------------------------------
|                    *UPLC World*                     |
-------------------------------------------------------
| Untyped lambda calculus terms. Values of type `Data`|
|                                                     |
-------------------------------------------------------
</code></pre>
<p>Further, you may notice two general categories of functions in Plutarch: "Haskell-level" functions between terms, and "Plutarch-level"
functions <em>as</em> lambda terms. By convention, we will prefix the Haskell-level functions with <code>h</code> and the Plutarch-level lambdas
with <code>p</code>, for example</p>
<pre><code class="language-haskell">-- This example is listed here as a preview; the unfamiliar parts will
-- be detailed below.

-- A Plutarch-level lambda term
pf :: Term s (a :--&gt; b :--&gt; c)
pf = undefined

-- Recovering a Haskell level function from a Plutarch level function
hf :: Term s a -&gt; Term s b -&gt; Term s c
hf x y = pf # x # y
</code></pre>
<p>Note that <code>pf</code> is truly just a Plutarch <code>Term</code> and should not be treated specially.</p>
<p>The remainder of this document cover the bridge between Haskell and Plutarch at a high level. It will <em>not</em> cover all techniques necessary to write production-ready scripts. Nor will it cover the bridge between Plutarch and UPLC beyond the minimum. Nonetheless, it should provide sufficient background to prepare the reader for further study.</p>
<p>Sections:-</p>
<ul>
<li><a href="./Introduction/UntypedPlutusCore.html">Untyped Plutus Core (UPLC)</a></li>
<li><a href="./Introduction/PlutarchTypes.html">Plutarch Types</a></li>
<li><a href="./Introduction/PlutarchTerms.html">Plutarch <code>Term</code>s</a>
<ul>
<li><a href="./Introduction/PlutarchTerms/PlutarchConstants.html">Plutarch Constant <code>Term</code>s</a>
<ul>
<li><a href="./Introduction/PlutarchTerms/PlutarchConstants.html#static-building-of-constant-terms-with-pconstant">Static building of constant <code>Term</code>s with <code>pconstant</code></a></li>
<li><a href="./Introduction/PlutarchTerms/PlutarchConstants.html#dynamic-building-of-constant-terms-with-pcon">Dynamic building of constant <code>Term</code>s with <code>pcon</code></a></li>
<li><a href="./Introduction/PlutarchTerms/PlutarchConstants.html#overloaded-literals">Overloaded literals</a></li>
<li><a href="./Introduction/PlutarchTerms/PlutarchConstants.html#helper-functions">Helper functions</a></li>
</ul>
</li>
<li><a href="./Introduction/PlutarchTerms/PlutarchLambdas.html#lambdas-plutarch-level-function-terms">Lambdas; Plutarch-level Function <code>Term</code>s.</a>
<ul>
<li><a href="./Introduction/PlutarchTerms/PlutarchLambdas.html#function-application">Function Application</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="./Introduction/Patternmatching.html">Pattern matching constant <code>Term</code>s with <code>pmatch</code>.</a></li>
<li><a href="./Introduction/DelayandForce.html">Strictness and Laziness; Delayed Terms and Forcing</a></li>
</ul>
<h1 id="references"><a class="header" href="#references">References</a></h1>
<ul>
<li>[1]<a href="https://www.microsoft.com/en-us/research/wp-content/uploads/1994/06/lazy-functional-state-threads.pdf">Lazy Functional State Threads, by John Launchbury and Simon L Peyton Jones</a></li>
<li>[2]<a href="https://bentnib.org/unembedding.pdf">Unembedding Domain-Specific Languages, by Robert Atkey, Sam Lindley, and Jeremy Yallop</a></li>
<li>[3]<a href="https://www.parsonsmatt.org/2017/04/26/basic_type_level_programming_in_haskell.html">Matt Parson: Basic Type Level Programming in Haskell</a></li>
</ul>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="Overview.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="Introduction/DelayAndForce.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="Overview.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="Introduction/DelayAndForce.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="elasticlunr.min.js"></script>
        <script src="mark.min.js"></script>
        <script src="searcher.js"></script>

        <script src="clipboard.min.js"></script>
        <script src="highlight.js"></script>
        <script src="book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
