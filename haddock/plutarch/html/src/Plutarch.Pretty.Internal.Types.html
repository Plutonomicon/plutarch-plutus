<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span id="local-6989586621679619416"><span id="local-6989586621679619417"></span></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutarch.Pretty.Internal.Types</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-2"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyCursor"><span class="hs-identifier">PrettyCursor</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-3"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier">PrettyState</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">..</span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyMonad"><span class="hs-identifier">PrettyMonad</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#forkState"><span class="hs-identifier">forkState</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#normalizeCursor"><span class="hs-identifier">normalizeCursor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#specializeCursor"><span class="hs-identifier">specializeCursor</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#memorizeName"><span class="hs-identifier">memorizeName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#insertName"><span class="hs-identifier">insertName</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#insertBindings"><span class="hs-identifier">insertBindings</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-11"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#builtinFunAtRef"><span class="hs-identifier">builtinFunAtRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-12"></span><span>  </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#nameOfRef"><span class="hs-identifier">nameOfRef</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-13"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-14"></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#%3C%3D%3C"><span class="hs-operator">(&lt;=&lt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.Reader.html"><span class="hs-identifier">Control.Monad.Reader</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Reader.html#ReaderT"><span class="hs-identifier">ReaderT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.ST.html"><span class="hs-identifier">Control.Monad.ST</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ST.html#ST"><span class="hs-identifier">ST</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.html"><span class="hs-identifier">Control.Monad.State</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#MonadState"><span class="hs-identifier">MonadState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier">get</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier">put</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier">StateT</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#find"><span class="hs-identifier">find</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-20"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier">Map</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-21"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Strict.html"><span class="hs-identifier">Data.Map.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Map</span></span><span>
</span><span id="line-22"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-23"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-24"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier">Text</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-25"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Txt</span></span><span>
</span><span id="line-26"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">System.Random.Stateful</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">STGenM</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StdGen</span></span><span class="hs-special">)</span><span>
</span><span id="line-27"></span><span>
</span><span id="line-28"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore</span></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">PLC</span></span><span>
</span><span id="line-29"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">UntypedPlutusCore</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">DefaultFun</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Index</span></span><span class="hs-special">)</span><span>
</span><span id="line-30"></span><span>
</span><span id="line-31"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Config.html"><span class="hs-identifier">Plutarch.Pretty.Internal.Config</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Pretty.Internal.Config.html#forcedPrefix"><span class="hs-identifier">forcedPrefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-32"></span><span>
</span><span id="line-33"></span><span class="annot"><span class="hs-comment">{- | Notifies the prettifier what &quot;state&quot; the cursor currently is, so it can decide
whether or not to wrap the target expression in parens.

Normal indicates no parens wrapping is necessary, even for complex expressions.

Special indicates complex expressions should be wrapped in parens.

Usually, &quot;Special&quot; just hints at one of three states:

1. Applying - The expression is being applied like a function.
2. Applied - The expression is being applied as a function argument.
3. Unary arg - The expression is being used as an argument to a high arity unary operator (~ and !).
-}</span></span><span>
</span><span id="line-46"></span><span class="hs-keyword">data</span><span> </span><span id="PrettyCursor"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyCursor"><span class="hs-identifier hs-var">PrettyCursor</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="Normal"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#Normal"><span class="hs-identifier hs-var">Normal</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Special"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#Special"><span class="hs-identifier hs-var">Special</span></a></span></span><span>
</span><span id="line-47"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679619476"><span id="local-6989586621679619478"><span class="annot"><span class="annottext">PrettyCursor
PrettyCursor -&gt; PrettyCursor -&gt; Bounded PrettyCursor
forall a. a -&gt; a -&gt; Bounded a
$cminBound :: PrettyCursor
minBound :: PrettyCursor
$cmaxBound :: PrettyCursor
maxBound :: PrettyCursor
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Bounded"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Bounded</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619482"><span id="local-6989586621679619493"><span id="local-6989586621679619501"><span id="local-6989586621679619515"><span id="local-6989586621679619517"><span id="local-6989586621679619521"><span id="local-6989586621679619525"><span id="local-6989586621679619529"><span class="annot"><span class="annottext">Int -&gt; PrettyCursor
PrettyCursor -&gt; Int
PrettyCursor -&gt; [PrettyCursor]
PrettyCursor -&gt; PrettyCursor
PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
PrettyCursor -&gt; PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
(PrettyCursor -&gt; PrettyCursor)
-&gt; (PrettyCursor -&gt; PrettyCursor)
-&gt; (Int -&gt; PrettyCursor)
-&gt; (PrettyCursor -&gt; Int)
-&gt; (PrettyCursor -&gt; [PrettyCursor])
-&gt; (PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor])
-&gt; (PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor])
-&gt; (PrettyCursor -&gt; PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor])
-&gt; Enum PrettyCursor
forall a.
(a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Int -&gt; a)
-&gt; (a -&gt; Int)
-&gt; (a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; [a])
-&gt; (a -&gt; a -&gt; a -&gt; [a])
-&gt; Enum a
$csucc :: PrettyCursor -&gt; PrettyCursor
succ :: PrettyCursor -&gt; PrettyCursor
$cpred :: PrettyCursor -&gt; PrettyCursor
pred :: PrettyCursor -&gt; PrettyCursor
$ctoEnum :: Int -&gt; PrettyCursor
toEnum :: Int -&gt; PrettyCursor
$cfromEnum :: PrettyCursor -&gt; Int
fromEnum :: PrettyCursor -&gt; Int
$cenumFrom :: PrettyCursor -&gt; [PrettyCursor]
enumFrom :: PrettyCursor -&gt; [PrettyCursor]
$cenumFromThen :: PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
enumFromThen :: PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
$cenumFromTo :: PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
enumFromTo :: PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
$cenumFromThenTo :: PrettyCursor -&gt; PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
enumFromThenTo :: PrettyCursor -&gt; PrettyCursor -&gt; PrettyCursor -&gt; [PrettyCursor]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#Enum"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Enum</span></a></span></span></span></span></span></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619533"><span id="local-6989586621679619535"><span class="annot"><span class="annottext">PrettyCursor -&gt; PrettyCursor -&gt; Bool
(PrettyCursor -&gt; PrettyCursor -&gt; Bool)
-&gt; (PrettyCursor -&gt; PrettyCursor -&gt; Bool) -&gt; Eq PrettyCursor
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: PrettyCursor -&gt; PrettyCursor -&gt; Bool
== :: PrettyCursor -&gt; PrettyCursor -&gt; Bool
$c/= :: PrettyCursor -&gt; PrettyCursor -&gt; Bool
/= :: PrettyCursor -&gt; PrettyCursor -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679619540"><span id="local-6989586621679619542"><span id="local-6989586621679619546"><span class="annot"><span class="annottext">Int -&gt; PrettyCursor -&gt; ShowS
[PrettyCursor] -&gt; ShowS
PrettyCursor -&gt; [Char]
(Int -&gt; PrettyCursor -&gt; ShowS)
-&gt; (PrettyCursor -&gt; [Char])
-&gt; ([PrettyCursor] -&gt; ShowS)
-&gt; Show PrettyCursor
forall a.
(Int -&gt; a -&gt; ShowS) -&gt; (a -&gt; [Char]) -&gt; ([a] -&gt; ShowS) -&gt; Show a
$cshowsPrec :: Int -&gt; PrettyCursor -&gt; ShowS
showsPrec :: Int -&gt; PrettyCursor -&gt; ShowS
$cshow :: PrettyCursor -&gt; [Char]
show :: PrettyCursor -&gt; [Char]
$cshowList :: [PrettyCursor] -&gt; ShowS
showList :: [PrettyCursor] -&gt; ShowS
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span>
</span><span id="line-49"></span><span class="hs-keyword">data</span><span> </span><span id="PrettyState"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-var">PrettyState</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="PrettyState"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-var">PrettyState</span></a></span></span><span>
</span><span id="line-50"></span><span>  </span><span class="hs-special">{</span><span> </span><span id="%24sel%3Aps%27nameMap%3APrettyState"><span class="annot"><span class="annottext">PrettyState -&gt; Map Index Text
</span><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27nameMap%3APrettyState"><span class="hs-identifier hs-var hs-var">ps'nameMap</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Index</span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-51"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aps%27names%3APrettyState"><span class="annot"><span class="annottext">PrettyState -&gt; Set Text
</span><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27names%3APrettyState"><span class="hs-identifier hs-var hs-var">ps'names</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-52"></span><span>  </span><span class="hs-special">,</span><span> </span><span id="%24sel%3Aps%27cursor%3APrettyState"><span class="annot"><span class="annottext">PrettyState -&gt; PrettyCursor
</span><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27cursor%3APrettyState"><span class="hs-identifier hs-var hs-var">ps'cursor</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyCursor"><span class="hs-identifier hs-type">PrettyCursor</span></a></span><span>
</span><span id="line-53"></span><span>  </span><span class="hs-special">}</span><span>
</span><span id="line-54"></span><span>
</span><span id="line-55"></span><span class="hs-keyword">type</span><span> </span><span id="PrettyMonad"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyMonad"><span class="hs-identifier hs-var">PrettyMonad</span></a></span></span><span> </span><span id="local-6989586621679619553"><span class="annot"><a href="#local-6989586621679619553"><span class="hs-identifier hs-type">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.Reader.html#ReaderT"><span class="hs-identifier hs-type">ReaderT</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">STGenM</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StdGen</span></span><span> </span><span class="annot"><a href="#local-6989586621679619553"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/transformers-0.6.1.0/src/Control.Monad.Trans.State.Lazy.html#StateT"><span class="hs-identifier hs-type">StateT</span></a></span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.ST.html#ST"><span class="hs-identifier hs-type">ST</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619553"><span class="hs-identifier hs-type">s</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span>
</span><span id="line-57"></span><span id="local-6989586621679619356"><span id="local-6989586621679619357"><span id="local-6989586621679619359"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#forkState"><span class="hs-identifier hs-type">forkState</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#MonadState"><span class="hs-identifier hs-type">MonadState</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619356"><span class="hs-identifier hs-type">s</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619357"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679619357"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619359"><span class="hs-identifier hs-type">b</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679619357"><span class="hs-identifier hs-type">m</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619359"><span class="hs-identifier hs-type">b</span></a></span></span></span></span><span>
</span><span id="line-58"></span><span id="forkState"><span class="annot"><span class="annottext">forkState :: forall s (m :: Type -&gt; Type) b. MonadState s m =&gt; m b -&gt; m b
</span><a href="Plutarch.Pretty.Internal.Types.html#forkState"><span class="hs-identifier hs-var hs-var">forkState</span></a></span></span><span> </span><span id="local-6989586621679619563"><span class="annot"><span class="annottext">m b
</span><a href="#local-6989586621679619563"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">m s
forall s (m :: Type -&gt; Type). MonadState s m =&gt; m s
</span><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#get"><span class="hs-identifier hs-var">get</span></a></span><span> </span><span class="annot"><span class="annottext">m s -&gt; (s -&gt; m b) -&gt; m b
forall a b. m a -&gt; (a -&gt; m b) -&gt; m b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679619564"><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679619564"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">m b
</span><a href="#local-6989586621679619563"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">m b -&gt; m () -&gt; m b
forall a b. m a -&gt; m b -&gt; m a
forall (f :: Type -&gt; Type) a b. Applicative f =&gt; f a -&gt; f b -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%2A"><span class="hs-operator hs-var">&lt;*</span></a></span><span> </span><span class="annot"><span class="annottext">s -&gt; m ()
forall s (m :: Type -&gt; Type). MonadState s m =&gt; s -&gt; m ()
</span><a href="../../../ghc-9.6.6/html/libraries/mtl-2.3.1/src/Control.Monad.State.Class.html#put"><span class="hs-identifier hs-var">put</span></a></span><span> </span><span class="annot"><span class="annottext">s
</span><a href="#local-6989586621679619564"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span>
</span><span id="line-60"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#normalizeCursor"><span class="hs-identifier hs-type">normalizeCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span>
</span><span id="line-61"></span><span id="normalizeCursor"><span class="annot"><span class="annottext">normalizeCursor :: PrettyState -&gt; PrettyState
</span><a href="Plutarch.Pretty.Internal.Types.html#normalizeCursor"><span class="hs-identifier hs-var hs-var">normalizeCursor</span></a></span></span><span> </span><span id="local-6989586621679619566"><span class="annot"><span class="annottext">PrettyState
</span><a href="#local-6989586621679619566"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyState
</span><a href="#local-6989586621679619566"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27cursor%3APrettyState"><span class="hs-identifier hs-var">ps'cursor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#Normal"><span class="hs-identifier hs-type">Normal</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-62"></span><span>
</span><span id="line-63"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#specializeCursor"><span class="hs-identifier hs-type">specializeCursor</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span>
</span><span id="line-64"></span><span id="specializeCursor"><span class="annot"><span class="annottext">specializeCursor :: PrettyState -&gt; PrettyState
</span><a href="Plutarch.Pretty.Internal.Types.html#specializeCursor"><span class="hs-identifier hs-var hs-var">specializeCursor</span></a></span></span><span> </span><span id="local-6989586621679619567"><span class="annot"><span class="annottext">PrettyState
</span><a href="#local-6989586621679619567"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyState
</span><a href="#local-6989586621679619567"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27cursor%3APrettyState"><span class="hs-identifier hs-var">ps'cursor</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#Special"><span class="hs-identifier hs-type">Special</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-65"></span><span>
</span><span id="line-66"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#memorizeName"><span class="hs-identifier hs-type">memorizeName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span>
</span><span id="line-67"></span><span id="memorizeName"><span class="annot"><span class="annottext">memorizeName :: Text -&gt; PrettyState -&gt; PrettyState
</span><a href="Plutarch.Pretty.Internal.Types.html#memorizeName"><span class="hs-identifier hs-var hs-var">memorizeName</span></a></span></span><span> </span><span id="local-6989586621679619568"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619568"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679619569"><span class="annot"><span class="annottext">x :: PrettyState
</span><a href="#local-6989586621679619569"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679619570"><span class="annot"><span class="annottext">Set Text
$sel:ps'names:PrettyState :: PrettyState -&gt; Set Text
ps'names :: Set Text
</span><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27names%3APrettyState"><span class="hs-identifier hs-var hs-var">ps'names</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">PrettyState
</span><a href="#local-6989586621679619569"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27names%3APrettyState"><span class="hs-identifier hs-var">ps'names</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-type">Set.insert</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619568"><span class="hs-identifier hs-type">n</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619570"><span class="hs-identifier hs-type">ps'names</span></a></span><span class="hs-special">}</span><span>
</span><span id="line-68"></span><span>
</span><span id="line-69"></span><span class="annot"><span class="hs-comment">-- | Insert a fresh binding onto the name map, i.e a name at index 0 - incrementing all other indices.</span></span><span>
</span><span id="line-70"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#insertName"><span class="hs-identifier hs-type">insertName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span>
</span><span id="line-71"></span><span id="insertName"><span class="annot"><span class="annottext">insertName :: Text -&gt; PrettyState -&gt; PrettyState
</span><a href="Plutarch.Pretty.Internal.Types.html#insertName"><span class="hs-identifier hs-var hs-var">insertName</span></a></span></span><span> </span><span id="local-6989586621679619572"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619572"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679619573"><span class="annot"><span class="annottext">x :: PrettyState
</span><a href="#local-6989586621679619573"><span class="hs-identifier hs-var">x</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679619574"><span class="annot"><span class="annottext">Map Index Text
$sel:ps'nameMap:PrettyState :: PrettyState -&gt; Map Index Text
ps'nameMap :: Map Index Text
</span><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27nameMap%3APrettyState"><span class="hs-identifier hs-var hs-var">ps'nameMap</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-72"></span><span>  </span><span class="annot"><span class="annottext">PrettyState
</span><a href="#local-6989586621679619573"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-73"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27nameMap%3APrettyState"><span class="hs-identifier hs-var">ps'nameMap</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapKeys"><span class="hs-identifier hs-type">Map.mapKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">+</span></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679619574"><span class="hs-identifier hs-type">ps'nameMap</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Strict.Internal.html#singleton"><span class="hs-identifier hs-type">Map.singleton</span></a></span><span> </span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="annot"><a href="#local-6989586621679619572"><span class="hs-identifier hs-type">name</span></a></span><span>
</span><span id="line-74"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-75"></span><span>
</span><span id="line-76"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#insertBindings"><span class="hs-identifier hs-type">insertBindings</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span>
</span><span id="line-77"></span><span id="insertBindings"><span class="annot"><span class="annottext">insertBindings :: [Text] -&gt; PrettyState -&gt; PrettyState
</span><a href="Plutarch.Pretty.Internal.Types.html#insertBindings"><span class="hs-identifier hs-var hs-var">insertBindings</span></a></span></span><span> </span><span id="local-6989586621679619578"><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679619578"><span class="hs-identifier hs-var">names</span></a></span></span><span> </span><span id="local-6989586621679619579"><span class="annot"><span class="annottext">prst :: PrettyState
</span><a href="#local-6989586621679619579"><span class="hs-identifier hs-var">prst</span></a></span></span><span class="hs-glyph">@</span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#PrettyState"><span class="hs-identifier hs-type">PrettyState</span></a></span><span> </span><span class="hs-special">{</span><span id="local-6989586621679619580"><span class="annot"><span class="annottext">Map Index Text
$sel:ps'nameMap:PrettyState :: PrettyState -&gt; Map Index Text
ps'nameMap :: Map Index Text
</span><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27nameMap%3APrettyState"><span class="hs-identifier hs-var hs-var">ps'nameMap</span></a></span></span><span class="hs-special">}</span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><span class="annottext">PrettyState
</span><a href="#local-6989586621679619579"><span class="hs-identifier hs-var">prst</span></a></span><span>
</span><span id="line-79"></span><span>    </span><span class="hs-special">{</span><span> </span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#%24sel%3Aps%27nameMap%3APrettyState"><span class="hs-identifier hs-var">ps'nameMap</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-80"></span><span>        </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#mapKeys"><span class="hs-identifier hs-type">Map.mapKeys</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">+</span></span><span> </span><span class="annot"><span class="hs-identifier">nameCount</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="#local-6989586621679619580"><span class="hs-identifier hs-type">ps'nameMap</span></a></span><span>
</span><span id="line-81"></span><span>          </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-type">&lt;&gt;</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-type">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#uncurry"><span class="hs-identifier hs-type">uncurry</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Strict.Internal.html#singleton"><span class="hs-identifier hs-type">Map.singleton</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-type">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679619581"><span class="hs-identifier hs-type">nameCount</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-operator hs-type">-</span></a></span><span> </span><span class="annot"><span class="hs-number">1</span></span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><a href="#local-6989586621679619578"><span class="hs-identifier hs-type">names</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-special">}</span><span>
</span><span id="line-83"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-84"></span><span>    </span><span id="local-6989586621679619581"><span class="annot"><span class="annottext">nameCount :: Index
</span><a href="#local-6989586621679619581"><span class="hs-identifier hs-var hs-var">nameCount</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Index
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Int -&gt; Index) -&gt; Int -&gt; Index
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Text] -&gt; Int
forall a. [a] -&gt; Int
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Int
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><a href="#local-6989586621679619578"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-85"></span><span>
</span><span id="line-86"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#builtinFunAtRef"><span class="hs-identifier hs-type">builtinFunAtRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Index</span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Index</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span>
</span><span id="line-87"></span><span id="builtinFunAtRef"><span class="annot"><span class="annottext">builtinFunAtRef :: Map Index Text -&gt; Index -&gt; Maybe DefaultFun
</span><a href="Plutarch.Pretty.Internal.Types.html#builtinFunAtRef"><span class="hs-identifier hs-var hs-var">builtinFunAtRef</span></a></span></span><span> </span><span id="local-6989586621679619585"><span class="annot"><span class="annottext">Map Index Text
</span><a href="#local-6989586621679619585"><span class="hs-identifier hs-var">nameMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe DefaultFun
</span><a href="Plutarch.Pretty.Internal.Types.html#builtinFunFromName"><span class="hs-identifier hs-var">builtinFunFromName</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe DefaultFun)
-&gt; (Index -&gt; Maybe Text) -&gt; Index -&gt; Maybe DefaultFun
forall (m :: Type -&gt; Type) b c a.
Monad m =&gt;
(b -&gt; m c) -&gt; (a -&gt; m b) -&gt; a -&gt; m c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#%3C%3D%3C"><span class="hs-operator hs-var">&lt;=&lt;</span></a></span><span> </span><span class="annot"><span class="annottext">(Index -&gt; Map Index Text -&gt; Maybe Text)
-&gt; Map Index Text -&gt; Index -&gt; Maybe Text
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">Index -&gt; Map Index Text -&gt; Maybe Text
</span><a href="Plutarch.Pretty.Internal.Types.html#nameOfRef"><span class="hs-identifier hs-var">nameOfRef</span></a></span><span> </span><span class="annot"><span class="annottext">Map Index Text
</span><a href="#local-6989586621679619585"><span class="hs-identifier hs-var">nameMap</span></a></span><span>
</span><span id="line-88"></span><span>
</span><span id="line-89"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#nameOfRef"><span class="hs-identifier hs-type">nameOfRef</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Index</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#Map"><span class="hs-identifier hs-type">Map</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Index</span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span>
</span><span id="line-90"></span><span id="nameOfRef"><span class="annot"><span class="annottext">nameOfRef :: Index -&gt; Map Index Text -&gt; Maybe Text
</span><a href="Plutarch.Pretty.Internal.Types.html#nameOfRef"><span class="hs-identifier hs-var hs-var">nameOfRef</span></a></span></span><span> </span><span id="local-6989586621679619588"><span class="annot"><span class="annottext">Index
</span><a href="#local-6989586621679619588"><span class="hs-identifier hs-var">ix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Index -&gt; Map Index Text -&gt; Maybe Text
forall k a. Ord k =&gt; k -&gt; Map k a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Map.Internal.html#lookup"><span class="hs-identifier hs-var">Map.lookup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Index
</span><a href="#local-6989586621679619588"><span class="hs-identifier hs-var">ix</span></a></span><span> </span><span class="annot"><span class="annottext">Index -&gt; Index -&gt; Index
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-operator hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Index
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span>
</span><span id="line-91"></span><span>
</span><span id="line-92"></span><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#builtinFunFromName"><span class="hs-identifier hs-type">builtinFunFromName</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">DefaultFun</span></span><span>
</span><span id="line-93"></span><span id="builtinFunFromName"><span class="annot"><span class="annottext">builtinFunFromName :: Text -&gt; Maybe DefaultFun
</span><a href="Plutarch.Pretty.Internal.Types.html#builtinFunFromName"><span class="hs-identifier hs-var hs-var">builtinFunFromName</span></a></span></span><span> </span><span id="local-6989586621679619590"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619590"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-94"></span><span>  </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html#take"><span class="hs-identifier hs-var">Txt.take</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619592"><span class="hs-identifier hs-var">prefixLen</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619590"><span class="hs-identifier hs-var">res</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Plutarch.Pretty.Internal.Config.html#forcedPrefix"><span class="hs-identifier hs-var">forcedPrefix</span></a></span><span>
</span><span id="line-95"></span><span>    </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe DefaultFun
</span><a href="#local-6989586621679619593"><span class="hs-identifier hs-var">helper</span></a></span><span> </span><span class="annot"><span class="annottext">(Text -&gt; Maybe DefaultFun) -&gt; Text -&gt; Maybe DefaultFun
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Int -&gt; Text -&gt; Text
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html#drop"><span class="hs-identifier hs-var">Txt.drop</span></a></span><span> </span><span class="annot"><span class="annottext">Int
</span><a href="#local-6989586621679619592"><span class="hs-identifier hs-var">prefixLen</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619590"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-96"></span><span>    </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Maybe DefaultFun
</span><a href="#local-6989586621679619593"><span class="hs-identifier hs-var">helper</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619590"><span class="hs-identifier hs-var">res</span></a></span><span>
</span><span id="line-97"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-98"></span><span>    </span><span id="local-6989586621679619592"><span class="annot"><span class="annottext">prefixLen :: Int
</span><a href="#local-6989586621679619592"><span class="hs-identifier hs-var hs-var">prefixLen</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Text -&gt; Int
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html#length"><span class="hs-identifier hs-var">Txt.length</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="Plutarch.Pretty.Internal.Config.html#forcedPrefix"><span class="hs-identifier hs-var">forcedPrefix</span></a></span><span>
</span><span id="line-99"></span><span>    </span><span id="local-6989586621679619593"><span class="annot"><span class="annottext">helper :: Text -&gt; Maybe DefaultFun
</span><a href="#local-6989586621679619593"><span class="hs-identifier hs-var hs-var">helper</span></a></span></span><span> </span><span id="local-6989586621679619600"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619600"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(DefaultFun -&gt; Bool) -&gt; [DefaultFun] -&gt; Maybe DefaultFun
forall (t :: Type -&gt; Type) a.
Foldable t =&gt;
(a -&gt; Bool) -&gt; t a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#find"><span class="hs-identifier hs-var">find</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679619601"><span class="annot"><span class="annottext">DefaultFun
</span><a href="#local-6989586621679619601"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DefaultFun -&gt; Text
forall a. Show a =&gt; a -&gt; Text
</span><a href="Plutarch.Pretty.Internal.Types.html#showText"><span class="hs-identifier hs-var">showText</span></a></span><span> </span><span class="annot"><span class="annottext">DefaultFun
</span><a href="#local-6989586621679619601"><span class="hs-identifier hs-var">e</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; Text -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679619600"><span class="hs-identifier hs-var">s</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[DefaultFun]
</span><a href="#local-6989586621679619603"><span class="hs-identifier hs-var">builtinFunNames</span></a></span><span>
</span><span id="line-100"></span><span>    </span><span id="local-6989586621679619603"><span class="annot"><span class="annottext">builtinFunNames :: [DefaultFun]
</span><a href="#local-6989586621679619603"><span class="hs-identifier hs-var hs-var">builtinFunNames</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item [DefaultFun]
forall a. Bounded a =&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#minBound"><span class="hs-identifier hs-var">minBound</span></a></span><span> </span><span class="hs-glyph">..</span><span> </span><span class="annot"><span class="annottext">Item [DefaultFun]
forall a. Bounded a =&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Enum.html#maxBound"><span class="hs-identifier hs-var">maxBound</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">PLC.DefaultFun</span></span><span class="hs-special">]</span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span id="local-6989586621679619411"><span class="annot"><a href="Plutarch.Pretty.Internal.Types.html#showText"><span class="hs-identifier hs-type">showText</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679619411"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><a href="#local-6989586621679619411"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#Text"><span class="hs-identifier hs-type">Text</span></a></span></span><span>
</span><span id="line-103"></span><span id="showText"><span class="annot"><span class="annottext">showText :: forall a. Show a =&gt; a -&gt; Text
</span><a href="Plutarch.Pretty.Internal.Types.html#showText"><span class="hs-identifier hs-var hs-var">showText</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Char] -&gt; Text
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Internal.html#pack"><span class="hs-identifier hs-var">Txt.pack</span></a></span><span> </span><span class="annot"><span class="annottext">([Char] -&gt; Text) -&gt; (a -&gt; [Char]) -&gt; a -&gt; Text
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; [Char]
forall a. Show a =&gt; a -&gt; [Char]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span>
</span><span id="line-104"></span></pre></body></html>