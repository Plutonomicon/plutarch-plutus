<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# OPTIONS_GHC -Wno-orphans #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutarch.Test.QuickCheck</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-4"></span><span>  </span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propEval"><span class="hs-identifier">propEval</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-5"></span><span>  </span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propEvalFail"><span class="hs-identifier">propEvalFail</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-6"></span><span>  </span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propCompileFail"><span class="hs-identifier">propCompileFail</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-7"></span><span>  </span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propEvalEqual"><span class="hs-identifier">propEvalEqual</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-8"></span><span>  </span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#checkHaskellEquivalent"><span class="hs-identifier">checkHaskellEquivalent</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-9"></span><span>  </span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#checkHaskellEquivalent2"><span class="hs-identifier">checkHaskellEquivalent2</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-10"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-11"></span><span>
</span><span id="line-12"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-13"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Config</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoTracing</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-14"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Prelude</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutarch.Test.Unit.html"><span class="hs-identifier">Plutarch.Test.Unit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Unit.html#TermResult"><span class="hs-identifier">TermResult</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Unit.html#Evaluated"><span class="hs-identifier">Evaluated</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToCompile"><span class="hs-identifier">FailedToCompile</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToEvaluate"><span class="hs-identifier">FailedToEvaluate</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Unit.html#evalTermResult"><span class="hs-identifier">evalTermResult</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-16"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="Plutarch.Test.Utils.html"><span class="hs-identifier">Plutarch.Test.Utils</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Utils.html#precompileTerm"><span class="hs-identifier">precompileTerm</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Utils.html#prettyEquals"><span class="hs-identifier">prettyEquals</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Utils.html#prettyShow"><span class="hs-identifier">prettyShow</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-17"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Prettyprinter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Pretty</span></span><span class="hs-special">)</span><span>
</span><span id="line-18"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TestName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">TestTree</span></span><span class="hs-special">)</span><span>
</span><span id="line-19"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.QuickCheck</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><span class="hs-identifier">Arbitrary</span></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><span class="hs-identifier">Negative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Negative</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>  </span><span class="annot"><span class="hs-identifier">NonNegative</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonNegative</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-identifier">NonPositive</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonPositive</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-24"></span><span>  </span><span class="annot"><span class="hs-identifier">NonZero</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NonZero</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-25"></span><span>  </span><span class="annot"><span class="hs-identifier">Positive</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Positive</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-26"></span><span>  </span><span class="annot"><span class="hs-identifier">Property</span></span><span class="hs-special">,</span><span>
</span><span id="line-27"></span><span>  </span><span class="annot"><span class="hs-identifier">arbitrary</span></span><span class="hs-special">,</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><span class="hs-identifier">counterexample</span></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><span class="hs-identifier">forAllShrinkShow</span></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><span class="hs-identifier">property</span></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><span class="hs-identifier">shrink</span></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><span class="hs-identifier">testProperty</span></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><span class="hs-operator">(===)</span></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-35"></span><span>
</span><span id="line-36"></span><span class="annot"><span class="hs-comment">{- | Like `Plutarch.Test.Unit.testEvalFail` but generate terms

@since WIP
-}</span></span><span>
</span><span id="line-40"></span><span id="local-6989586621679228598"><span id="local-6989586621679228601"><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propEvalFail"><span class="hs-identifier hs-type">propEvalFail</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-41"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621679228598"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228598"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-43"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228598"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679228601"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-44"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span></span></span><span>
</span><span id="line-45"></span><span id="propEvalFail"><span class="annot"><span class="annottext">propEvalFail :: forall a (b :: PType).
(Arbitrary a, Show a) =&gt;
TestName -&gt; (a -&gt; ClosedTerm b) -&gt; TestTree
</span><a href="Plutarch.Test.QuickCheck.html#propEvalFail"><span class="hs-identifier hs-var hs-var">propEvalFail</span></a></span></span><span> </span><span id="local-6989586621679228841"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228841"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679228842"><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679228842"><span class="hs-identifier hs-var">mkTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-46"></span><span>  </span><span class="annot"><span class="annottext">TestName -&gt; Property -&gt; TestTree
forall a. Testable a =&gt; TestName -&gt; a -&gt; TestTree
</span><span class="hs-identifier hs-var">testProperty</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228841"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; TestTree) -&gt; Property -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
-&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; Property) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkShow</span></span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Property) -&gt; Property) -&gt; (a -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679228844"><span id="local-6989586621679228845"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228845"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679228844"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-47"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; ClosedTerm b -&gt; TermResult
forall (a :: PType). Config -&gt; ClosedTerm a -&gt; TermResult
</span><a href="Plutarch.Test.Unit.html#evalTermResult"><span class="hs-identifier hs-var">evalTermResult</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier hs-var">NoTracing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679228842"><span class="hs-identifier hs-var">mkTerm</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228845"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-48"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToCompile"><span class="hs-identifier hs-type">FailedToCompile</span></a></span><span> </span><span id="local-6989586621679228846"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679228846"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to compile: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">Text.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679228846"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-49"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToEvaluate"><span class="hs-identifier hs-type">FailedToEvaluate</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-50"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#Evaluated"><span class="hs-identifier hs-type">Evaluated</span></a></span><span> </span><span id="local-6989586621679228848"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228848"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Evaluated, but expected failure: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228848"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-51"></span><span>
</span><span id="line-52"></span><span class="annot"><span class="hs-comment">{- | Like `Plutarch.Test.Unit.testCompileFail` but generate terms

@since WIP
-}</span></span><span>
</span><span id="line-56"></span><span id="local-6989586621679228849"><span id="local-6989586621679228850"><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propCompileFail"><span class="hs-identifier hs-type">propCompileFail</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-57"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621679228849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228849"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-58"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-59"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228849"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679228850"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-60"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span></span></span><span>
</span><span id="line-61"></span><span id="propCompileFail"><span class="annot"><span class="annottext">propCompileFail :: forall a (b :: PType).
(Arbitrary a, Show a) =&gt;
TestName -&gt; (a -&gt; ClosedTerm b) -&gt; TestTree
</span><a href="Plutarch.Test.QuickCheck.html#propCompileFail"><span class="hs-identifier hs-var hs-var">propCompileFail</span></a></span></span><span> </span><span id="local-6989586621679228967"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228967"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679228968"><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679228968"><span class="hs-identifier hs-var">mkTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-62"></span><span>  </span><span class="annot"><span class="annottext">TestName -&gt; Property -&gt; TestTree
forall a. Testable a =&gt; TestName -&gt; a -&gt; TestTree
</span><span class="hs-identifier hs-var">testProperty</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228967"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; TestTree) -&gt; Property -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
-&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; Property) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkShow</span></span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Property) -&gt; Property) -&gt; (a -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679228969"><span id="local-6989586621679228970"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228970"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679228969"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-63"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; ClosedTerm b -&gt; TermResult
forall (a :: PType). Config -&gt; ClosedTerm a -&gt; TermResult
</span><a href="Plutarch.Test.Unit.html#evalTermResult"><span class="hs-identifier hs-var">evalTermResult</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier hs-var">NoTracing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679228968"><span class="hs-identifier hs-var">mkTerm</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679228970"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-64"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToCompile"><span class="hs-identifier hs-type">FailedToCompile</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-65"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToEvaluate"><span class="hs-identifier hs-type">FailedToEvaluate</span></a></span><span> </span><span id="local-6989586621679228971"><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679228971"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to evaluate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679228971"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-66"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#Evaluated"><span class="hs-identifier hs-type">Evaluated</span></a></span><span> </span><span id="local-6989586621679228972"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228972"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Evaluated, but expected failure: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679228972"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-67"></span><span>
</span><span id="line-68"></span><span class="annot"><span class="hs-comment">{- | Like `Plutarch.Test.Unit.testEvalEqual` but generate terms

@since WIP
-}</span></span><span>
</span><span id="line-72"></span><span id="local-6989586621679228721"><span id="local-6989586621679228722"><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propEvalEqual"><span class="hs-identifier hs-type">propEvalEqual</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-73"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621679228721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679228721"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-74"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-75"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Actual</span></span><span>
</span><span id="line-76"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228721"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679228722"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Expected</span></span><span>
</span><span id="line-78"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228721"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679228722"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span></span></span><span>
</span><span id="line-80"></span><span id="propEvalEqual"><span class="annot"><span class="annottext">propEvalEqual :: forall a (b :: PType).
(Arbitrary a, Show a) =&gt;
TestName -&gt; (a -&gt; ClosedTerm b) -&gt; (a -&gt; ClosedTerm b) -&gt; TestTree
</span><a href="Plutarch.Test.QuickCheck.html#propEvalEqual"><span class="hs-identifier hs-var hs-var">propEvalEqual</span></a></span></span><span> </span><span id="local-6989586621679229071"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229071"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679229072"><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679229072"><span class="hs-identifier hs-var">mkTerm</span></a></span></span><span> </span><span id="local-6989586621679229073"><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679229073"><span class="hs-identifier hs-var">mkExpected</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><span class="annottext">TestName -&gt; Property -&gt; TestTree
forall a. Testable a =&gt; TestName -&gt; a -&gt; TestTree
</span><span class="hs-identifier hs-var">testProperty</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229071"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; TestTree) -&gt; Property -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
-&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; Property) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkShow</span></span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Property) -&gt; Property) -&gt; (a -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679229074"><span id="local-6989586621679229075"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229075"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679229074"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-82"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; ClosedTerm b -&gt; TermResult
forall (a :: PType). Config -&gt; ClosedTerm a -&gt; TermResult
</span><a href="Plutarch.Test.Unit.html#evalTermResult"><span class="hs-identifier hs-var">evalTermResult</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier hs-var">NoTracing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679229072"><span class="hs-identifier hs-var">mkTerm</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229075"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-83"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToCompile"><span class="hs-identifier hs-type">FailedToCompile</span></a></span><span> </span><span id="local-6989586621679229076"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679229076"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to compile: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">Text.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679229076"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-84"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToEvaluate"><span class="hs-identifier hs-type">FailedToEvaluate</span></a></span><span> </span><span id="local-6989586621679229077"><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679229077"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to evaluate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679229077"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-85"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#Evaluated"><span class="hs-identifier hs-type">Evaluated</span></a></span><span> </span><span id="local-6989586621679229078"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229078"><span class="hs-identifier hs-var">actual</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; ClosedTerm b -&gt; TermResult
forall (a :: PType). Config -&gt; ClosedTerm a -&gt; TermResult
</span><a href="Plutarch.Test.Unit.html#evalTermResult"><span class="hs-identifier hs-var">evalTermResult</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier hs-var">NoTracing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679229073"><span class="hs-identifier hs-var">mkExpected</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229075"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-86"></span><span>        </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToCompile"><span class="hs-identifier hs-type">FailedToCompile</span></a></span><span> </span><span id="local-6989586621679229079"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679229079"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to compile expected term: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">Text.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679229079"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-87"></span><span>        </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToEvaluate"><span class="hs-identifier hs-type">FailedToEvaluate</span></a></span><span> </span><span id="local-6989586621679229080"><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679229080"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to evaluate expected term: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679229080"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-88"></span><span>        </span><span class="annot"><a href="Plutarch.Test.Unit.html#Evaluated"><span class="hs-identifier hs-type">Evaluated</span></a></span><span> </span><span id="local-6989586621679229081"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229081"><span class="hs-identifier hs-var">expected</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229078"><span class="hs-identifier hs-var">actual</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; Property
forall a. (Eq a, Show a) =&gt; a -&gt; a -&gt; Property
</span><span class="hs-operator hs-var">===</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229081"><span class="hs-identifier hs-var">expected</span></a></span><span>
</span><span id="line-89"></span><span>
</span><span id="line-90"></span><span class="annot"><span class="hs-comment">{- | Like `Plutarch.Test.Unit.testEval` but generate terms

@since WIP
-}</span></span><span>
</span><span id="line-94"></span><span id="local-6989586621679229082"><span id="local-6989586621679229083"><span class="annot"><a href="Plutarch.Test.QuickCheck.html#propEval"><span class="hs-identifier hs-type">propEval</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="annot"><a href="#local-6989586621679229082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-type">Show</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679229082"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679229082"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679229083"><span class="hs-identifier hs-type">b</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span></span></span><span>
</span><span id="line-95"></span><span id="propEval"><span class="annot"><span class="annottext">propEval :: forall a (b :: PType).
(Arbitrary a, Show a) =&gt;
TestName -&gt; (a -&gt; ClosedTerm b) -&gt; TestTree
</span><a href="Plutarch.Test.QuickCheck.html#propEval"><span class="hs-identifier hs-var hs-var">propEval</span></a></span></span><span> </span><span id="local-6989586621679229168"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229168"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679229169"><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679229169"><span class="hs-identifier hs-var">mkTerm</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-96"></span><span>  </span><span class="annot"><span class="annottext">TestName -&gt; Property -&gt; TestTree
forall a. Testable a =&gt; TestName -&gt; a -&gt; TestTree
</span><span class="hs-identifier hs-var">testProperty</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679229168"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(Property -&gt; TestTree) -&gt; Property -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Gen a
-&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; Property) -&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkShow</span></span><span> </span><span class="annot"><span class="annottext">Gen a
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; [a]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">a -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">((a -&gt; Property) -&gt; Property) -&gt; (a -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679229170"><span id="local-6989586621679229171"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229171"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679229170"><span class="hs-identifier hs-type">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-97"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Config -&gt; ClosedTerm b -&gt; TermResult
forall (a :: PType). Config -&gt; ClosedTerm a -&gt; TermResult
</span><a href="Plutarch.Test.Unit.html#evalTermResult"><span class="hs-identifier hs-var">evalTermResult</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier hs-var">NoTracing</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; ClosedTerm b
</span><a href="#local-6989586621679229169"><span class="hs-identifier hs-var">mkTerm</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679229171"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-98"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToCompile"><span class="hs-identifier hs-type">FailedToCompile</span></a></span><span> </span><span id="local-6989586621679229172"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679229172"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to compile: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">Text.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679229172"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-99"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#FailedToEvaluate"><span class="hs-identifier hs-type">FailedToEvaluate</span></a></span><span> </span><span id="local-6989586621679229173"><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679229173"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool -&gt; Property
forall prop. Testable prop =&gt; TestName -&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">counterexample</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to evaluate: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">EvalError
</span><a href="#local-6989586621679229173"><span class="hs-identifier hs-var">err</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-100"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Unit.html#Evaluated"><span class="hs-identifier hs-type">Evaluated</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Property
forall prop. Testable prop =&gt; prop -&gt; Property
</span><span class="hs-identifier hs-var">property</span></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-101"></span><span>
</span><span id="line-102"></span><span class="annot"><span class="hs-comment">-- | @since WIP</span></span><span>
</span><span id="line-103"></span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#checkHaskellEquivalent"><span class="hs-identifier hs-type">checkHaskellEquivalent</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-104"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228733"><span class="annot"><a href="#local-6989586621679228733"><span class="hs-identifier hs-type">plutarchInput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228735"><span class="annot"><a href="#local-6989586621679228735"><span class="hs-identifier hs-type">plutarchOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-105"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PLiftable</span></span><span> </span><span class="annot"><a href="#local-6989586621679228733"><span class="hs-identifier hs-type">plutarchInput</span></a></span><span>
</span><span id="line-106"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PLiftable</span></span><span> </span><span class="annot"><a href="#local-6989586621679228735"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span>
</span><span id="line-107"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228733"><span class="hs-identifier hs-type">plutarchInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-108"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228733"><span class="hs-identifier hs-type">plutarchInput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-109"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228735"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-110"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228735"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-111"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-112"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228733"><span class="hs-identifier hs-type">plutarchInput</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228735"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228733"><span class="hs-identifier hs-type">plutarchInput</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679228735"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-115"></span><span id="checkHaskellEquivalent"><span class="annot"><span class="annottext">checkHaskellEquivalent :: forall (plutarchInput :: PType) (plutarchOutput :: PType).
(PLiftable plutarchInput, PLiftable plutarchOutput,
 Pretty (AsHaskell plutarchInput),
 Arbitrary (AsHaskell plutarchInput),
 Pretty (AsHaskell plutarchOutput),
 Eq (AsHaskell plutarchOutput)) =&gt;
(AsHaskell plutarchInput -&gt; AsHaskell plutarchOutput)
-&gt; ClosedTerm (plutarchInput :--&gt; plutarchOutput) -&gt; Property
</span><a href="Plutarch.Test.QuickCheck.html#checkHaskellEquivalent"><span class="hs-identifier hs-var hs-var">checkHaskellEquivalent</span></a></span></span><span> </span><span id="local-6989586621679229187"><span class="annot"><span class="annottext">AsHaskell plutarchInput -&gt; AsHaskell plutarchOutput
</span><a href="#local-6989586621679229187"><span class="hs-identifier hs-var">goHaskell</span></a></span></span><span> </span><span id="local-6989586621679229188"><span class="annot"><span class="annottext">ClosedTerm (plutarchInput :--&gt; plutarchOutput)
</span><a href="#local-6989586621679229188"><span class="hs-identifier hs-var">goPlutarch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="annottext">Gen (AsHaskell plutarchInput)
-&gt; (AsHaskell plutarchInput -&gt; [AsHaskell plutarchInput])
-&gt; (AsHaskell plutarchInput -&gt; TestName)
-&gt; (AsHaskell plutarchInput -&gt; Property)
-&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkShow</span></span><span> </span><span class="annot"><span class="annottext">Gen (AsHaskell plutarchInput)
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput -&gt; [AsHaskell plutarchInput]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput -&gt; TestName
forall a. Pretty a =&gt; a -&gt; TestName
</span><a href="Plutarch.Test.Utils.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">((AsHaskell plutarchInput -&gt; Property) -&gt; Property)
-&gt; (AsHaskell plutarchInput -&gt; Property) -&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-117"></span><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679229189"><span id="local-6989586621679229190"><span class="annot"><span class="annottext">AsHaskell plutarchInput
</span><a href="#local-6989586621679229190"><span class="hs-identifier hs-var">input</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="#local-6989586621679229189"><span class="hs-identifier hs-type">haskellInput</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput -&gt; AsHaskell plutarchOutput
</span><a href="#local-6989586621679229187"><span class="hs-identifier hs-var">goHaskell</span></a></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput
</span><a href="#local-6989586621679229190"><span class="hs-identifier hs-var">input</span></a></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchOutput -&gt; AsHaskell plutarchOutput -&gt; Property
forall a. (Eq a, Pretty a) =&gt; a -&gt; a -&gt; Property
</span><a href="Plutarch.Test.Utils.html#prettyEquals"><span class="hs-operator hs-var">`prettyEquals`</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (s :: S). Term s plutarchOutput)
-&gt; AsHaskell plutarchOutput
forall (a :: PType).
PLiftable a =&gt;
(forall (s :: S). Term s a) -&gt; AsHaskell a
</span><span class="hs-identifier hs-var">plift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (plutarchInput :--&gt; plutarchOutput)
ClosedTerm (plutarchInput :--&gt; plutarchOutput)
</span><a href="#local-6989586621679229193"><span class="hs-identifier hs-var">pfun</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (plutarchInput :--&gt; plutarchOutput)
-&gt; Term s plutarchInput -&gt; Term s plutarchOutput
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput -&gt; Term s plutarchInput
forall (a :: PType) (s :: S).
PLiftable a =&gt;
AsHaskell a -&gt; Term s a
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput
</span><a href="#local-6989586621679229190"><span class="hs-identifier hs-var">input</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-119"></span><span>    </span><span class="annot"><a href="#local-6989586621679229193"><span class="hs-identifier hs-type">pfun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228733"><span class="hs-identifier hs-type">plutarchInput</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679228735"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-120"></span><span>    </span><span id="local-6989586621679229193"><span class="annot"><span class="annottext">pfun :: ClosedTerm (plutarchInput :--&gt; plutarchOutput)
</span><a href="#local-6989586621679229193"><span class="hs-identifier hs-var hs-var">pfun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm (plutarchInput :--&gt; plutarchOutput)
-&gt; ClosedTerm (plutarchInput :--&gt; plutarchOutput)
forall (p :: PType). ClosedTerm p -&gt; ClosedTerm p
</span><a href="Plutarch.Test.Utils.html#precompileTerm"><span class="hs-identifier hs-var">precompileTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (plutarchInput :--&gt; plutarchOutput)
ClosedTerm (plutarchInput :--&gt; plutarchOutput)
</span><a href="#local-6989586621679229188"><span class="hs-identifier hs-var">goPlutarch</span></a></span><span>
</span><span id="line-121"></span><span>
</span><span id="line-122"></span><span class="annot"><span class="hs-comment">-- | @since WIP</span></span><span>
</span><span id="line-123"></span><span class="annot"><a href="Plutarch.Test.QuickCheck.html#checkHaskellEquivalent2"><span class="hs-identifier hs-type">checkHaskellEquivalent2</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-keyword">forall</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228754"><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228755"><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span id="local-6989586621679228756"><span class="annot"><a href="#local-6989586621679228756"><span class="hs-identifier hs-type">plutarchOutput</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">S</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Type"><span class="hs-identifier hs-type">Type</span></a></span><span class="hs-special">)</span><span class="hs-operator">.</span><span>
</span><span id="line-125"></span><span>  </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PLiftable</span></span><span> </span><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span><span>
</span><span id="line-126"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-127"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-128"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PLiftable</span></span><span> </span><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span><span>
</span><span id="line-129"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-130"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Arbitrary</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-131"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">PLiftable</span></span><span> </span><span class="annot"><a href="#local-6989586621679228756"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span>
</span><span id="line-132"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228756"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>  </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-type">Eq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228756"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-134"></span><span>  </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=&gt;</span><span>
</span><span id="line-135"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228756"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-136"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679228756"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-137"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Property</span></span><span>
</span><span id="line-138"></span><span id="checkHaskellEquivalent2"><span class="annot"><span class="annottext">checkHaskellEquivalent2 :: forall (plutarchInput1 :: PType) (plutarchInput2 :: PType)
       (plutarchOutput :: PType).
(PLiftable plutarchInput1, Pretty (AsHaskell plutarchInput1),
 Arbitrary (AsHaskell plutarchInput1), PLiftable plutarchInput2,
 Pretty (AsHaskell plutarchInput2),
 Arbitrary (AsHaskell plutarchInput2), PLiftable plutarchOutput,
 Pretty (AsHaskell plutarchOutput),
 Eq (AsHaskell plutarchOutput)) =&gt;
(AsHaskell plutarchInput1
 -&gt; AsHaskell plutarchInput2 -&gt; AsHaskell plutarchOutput)
-&gt; ClosedTerm
     (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
-&gt; Property
</span><a href="Plutarch.Test.QuickCheck.html#checkHaskellEquivalent2"><span class="hs-identifier hs-var hs-var">checkHaskellEquivalent2</span></a></span></span><span> </span><span id="local-6989586621679229214"><span class="annot"><span class="annottext">AsHaskell plutarchInput1
-&gt; AsHaskell plutarchInput2 -&gt; AsHaskell plutarchOutput
</span><a href="#local-6989586621679229214"><span class="hs-identifier hs-var">goHaskell</span></a></span></span><span> </span><span id="local-6989586621679229215"><span class="annot"><span class="annottext">ClosedTerm
  (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
</span><a href="#local-6989586621679229215"><span class="hs-identifier hs-var">goPlutarch</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-139"></span><span>  </span><span class="annot"><span class="annottext">Gen (AsHaskell plutarchInput1, AsHaskell plutarchInput2)
-&gt; ((AsHaskell plutarchInput1, AsHaskell plutarchInput2)
    -&gt; [(AsHaskell plutarchInput1, AsHaskell plutarchInput2)])
-&gt; ((AsHaskell plutarchInput1, AsHaskell plutarchInput2)
    -&gt; TestName)
-&gt; ((AsHaskell plutarchInput1, AsHaskell plutarchInput2)
    -&gt; Property)
-&gt; Property
forall prop a.
Testable prop =&gt;
Gen a -&gt; (a -&gt; [a]) -&gt; (a -&gt; TestName) -&gt; (a -&gt; prop) -&gt; Property
</span><span class="hs-identifier hs-var">forAllShrinkShow</span></span><span> </span><span class="annot"><span class="annottext">Gen (AsHaskell plutarchInput1, AsHaskell plutarchInput2)
forall a. Arbitrary a =&gt; Gen a
</span><span class="hs-identifier hs-var">arbitrary</span></span><span> </span><span class="annot"><span class="annottext">(AsHaskell plutarchInput1, AsHaskell plutarchInput2)
-&gt; [(AsHaskell plutarchInput1, AsHaskell plutarchInput2)]
forall a. Arbitrary a =&gt; a -&gt; [a]
</span><span class="hs-identifier hs-var">shrink</span></span><span> </span><span class="annot"><span class="annottext">(AsHaskell plutarchInput1, AsHaskell plutarchInput2) -&gt; TestName
forall a. Pretty a =&gt; a -&gt; TestName
</span><a href="Plutarch.Test.Utils.html#prettyShow"><span class="hs-identifier hs-var">prettyShow</span></a></span><span> </span><span class="annot"><span class="annottext">(((AsHaskell plutarchInput1, AsHaskell plutarchInput2) -&gt; Property)
 -&gt; Property)
-&gt; ((AsHaskell plutarchInput1, AsHaskell plutarchInput2)
    -&gt; Property)
-&gt; Property
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-140"></span><span>    </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679229216"><span class="annot"><span class="annottext">AsHaskell plutarchInput1
</span><a href="#local-6989586621679229216"><span class="hs-identifier hs-var">input1</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679229217"><span class="annot"><span class="annottext">AsHaskell plutarchInput2
</span><a href="#local-6989586621679229217"><span class="hs-identifier hs-var">input2</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">AsHaskell</span></span><span> </span><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-141"></span><span>      </span><span class="annot"><span class="annottext">AsHaskell plutarchInput1
-&gt; AsHaskell plutarchInput2 -&gt; AsHaskell plutarchOutput
</span><a href="#local-6989586621679229214"><span class="hs-identifier hs-var">goHaskell</span></a></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput1
</span><a href="#local-6989586621679229216"><span class="hs-identifier hs-var">input1</span></a></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput2
</span><a href="#local-6989586621679229217"><span class="hs-identifier hs-var">input2</span></a></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchOutput -&gt; AsHaskell plutarchOutput -&gt; Property
forall a. (Eq a, Pretty a) =&gt; a -&gt; a -&gt; Property
</span><a href="Plutarch.Test.Utils.html#prettyEquals"><span class="hs-operator hs-var">`prettyEquals`</span></a></span><span> </span><span class="annot"><span class="annottext">(forall (s :: S). Term s plutarchOutput)
-&gt; AsHaskell plutarchOutput
forall (a :: PType).
PLiftable a =&gt;
(forall (s :: S). Term s a) -&gt; AsHaskell a
</span><span class="hs-identifier hs-var">plift</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Term s (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
ClosedTerm
  (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
</span><a href="#local-6989586621679229220"><span class="hs-identifier hs-var">pfun</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
-&gt; Term s plutarchInput1
-&gt; Term s (plutarchInput2 :--&gt; plutarchOutput)
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput1 -&gt; Term s plutarchInput1
forall (a :: PType) (s :: S).
PLiftable a =&gt;
AsHaskell a -&gt; Term s a
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput1
</span><a href="#local-6989586621679229216"><span class="hs-identifier hs-var">input1</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (plutarchInput2 :--&gt; plutarchOutput)
-&gt; Term s plutarchInput2 -&gt; Term s plutarchOutput
forall (s :: S) (a :: PType) (b :: PType).
Term s (a :--&gt; b) -&gt; Term s a -&gt; Term s b
</span><span class="hs-operator hs-var">#</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput2 -&gt; Term s plutarchInput2
forall (a :: PType) (s :: S).
PLiftable a =&gt;
AsHaskell a -&gt; Term s a
</span><span class="hs-identifier hs-var">pconstant</span></span><span> </span><span class="annot"><span class="annottext">AsHaskell plutarchInput2
</span><a href="#local-6989586621679229217"><span class="hs-identifier hs-var">input2</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-142"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-143"></span><span>    </span><span class="annot"><a href="#local-6989586621679229220"><span class="hs-identifier hs-type">pfun</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679228754"><span class="hs-identifier hs-type">plutarchInput1</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679228755"><span class="hs-identifier hs-type">plutarchInput2</span></a></span><span> </span><span class="annot"><span class="hs-operator hs-type">:--&gt;</span></span><span> </span><span class="annot"><a href="#local-6989586621679228756"><span class="hs-identifier hs-type">plutarchOutput</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-144"></span><span>    </span><span id="local-6989586621679229220"><span class="annot"><span class="annottext">pfun :: ClosedTerm
  (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
</span><a href="#local-6989586621679229220"><span class="hs-identifier hs-var hs-var">pfun</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">ClosedTerm
  (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
-&gt; ClosedTerm
     (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
forall (p :: PType). ClosedTerm p -&gt; ClosedTerm p
</span><a href="Plutarch.Test.Utils.html#precompileTerm"><span class="hs-identifier hs-var">precompileTerm</span></a></span><span> </span><span class="annot"><span class="annottext">Term s (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
ClosedTerm
  (plutarchInput1 :--&gt; (plutarchInput2 :--&gt; plutarchOutput))
</span><a href="#local-6989586621679229215"><span class="hs-identifier hs-var">goPlutarch</span></a></span><span>
</span><span id="line-145"></span><span>
</span><span id="line-146"></span><span class="annot"><span class="hs-comment">-- * Orphans</span></span><span>
</span><span id="line-147"></span><span>
</span><span id="line-148"></span><span class="annot"><span class="hs-comment">-- | @since WIP</span></span><span>
</span><span id="line-149"></span><span id="local-6989586621679229223"><span id="local-6989586621679229227"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679228775"><span class="annot"><a href="#local-6989586621679228775"><span class="hs-keyword hs-type">newtype</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679228775"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Positive</span></span><span> </span><span class="annot"><a href="#local-6989586621679228775"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-150"></span><span>
</span><span id="line-151"></span><span class="annot"><span class="hs-comment">-- | @since WIP</span></span><span>
</span><span id="line-152"></span><span id="local-6989586621679229234"><span id="local-6989586621679229238"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679228780"><span class="annot"><a href="#local-6989586621679228780"><span class="hs-keyword hs-type">newtype</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679228780"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">Negative</span></span><span> </span><span class="annot"><a href="#local-6989586621679228780"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-153"></span><span>
</span><span id="line-154"></span><span class="annot"><span class="hs-comment">-- | @since WIP</span></span><span>
</span><span id="line-155"></span><span id="local-6989586621679229244"><span id="local-6989586621679229248"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679228785"><span class="annot"><a href="#local-6989586621679228785"><span class="hs-keyword hs-type">newtype</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679228785"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonZero</span></span><span> </span><span class="annot"><a href="#local-6989586621679228785"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-156"></span><span>
</span><span id="line-157"></span><span class="annot"><span class="hs-comment">-- | @since WIP</span></span><span>
</span><span id="line-158"></span><span id="local-6989586621679229254"><span id="local-6989586621679229258"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679228790"><span class="annot"><a href="#local-6989586621679228790"><span class="hs-keyword hs-type">newtype</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679228790"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonNegative</span></span><span> </span><span class="annot"><a href="#local-6989586621679228790"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-159"></span><span>
</span><span id="line-160"></span><span class="annot"><span class="hs-comment">-- | @since WIP</span></span><span>
</span><span id="line-161"></span><span id="local-6989586621679229264"><span id="local-6989586621679229268"><span class="hs-keyword">deriving</span><span> </span><span id="local-6989586621679228795"><span class="annot"><a href="#local-6989586621679228795"><span class="hs-keyword hs-type">newtype</span></a></span></span><span> </span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="annot"><a href="#local-6989586621679228795"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Pretty</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">NonPositive</span></span><span> </span><span class="annot"><a href="#local-6989586621679228795"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span>
</span><span id="line-162"></span></pre></body></html>