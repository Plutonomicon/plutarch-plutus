<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"><html xmlns="http://www.w3.org/1999/xhtml"><head><link rel="stylesheet" type="text/css" href="style.css" /><script type="text/javascript" src="highlight.js"></script></head><body><pre><span class="hs-pragma">{-# LANGUAGE FlexibleInstances #-}</span><span>
</span><span id="line-2"></span><span>
</span><span id="line-3"></span><span class="annot"><span class="hs-comment">{- | Plutarch benchmarking tools

Interface mirrors the one from @tasty-bench@ but 'bench' instead of taking @Benchmarkable@
takes 'Plutarch.ClosedTerm'

To compare benchmark run against baseline file you need to generate it first with
@cabal run bench -- --csv baseline.csv@. Then after making modifications you can rerun the
benchmarks to compare with previous values with @cabal run bench -- --baseline baseline.csv@.
You can instruct benchmarks to fail if certain values changed by too much using @--fail-if-*@
flags. See @cabal run bench -- --help@ for all available flags. To regenreate baseline file
run with @--csv@ flag again.
-}</span></span><span>
</span><span id="line-15"></span><span class="hs-keyword">module</span><span> </span><span class="hs-identifier">Plutarch.Test.Bench</span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-16"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#BenchConfig"><span class="hs-identifier">BenchConfig</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#Optimizing"><span class="hs-identifier">Optimizing</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#NonOptimizing"><span class="hs-identifier">NonOptimizing</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-17"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#defaultMain"><span class="hs-identifier">Plutarch.Test.Bench.defaultMain</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-18"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#bench"><span class="hs-identifier">bench</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-19"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#benchWithConfig"><span class="hs-identifier">benchWithConfig</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-20"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#bcompare"><span class="hs-identifier">bcompare</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-21"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#bcompareWithin"><span class="hs-identifier">bcompareWithin</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-22"></span><span>
</span><span id="line-23"></span><span>  </span><span class="annot"><span class="hs-comment">-- * CLI options</span></span><span>
</span><span id="line-24"></span><span>
</span><span id="line-25"></span><span>  </span><span class="hs-comment">-- | Benchmarks can be compared against CSV file and fail if they differ too much.</span><span>
</span><span id="line-26"></span><span>  </span><span class="hs-comment">-- Run @cabal run bench -- --help@ to see available flags and descriptions.</span><span>
</span><span id="line-27"></span><span>  </span><span class="hs-comment">-- These options are available by default when running benchmarks in 'Plutarch.Test.Bench.defaultMain'</span><span>
</span><span id="line-28"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#BaselinePath"><span class="hs-identifier">BaselinePath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-29"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#CsvPath"><span class="hs-identifier">CsvPath</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-30"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier">FailIfMoreCpu</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-31"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier">FailIfLessCpu</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-32"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier">FailIfMoreMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-33"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier">FailIfLessMem</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-34"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier">FailIfBigger</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-35"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier">FailIfSmaller</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-36"></span><span>
</span><span id="line-37"></span><span>  </span><span class="annot"><span class="hs-comment">-- * Ingredients</span></span><span>
</span><span id="line-38"></span><span>
</span><span id="line-39"></span><span>  </span><span class="hs-comment">-- | These are used by default in 'Plutarch.Test.Bench.defaultMain'.</span><span>
</span><span id="line-40"></span><span>  </span><span class="hs-comment">-- You do not need to do anything with them unless you build your own benchmark runner</span><span>
</span><span id="line-41"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#consoleBenchReporter"><span class="hs-identifier">consoleBenchReporter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-42"></span><span>  </span><span class="annot"><a href="Plutarch.Test.Bench.html#csvReporter"><span class="hs-identifier">csvReporter</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-43"></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-44"></span><span>
</span><span id="line-45"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html"><span class="hs-identifier">Control.DeepSeq</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#force"><span class="hs-identifier">force</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-46"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.html"><span class="hs-identifier">Control.Exception</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#bracket"><span class="hs-identifier">bracket</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#evaluate"><span class="hs-identifier">evaluate</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-47"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html"><span class="hs-identifier">Control.Monad</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Traversable.html#forM"><span class="hs-identifier">forM</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#guard"><span class="hs-identifier">guard</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#unless"><span class="hs-identifier">unless</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier">when</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#%3E%3D%3E"><span class="hs-operator">(&gt;=&gt;)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-48"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Bifunctor.html"><span class="hs-identifier">Data.Bifunctor</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Bifunctor.html#first"><span class="hs-identifier">first</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Bifunctor.html#second"><span class="hs-identifier">second</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-49"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Short.html"><span class="hs-identifier">Data.ByteString.Short</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Short</span></span><span>
</span><span id="line-50"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html"><span class="hs-identifier">Data.Foldable</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#traverse_"><span class="hs-identifier">traverse_</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-51"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Int.html"><span class="hs-identifier">Data.Int</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier">Int64</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-52"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Strict.html"><span class="hs-identifier">Data.IntMap.Strict</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier">IntMap</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-53"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Strict.html"><span class="hs-identifier">Data.IntMap.Strict</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">IntMap</span></span><span>
</span><span id="line-54"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.List.html"><span class="hs-identifier">Data.List</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#intercalate"><span class="hs-identifier">intercalate</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#isPrefixOf"><span class="hs-identifier">isPrefixOf</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#stripPrefix"><span class="hs-identifier">stripPrefix</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-55"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html"><span class="hs-identifier">Data.Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#isNothing"><span class="hs-identifier">isNothing</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-56"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Monoid.html"><span class="hs-identifier">Data.Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#All"><span class="hs-identifier">All</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#All"><span class="hs-identifier">All</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#Any"><span class="hs-identifier">Any</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#Any"><span class="hs-identifier">Any</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-57"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html"><span class="hs-identifier">Data.Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier">Proxy</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-58"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.SatInt</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">fromSatInt</span></span><span class="hs-special">)</span><span>
</span><span id="line-59"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.html"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier">Seq</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator">(&lt;|)</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-60"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.html"><span class="hs-identifier">Data.Sequence</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Seq</span></span><span>
</span><span id="line-61"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier">Set</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-62"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.html"><span class="hs-identifier">Data.Set</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Set</span></span><span>
</span><span id="line-63"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Data.Tagged</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Tagged</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Tagged</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-64"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.html"><span class="hs-identifier">Data.Text</span></a></span><span> </span><span class="hs-keyword">qualified</span><span> </span><span class="hs-keyword">as</span><span> </span><span class="annot"><span class="hs-identifier">Text</span></span><span>
</span><span id="line-65"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.html"><span class="hs-identifier">GHC.Conc</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#TVar"><span class="hs-identifier">TVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#atomically"><span class="hs-identifier">atomically</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#forkIO"><span class="hs-identifier">forkIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#newTVarIO"><span class="hs-identifier">newTVarIO</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier">readTVar</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#retry"><span class="hs-identifier">retry</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#writeTVar"><span class="hs-identifier">writeTVar</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-66"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Encoding.html"><span class="hs-identifier">GHC.IO.Encoding</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Encoding.html#setLocaleEncoding"><span class="hs-identifier">setLocaleEncoding</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Encoding.html#utf8"><span class="hs-identifier">utf8</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-67"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Evaluate</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">evalScriptUnlimited</span></span><span class="hs-special">)</span><span>
</span><span id="line-68"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Internal.Term</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Config</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">NoTracing</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">compile</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">compileOptimized</span></span><span class="hs-special">)</span><span>
</span><span id="line-69"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Prelude</span></span><span>
</span><span id="line-70"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Plutarch.Script</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Script</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">unScript</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-71"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExBudget</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExBudget</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExBudget</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-72"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusCore.Evaluation.Machine.ExMemory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExCPU</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExCPU</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">ExMemory</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">ExMemory</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-73"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">PlutusLedgerApi.Common</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">serialiseUPLC</span></span><span class="hs-special">)</span><span>
</span><span id="line-74"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.Exit.html"><span class="hs-identifier">System.Exit</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.Exit.html#exitFailure"><span class="hs-identifier">exitFailure</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.Exit.html#exitSuccess"><span class="hs-identifier">exitSuccess</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-75"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html"><span class="hs-identifier">System.IO</span></a></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-76"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Types.html#BufferMode"><span class="hs-identifier">BufferMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Types.html#LineBuffering"><span class="hs-identifier">LineBuffering</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-77"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier">Handle</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-78"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.IOMode.html#IOMode"><span class="hs-identifier">IOMode</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.IOMode.html#WriteMode"><span class="hs-identifier">WriteMode</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-79"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.html#hClose"><span class="hs-identifier">hClose</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-80"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Text.html#hPutStrLn"><span class="hs-identifier">hPutStrLn</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-81"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.html#hSetBuffering"><span class="hs-identifier">hSetBuffering</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-82"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#openFile"><span class="hs-identifier">openFile</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-83"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#stderr"><span class="hs-identifier">stderr</span></a></span><span class="hs-special">,</span><span>
</span><span id="line-84"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-85"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty</span></span><span>
</span><span id="line-86"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.Ingredients</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ingredient</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TestReporter</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">composeReporters</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">tryIngredients</span></span><span class="hs-special">)</span><span>
</span><span id="line-87"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.Ingredients.ConsoleReporter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MinDurationToReport</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">MinDurationToReport</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-88"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.Options</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-89"></span><span>  </span><span class="annot"><span class="hs-identifier">IsOption</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">defaultValue</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">optionHelp</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">optionName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">parseValue</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-90"></span><span>  </span><span class="annot"><span class="hs-identifier">OptionDescription</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Option</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-91"></span><span>  </span><span class="annot"><span class="hs-identifier">OptionSet</span></span><span class="hs-special">,</span><span>
</span><span id="line-92"></span><span>  </span><span class="annot"><span class="hs-identifier">lookupOption</span></span><span class="hs-special">,</span><span>
</span><span id="line-93"></span><span>  </span><span class="annot"><span class="hs-identifier">safeRead</span></span><span class="hs-special">,</span><span>
</span><span id="line-94"></span><span>  </span><span class="annot"><span class="hs-identifier">setOption</span></span><span class="hs-special">,</span><span>
</span><span id="line-95"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-96"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.Patterns.Eval</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">asB</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">eval</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">withFields</span></span><span class="hs-special">)</span><span>
</span><span id="line-97"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.Patterns.Types</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Expr</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">And</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">StringLit</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-98"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.Providers</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">IsTest</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">run</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testOptions</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">singleTest</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testFailed</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">testPassed</span></span><span class="hs-special">)</span><span>
</span><span id="line-99"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><span class="hs-identifier">Test.Tasty.Runners</span></span><span> </span><span class="hs-special">(</span><span>
</span><span id="line-100"></span><span>  </span><span class="annot"><span class="hs-identifier">Ap</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Ap</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">getApp</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-101"></span><span>  </span><span class="annot"><span class="hs-identifier">FailureReason</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">TestFailed</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-102"></span><span>  </span><span class="annot"><span class="hs-identifier">Outcome</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Failure</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-103"></span><span>  </span><span class="annot"><span class="hs-identifier">Result</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">resultDescription</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">resultOutcome</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">resultShortDescription</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-104"></span><span>  </span><span class="annot"><span class="hs-identifier">Status</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">Done</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">Executing</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">NotStarted</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-105"></span><span>  </span><span class="annot"><span class="hs-identifier">StatusMap</span></span><span class="hs-special">,</span><span>
</span><span id="line-106"></span><span>  </span><span class="annot"><span class="hs-identifier">TreeFold</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier">foldAfter</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldGroup</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">foldSingle</span></span><span class="hs-special">)</span><span class="hs-special">,</span><span>
</span><span id="line-107"></span><span>  </span><span class="annot"><span class="hs-identifier">consoleTestReporter</span></span><span class="hs-special">,</span><span>
</span><span id="line-108"></span><span>  </span><span class="annot"><span class="hs-identifier">foldTestTree</span></span><span class="hs-special">,</span><span>
</span><span id="line-109"></span><span>  </span><span class="annot"><span class="hs-identifier">formatMessage</span></span><span class="hs-special">,</span><span>
</span><span id="line-110"></span><span>  </span><span class="annot"><span class="hs-identifier">installSignalHandlers</span></span><span class="hs-special">,</span><span>
</span><span id="line-111"></span><span>  </span><span class="annot"><span class="hs-identifier">listingTests</span></span><span class="hs-special">,</span><span>
</span><span id="line-112"></span><span>  </span><span class="annot"><span class="hs-identifier">parseExpr</span></span><span class="hs-special">,</span><span>
</span><span id="line-113"></span><span>  </span><span class="annot"><span class="hs-identifier">parseOptions</span></span><span class="hs-special">,</span><span>
</span><span id="line-114"></span><span>  </span><span class="annot"><span class="hs-identifier">resultSuccessful</span></span><span class="hs-special">,</span><span>
</span><span id="line-115"></span><span>  </span><span class="annot"><span class="hs-identifier">testsNames</span></span><span class="hs-special">,</span><span>
</span><span id="line-116"></span><span>  </span><span class="annot"><span class="hs-identifier">trivialFold</span></span><span class="hs-special">,</span><span>
</span><span id="line-117"></span><span> </span><span class="hs-special">)</span><span>
</span><span id="line-118"></span><span class="hs-keyword">import</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Printf.html"><span class="hs-identifier">Text.Printf</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Printf.html#printf"><span class="hs-identifier">printf</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-119"></span><span>
</span><span id="line-120"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-121"></span><span class="hs-keyword">data</span><span> </span><span id="BenchConfig"><span class="annot"><a href="Plutarch.Test.Bench.html#BenchConfig"><span class="hs-identifier hs-var">BenchConfig</span></a></span></span><span>
</span><span id="line-122"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-comment">-- | Compile with UPLC simplifier pass and no tracing</span></span><span>
</span><span id="line-123"></span><span>    </span><span id="Optimizing"><span class="annot"><a href="Plutarch.Test.Bench.html#Optimizing"><span class="hs-identifier hs-var">Optimizing</span></a></span></span><span>
</span><span id="line-124"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="hs-comment">-- | Compile without UPLC simplifier and configurable tracing</span></span><span>
</span><span id="line-125"></span><span>    </span><span id="NonOptimizing"><span class="annot"><a href="Plutarch.Test.Bench.html#NonOptimizing"><span class="hs-identifier hs-var">NonOptimizing</span></a></span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Config</span></span><span>
</span><span id="line-126"></span><span>
</span><span id="line-127"></span><span class="annot"><span class="hs-comment">{- | Create benchmark from Plutarch term without tracing and no UPLC simplifier

@since 1.0.0
-}</span></span><span>
</span><span id="line-131"></span><span id="local-6989586621679232557"><span class="annot"><a href="Plutarch.Test.Bench.html#bench"><span class="hs-identifier hs-type">bench</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679232557"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span></span><span>
</span><span id="line-132"></span><span id="bench"><span class="annot"><span class="annottext">bench :: forall (a :: PType). TestName -&gt; ClosedTerm a -&gt; TestTree
</span><a href="Plutarch.Test.Bench.html#bench"><span class="hs-identifier hs-var hs-var">bench</span></a></span></span><span> </span><span id="local-6989586621679233319"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233319"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; BenchConfig -&gt; (forall {s :: S}. Term s a) -&gt; TestTree
forall (a :: PType).
TestName -&gt; BenchConfig -&gt; ClosedTerm a -&gt; TestTree
</span><a href="Plutarch.Test.Bench.html#benchWithConfig"><span class="hs-identifier hs-var">benchWithConfig</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233319"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Config -&gt; BenchConfig
</span><a href="Plutarch.Test.Bench.html#NonOptimizing"><span class="hs-identifier hs-var">NonOptimizing</span></a></span><span> </span><span class="annot"><span class="annottext">Config
</span><span class="hs-identifier hs-var">NoTracing</span></span><span class="hs-special">)</span><span>
</span><span id="line-133"></span><span>
</span><span id="line-134"></span><span class="annot"><span class="hs-comment">{- | Like 'bench' but with customizable compilation config

@since 1.0.0
-}</span></span><span>
</span><span id="line-138"></span><span id="local-6989586621679232565"><span class="annot"><a href="Plutarch.Test.Bench.html#benchWithConfig"><span class="hs-identifier hs-type">benchWithConfig</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#BenchConfig"><span class="hs-identifier hs-type">BenchConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679232565"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span></span><span>
</span><span id="line-139"></span><span id="benchWithConfig"><span class="annot"><span class="annottext">benchWithConfig :: forall (a :: PType).
TestName -&gt; BenchConfig -&gt; ClosedTerm a -&gt; TestTree
</span><a href="Plutarch.Test.Bench.html#benchWithConfig"><span class="hs-identifier hs-var hs-var">benchWithConfig</span></a></span></span><span> </span><span id="local-6989586621679233322"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233322"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679233323"><span class="annot"><span class="annottext">BenchConfig
</span><a href="#local-6989586621679233323"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679233324"><span class="annot"><span class="annottext">ClosedTerm a
</span><a href="#local-6989586621679233324"><span class="hs-identifier hs-var">term</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; PBenchmarkable -&gt; TestTree
forall t. IsTest t =&gt; TestName -&gt; t -&gt; TestTree
</span><span class="hs-identifier hs-var">singleTest</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233322"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">(PBenchmarkable -&gt; TestTree) -&gt; PBenchmarkable -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">BenchConfig -&gt; ClosedTerm a -&gt; PBenchmarkable
forall (a :: PType). BenchConfig -&gt; ClosedTerm a -&gt; PBenchmarkable
</span><a href="Plutarch.Test.Bench.html#PBenchmarkable"><span class="hs-identifier hs-var">PBenchmarkable</span></a></span><span> </span><span class="annot"><span class="annottext">BenchConfig
</span><a href="#local-6989586621679233323"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
ClosedTerm a
</span><a href="#local-6989586621679233324"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-140"></span><span>
</span><span id="line-141"></span><span class="annot"><span class="hs-comment">{- | Compare benchmarks, reporting relative CPU, MEM, and size differences

 @since 1.0.0
-}</span></span><span>
</span><span id="line-145"></span><span class="annot"><a href="Plutarch.Test.Bench.html#bcompare"><span class="hs-identifier hs-type">bcompare</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-146"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Tasty pattern to compare as baseline</span></span><span>
</span><span id="line-147"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-148"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Test or test tree to compare with baseline test</span></span><span>
</span><span id="line-149"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-150"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span>
</span><span id="line-151"></span><span id="bcompare"><span class="annot"><span class="annottext">bcompare :: TestName -&gt; TestTree -&gt; TestTree
</span><a href="Plutarch.Test.Bench.html#bcompare"><span class="hs-identifier hs-var hs-var">bcompare</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; TestName
-&gt; TestTree
-&gt; TestTree
</span><a href="Plutarch.Test.Bench.html#bcompareWithin"><span class="hs-identifier hs-var">bcompareWithin</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">-1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">-1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">-1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-152"></span><span>
</span><span id="line-153"></span><span class="annot"><span class="hs-comment">{- | Like 'bcompare' but with customizable upper and lower bounds of relative differences

@since 1.0.0
-}</span></span><span>
</span><span id="line-157"></span><span class="annot"><a href="Plutarch.Test.Bench.html#bcompareWithin"><span class="hs-identifier hs-type">bcompareWithin</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-158"></span><span>  </span><span class="annot"><span class="hs-comment">-- | CPU bounds</span></span><span>
</span><span id="line-159"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-160"></span><span>  </span><span class="annot"><span class="hs-comment">-- | MEM bounds</span></span><span>
</span><span id="line-161"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-162"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Size bounds</span></span><span>
</span><span id="line-163"></span><span>  </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-164"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Tasty pattern to compare as baseline</span></span><span>
</span><span id="line-165"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-166"></span><span>  </span><span class="annot"><span class="hs-comment">-- | Test or test tree to compare with baseline test</span></span><span>
</span><span id="line-167"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-168"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span>
</span><span id="line-169"></span><span id="bcompareWithin"><span class="annot"><span class="annottext">bcompareWithin :: (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; TestName
-&gt; TestTree
-&gt; TestTree
</span><a href="Plutarch.Test.Bench.html#bcompareWithin"><span class="hs-identifier hs-var hs-var">bcompareWithin</span></a></span></span><span> </span><span id="local-6989586621679233327"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679233327"><span class="hs-identifier hs-var">cpu</span></a></span></span><span> </span><span id="local-6989586621679233328"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679233328"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621679233329"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679233329"><span class="hs-identifier hs-var">size</span></a></span></span><span> </span><span id="local-6989586621679233330"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233330"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Expr
</span><span class="hs-identifier hs-var">parseExpr</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233330"><span class="hs-identifier hs-var">s</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-170"></span><span>  </span><span class="annot"><span class="annottext">Maybe Expr
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestTree -&gt; TestTree
forall a. HasCallStack =&gt; TestName -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; TestTree -&gt; TestTree)
-&gt; TestName -&gt; TestTree -&gt; TestTree
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Could not parse pbcompare pattern &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233330"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-171"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679233332"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679233332"><span class="hs-identifier hs-var">e</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">DependencyType -&gt; Expr -&gt; TestTree -&gt; TestTree
</span><span class="hs-identifier hs-var">after_</span></span><span> </span><span class="annot"><span class="annottext">DependencyType
</span><span class="hs-identifier hs-var">AllSucceed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Expr -&gt; Expr -&gt; Expr
</span><span class="hs-identifier hs-var">And</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; Expr
</span><span class="hs-identifier hs-var">StringLit</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="Plutarch.Test.Bench.html#pbcomparePrefix"><span class="hs-identifier hs-var">pbcomparePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">WithLoHi () -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">()
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi ()
forall a.
a
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi a
</span><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-var">WithLoHi</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679233327"><span class="hs-identifier hs-var">cpu</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679233328"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679233329"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679233332"><span class="hs-identifier hs-var">e</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-172"></span><span>
</span><span id="line-173"></span><span class="annot"><span class="hs-comment">{- | Use this instead of 'Test.Tasty.defaultMain' from @Test.Tasty@ to run benchmarks to get formatted output

@since 1.0.0
-}</span></span><span>
</span><span id="line-177"></span><span class="annot"><a href="Plutarch.Test.Bench.html#defaultMain"><span class="hs-identifier hs-type">defaultMain</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-178"></span><span id="defaultMain"><span class="annot"><span class="annottext">defaultMain :: TestTree -&gt; IO ()
</span><a href="Plutarch.Test.Bench.html#defaultMain"><span class="hs-identifier hs-var hs-var">defaultMain</span></a></span></span><span> </span><span id="local-6989586621679233339"><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679233339"><span class="hs-identifier hs-var">bs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-179"></span><span>  </span><span class="annot"><span class="annottext">TextEncoding -&gt; IO ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Encoding.html#setLocaleEncoding"><span class="hs-identifier hs-var">setLocaleEncoding</span></a></span><span> </span><span class="annot"><span class="annottext">TextEncoding
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Encoding.html#utf8"><span class="hs-identifier hs-var">utf8</span></a></span><span>
</span><span id="line-180"></span><span>  </span><span class="annot"><span class="annottext">IO ()
</span><span class="hs-identifier hs-var">installSignalHandlers</span></span><span>
</span><span id="line-181"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233344"><span class="annot"><span class="annottext">pbenchIngredients :: l
</span><a href="#local-6989586621679233344"><span class="hs-identifier hs-var hs-var">pbenchIngredients</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Item l
Ingredient
</span><span class="hs-identifier hs-var">listingTests</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Ingredient -&gt; Ingredient -&gt; Ingredient
</span><span class="hs-identifier hs-var">composeReporters</span></span><span> </span><span class="annot"><span class="annottext">Ingredient
</span><a href="Plutarch.Test.Bench.html#consoleBenchReporter"><span class="hs-identifier hs-var">consoleBenchReporter</span></a></span><span> </span><span class="annot"><span class="annottext">Ingredient
</span><a href="Plutarch.Test.Bench.html#csvReporter"><span class="hs-identifier hs-var">csvReporter</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-182"></span><span>  </span><span id="local-6989586621679233345"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233345"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">[Ingredient] -&gt; TestTree -&gt; IO OptionSet
</span><span class="hs-identifier hs-var">parseOptions</span></span><span> </span><span class="annot"><span class="annottext">[Ingredient]
forall {l}.
((Item l :: Type) ~ (Ingredient :: Type), IsList l) =&gt;
l
</span><a href="#local-6989586621679233344"><span class="hs-identifier hs-var">pbenchIngredients</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679233339"><span class="hs-identifier hs-var">bs</span></a></span><span>
</span><span id="line-183"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233346"><span class="annot"><span class="annottext">opts' :: OptionSet
</span><a href="#local-6989586621679233346"><span class="hs-identifier hs-var hs-var">opts'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">MinDurationToReport -&gt; OptionSet -&gt; OptionSet
forall v. IsOption v =&gt; v -&gt; OptionSet -&gt; OptionSet
</span><span class="hs-identifier hs-var">setOption</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; MinDurationToReport
</span><span class="hs-identifier hs-var">MinDurationToReport</span></span><span> </span><span class="annot"><span class="annottext">Integer
</span><span class="hs-number">1000000000000</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233345"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-184"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[Ingredient] -&gt; OptionSet -&gt; TestTree -&gt; Maybe (IO Bool)
</span><span class="hs-identifier hs-var">tryIngredients</span></span><span> </span><span class="annot"><span class="annottext">[Ingredient]
forall {l}.
((Item l :: Type) ~ (Ingredient :: Type), IsList l) =&gt;
l
</span><a href="#local-6989586621679233344"><span class="hs-identifier hs-var">pbenchIngredients</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233346"><span class="hs-identifier hs-var">opts'</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679233339"><span class="hs-identifier hs-var">bs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-185"></span><span>    </span><span class="annot"><span class="annottext">Maybe (IO Bool)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.Exit.html#exitFailure"><span class="hs-identifier hs-var">exitFailure</span></a></span><span>
</span><span id="line-186"></span><span>    </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679233347"><span class="annot"><span class="annottext">IO Bool
</span><a href="#local-6989586621679233347"><span class="hs-identifier hs-var">act</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="#local-6989586621679233347"><span class="hs-identifier hs-var">act</span></a></span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; (Bool -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679233348"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679233348"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679233348"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.Exit.html#exitSuccess"><span class="hs-identifier hs-var">exitSuccess</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.Exit.html#exitFailure"><span class="hs-identifier hs-var">exitFailure</span></a></span><span>
</span><span id="line-187"></span><span>
</span><span id="line-188"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-189"></span><span class="annot"><a href="Plutarch.Test.Bench.html#consoleBenchReporter"><span class="hs-identifier hs-type">consoleBenchReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ingredient</span></span><span>
</span><span id="line-190"></span><span id="consoleBenchReporter"><span class="annot"><span class="annottext">consoleBenchReporter :: Ingredient
</span><a href="Plutarch.Test.Bench.html#consoleBenchReporter"><span class="hs-identifier hs-var hs-var">consoleBenchReporter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
-&gt; (OptionSet
    -&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result))
-&gt; Ingredient
</span><a href="Plutarch.Test.Bench.html#modifyConsoleReporter"><span class="hs-identifier hs-var">modifyConsoleReporter</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Proxy @Type (Maybe BaselinePath) -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type (Maybe BaselinePath)
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#BaselinePath"><span class="hs-identifier hs-type">BaselinePath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((OptionSet
  -&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result))
 -&gt; Ingredient)
-&gt; (OptionSet
    -&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result))
-&gt; Ingredient
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679233350"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233350"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-191"></span><span>  </span><span id="local-6989586621679233351"><span class="annot"><span class="annottext">Set TestName
</span><a href="#local-6989586621679233351"><span class="hs-identifier hs-var">baseline</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; Maybe BaselinePath
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233350"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-192"></span><span>    </span><span class="annot"><span class="annottext">Maybe BaselinePath
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Set TestName -&gt; IO (Set TestName)
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Set TestName
forall a. Set a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-193"></span><span>    </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#BaselinePath"><span class="hs-identifier hs-type">BaselinePath</span></a></span><span> </span><span id="local-6989586621679233354"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233354"><span class="hs-identifier hs-var">path</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-194"></span><span>      </span><span class="annot"><span class="annottext">[TestName] -&gt; Set TestName
forall a. Ord a =&gt; [a] -&gt; Set a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#fromList"><span class="hs-identifier hs-var">Set.fromList</span></a></span><span>
</span><span id="line-195"></span><span>        </span><span class="annot"><span class="annottext">([TestName] -&gt; Set TestName)
-&gt; (TestName -&gt; [TestName]) -&gt; TestName -&gt; Set TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; [TestName]
</span><a href="Plutarch.Test.Bench.html#joinQuotedFields"><span class="hs-identifier hs-var">joinQuotedFields</span></a></span><span>
</span><span id="line-196"></span><span>        </span><span class="annot"><span class="annottext">([TestName] -&gt; [TestName])
-&gt; (TestName -&gt; [TestName]) -&gt; TestName -&gt; [TestName]
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; [TestName]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#lines"><span class="hs-identifier hs-var">lines</span></a></span><span>
</span><span id="line-197"></span><span>        </span><span class="annot"><span class="annottext">(TestName -&gt; Set TestName) -&gt; IO TestName -&gt; IO (Set TestName)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; IO TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.IO.html#readFile"><span class="hs-identifier hs-var">readFile</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233354"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">IO TestName -&gt; (TestName -&gt; IO TestName) -&gt; IO TestName
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO TestName
forall a. a -&gt; IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#evaluate"><span class="hs-identifier hs-var">evaluate</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO TestName)
-&gt; (TestName -&gt; TestName) -&gt; TestName -&gt; IO TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
forall a. NFData a =&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/deepseq-1.4.8.1/src/Control.DeepSeq.html#force"><span class="hs-identifier hs-var">force</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-198"></span><span>  </span><span class="annot"><span class="annottext">(TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
-&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
 -&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result))
-&gt; (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
-&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679233361"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233361"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span id="local-6989586621679233362"><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="#local-6989586621679233362"><span class="hs-identifier hs-var">uDepR</span></a></span></span><span> </span><span id="local-6989586621679233363"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679233363"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-199"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="#local-6989586621679233362"><span class="hs-identifier hs-var">uDepR</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-200"></span><span>      </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Result
</span><span class="hs-identifier hs-var">testFailed</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to find pattern from `bcompare`&quot;</span></span><span>
</span><span id="line-201"></span><span>      </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="Plutarch.Test.Bench.html#NotUnique"><span class="hs-identifier hs-var">NotUnique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Result
</span><span class="hs-identifier hs-var">testFailed</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Pattern from `bcompare` is not unique&quot;</span></span><span>
</span><span id="line-202"></span><span>      </span><span id="local-6989586621679233366"><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="#local-6989586621679233366"><span class="hs-identifier hs-var">mDepR</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-203"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe (WithLoHi ExecutionBudget)
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TestName
</span><span class="hs-identifier hs-var">resultDescription</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679233363"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-204"></span><span>          </span><span class="annot"><span class="annottext">Maybe (WithLoHi ExecutionBudget)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679233363"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-205"></span><span>          </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span>
</span><span id="line-206"></span><span>            </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span>
</span><span id="line-207"></span><span>                </span><span id="local-6989586621679233367"><span class="annot"><span class="annottext">est :: ExecutionBudget
</span><a href="#local-6989586621679233367"><span class="hs-identifier hs-var">est</span></a></span></span><span class="hs-glyph">@</span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-type">ExecutionBudget</span></a></span><span> </span><span id="local-6989586621679233369"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233369"><span class="hs-identifier hs-var">budgetCpu'</span></a></span></span><span> </span><span id="local-6989586621679233370"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233370"><span class="hs-identifier hs-var">budgetMem'</span></a></span></span><span> </span><span id="local-6989586621679233371"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233371"><span class="hs-identifier hs-var">budgetSize'</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-208"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679233372"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233372"><span class="hs-identifier hs-var">lowerBoundCpu</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233373"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233373"><span class="hs-identifier hs-var">upperBoundCpu</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-209"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679233374"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233374"><span class="hs-identifier hs-var">lowerBoundMem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233375"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233375"><span class="hs-identifier hs-var">upperBoundMem</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-210"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679233376"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233376"><span class="hs-identifier hs-var">lowerBoundSize</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233377"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233377"><span class="hs-identifier hs-var">upperBoundSize</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-211"></span><span>              </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-212"></span><span>              </span><span class="hs-special">(</span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679233378"><span class="hs-identifier hs-var">isAcceptable</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
forall a. a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#id"><span class="hs-identifier hs-var">id</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Result -&gt; Result
</span><a href="Plutarch.Test.Bench.html#forceFail"><span class="hs-identifier hs-var">forceFail</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-213"></span><span>                </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679233363"><span class="hs-identifier hs-var">r</span></a></span><span>
</span><span id="line-214"></span><span>                  </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">resultDescription</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-215"></span><span>                      </span><span class="annot"><a href="Plutarch.Test.Bench.html#toTableAligned"><span class="hs-identifier hs-type">toTableAligned</span></a></span><span>
</span><span id="line-216"></span><span>                        </span><span class="hs-special">[</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;CPU&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">show</span></span><span> </span><span class="annot"><span class="hs-identifier">budgetCpu'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bcompareCpu</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showSlowdown</span></span><span> </span><span class="annot"><span class="hs-identifier">slowDownCpu</span></span><span class="hs-special">]</span><span>
</span><span id="line-217"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;MEM&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">show</span></span><span> </span><span class="annot"><span class="hs-identifier">budgetMem'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bcompareMem</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showSlowdown</span></span><span> </span><span class="annot"><span class="hs-identifier">slowDownMem</span></span><span class="hs-special">]</span><span>
</span><span id="line-218"></span><span>                        </span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="hs-string">&quot;SIZE&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">show</span></span><span> </span><span class="annot"><span class="hs-identifier">budgetSize'</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">bcompareSize</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier">showSlowdown</span></span><span> </span><span class="annot"><span class="hs-identifier">slowDownSize</span></span><span class="hs-special">]</span><span>
</span><span id="line-219"></span><span>                        </span><span class="hs-special">]</span><span>
</span><span id="line-220"></span><span>                  </span><span class="hs-special">}</span><span>
</span><span id="line-221"></span><span>              </span><span class="hs-keyword">where</span><span>
</span><span id="line-222"></span><span>                </span><span id="local-6989586621679233383"><span class="annot"><span class="annottext">showSlowdown :: Double -&gt; TestName
</span><a href="#local-6989586621679233383"><span class="hs-identifier hs-var hs-var">showSlowdown</span></a></span></span><span> </span><span id="local-6989586621679233389"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233389"><span class="hs-identifier hs-var">s</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Maybe (Double, Double, Double) -&gt; Bool
forall a. Maybe a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#isNothing"><span class="hs-identifier hs-var">isNothing</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Double, Double, Double)
</span><a href="#local-6989586621679233390"><span class="hs-identifier hs-var">mSlowDown</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Double -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#formatSlowDown"><span class="hs-identifier hs-var">formatSlowDown</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233389"><span class="hs-identifier hs-var">s</span></a></span><span>
</span><span id="line-223"></span><span>                </span><span id="local-6989586621679233378"><span class="annot"><span class="annottext">isAcceptable :: Bool
</span><a href="#local-6989586621679233378"><span class="hs-identifier hs-var hs-var">isAcceptable</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679233392"><span class="hs-identifier hs-var">isAcceptableVsBaseline</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679233394"><span class="hs-identifier hs-var">isAcceptableVsBcompare</span></a></span><span>
</span><span id="line-224"></span><span>                </span><span id="local-6989586621679233390"><span class="annot"><span class="annottext">mSlowDown :: Maybe (Double, Double, Double)
</span><a href="#local-6989586621679233390"><span class="hs-identifier hs-var hs-var">mSlowDown</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set TestName
-&gt; TestName -&gt; ExecutionBudget -&gt; Maybe (Double, Double, Double)
</span><a href="Plutarch.Test.Bench.html#compareVsBaseline"><span class="hs-identifier hs-var">compareVsBaseline</span></a></span><span> </span><span class="annot"><span class="annottext">Set TestName
</span><a href="#local-6989586621679233351"><span class="hs-identifier hs-var">baseline</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233361"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionBudget
</span><a href="#local-6989586621679233367"><span class="hs-identifier hs-var">est</span></a></span><span>
</span><span id="line-225"></span><span>                </span><span id="local-6989586621679233384"><span class="annot"><span class="annottext">slowDownCpu :: Double
</span><a href="#local-6989586621679233384"><span class="hs-identifier hs-var hs-var">slowDownCpu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
-&gt; ((Double, Double, Double) -&gt; Double)
-&gt; Maybe (Double, Double, Double)
-&gt; Double
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679233397"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233397"><span class="hs-identifier hs-var">cpu</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233397"><span class="hs-identifier hs-var">cpu</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Double, Double, Double)
</span><a href="#local-6989586621679233390"><span class="hs-identifier hs-var">mSlowDown</span></a></span><span>
</span><span id="line-226"></span><span>                </span><span id="local-6989586621679233386"><span class="annot"><span class="annottext">slowDownMem :: Double
</span><a href="#local-6989586621679233386"><span class="hs-identifier hs-var hs-var">slowDownMem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
-&gt; ((Double, Double, Double) -&gt; Double)
-&gt; Maybe (Double, Double, Double)
-&gt; Double
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233398"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233398"><span class="hs-identifier hs-var">mem</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233398"><span class="hs-identifier hs-var">mem</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Double, Double, Double)
</span><a href="#local-6989586621679233390"><span class="hs-identifier hs-var">mSlowDown</span></a></span><span>
</span><span id="line-227"></span><span>                </span><span id="local-6989586621679233388"><span class="annot"><span class="annottext">slowDownSize :: Double
</span><a href="#local-6989586621679233388"><span class="hs-identifier hs-var hs-var">slowDownSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double
-&gt; ((Double, Double, Double) -&gt; Double)
-&gt; Maybe (Double, Double, Double)
-&gt; Double
forall b a. b -&gt; (a -&gt; b) -&gt; Maybe a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Maybe.html#maybe"><span class="hs-identifier hs-var">maybe</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233399"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233399"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233399"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Maybe (Double, Double, Double)
</span><a href="#local-6989586621679233390"><span class="hs-identifier hs-var">mSlowDown</span></a></span><span>
</span><span id="line-228"></span><span>                </span><span id="local-6989586621679233392"><span class="annot"><span class="annottext">isAcceptableVsBaseline :: Bool
</span><a href="#local-6989586621679233392"><span class="hs-identifier hs-var hs-var">isAcceptableVsBaseline</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-229"></span><span>                  </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233384"><span class="hs-identifier hs-var">slowDownCpu</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233372"><span class="hs-identifier hs-var">lowerBoundCpu</span></a></span><span>
</span><span id="line-230"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233384"><span class="hs-identifier hs-var">slowDownCpu</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233373"><span class="hs-identifier hs-var">upperBoundCpu</span></a></span><span>
</span><span id="line-231"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233386"><span class="hs-identifier hs-var">slowDownMem</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233374"><span class="hs-identifier hs-var">lowerBoundMem</span></a></span><span>
</span><span id="line-232"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233386"><span class="hs-identifier hs-var">slowDownMem</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233375"><span class="hs-identifier hs-var">upperBoundMem</span></a></span><span>
</span><span id="line-233"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233388"><span class="hs-identifier hs-var">slowDownSize</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233376"><span class="hs-identifier hs-var">lowerBoundSize</span></a></span><span>
</span><span id="line-234"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233388"><span class="hs-identifier hs-var">slowDownSize</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233377"><span class="hs-identifier hs-var">upperBoundSize</span></a></span><span>
</span><span id="line-235"></span><span>                </span><span class="hs-special">(</span><span id="local-6989586621679233394"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679233394"><span class="hs-identifier hs-var">isAcceptableVsBcompare</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233382"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233382"><span class="hs-identifier hs-var">bcompareCpu</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233385"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233385"><span class="hs-identifier hs-var">bcompareMem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233387"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233387"><span class="hs-identifier hs-var">bcompareSize</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="#local-6989586621679233366"><span class="hs-identifier hs-var">mDepR</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-236"></span><span>                  </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;&quot;</span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-237"></span><span>                  </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span>
</span><span id="line-238"></span><span>                    </span><span class="hs-special">(</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span>
</span><span id="line-239"></span><span>                        </span><span id="local-6989586621679233403"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679233403"><span class="hs-identifier hs-var">depR</span></a></span></span><span>
</span><span id="line-240"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679233404"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233404"><span class="hs-identifier hs-var">depLowerBoundCpu</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233405"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233405"><span class="hs-identifier hs-var">depUpperBoundCpu</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-241"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679233406"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233406"><span class="hs-identifier hs-var">depLowerBoundMem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233407"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233407"><span class="hs-identifier hs-var">depUpperBoundMem</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-242"></span><span>                        </span><span class="hs-special">(</span><span id="local-6989586621679233408"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233408"><span class="hs-identifier hs-var">depLowerBoundSize</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679233409"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233409"><span class="hs-identifier hs-var">depUpperBoundSize</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-243"></span><span>                      </span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe (WithLoHi ExecutionBudget)
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TestName
</span><span class="hs-identifier hs-var">resultDescription</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679233403"><span class="hs-identifier hs-var">depR</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-244"></span><span>                      </span><span class="annot"><span class="annottext">Maybe (WithLoHi ExecutionBudget)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-245"></span><span>                      </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-type">ExecutionBudget</span></a></span><span> </span><span id="local-6989586621679233410"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233410"><span class="hs-identifier hs-var">depCpu</span></a></span></span><span> </span><span id="local-6989586621679233411"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233411"><span class="hs-identifier hs-var">depMem</span></a></span></span><span> </span><span id="local-6989586621679233412"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233412"><span class="hs-identifier hs-var">depSize</span></a></span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-246"></span><span>                        </span><span class="hs-keyword">let</span><span>
</span><span id="line-247"></span><span>                          </span><span id="local-6989586621679233413"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233413"><span class="hs-identifier hs-var">ratioCpu</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233369"><span class="hs-identifier hs-var">budgetCpu'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233410"><span class="hs-identifier hs-var">depCpu</span></a></span><span>
</span><span id="line-248"></span><span>                          </span><span id="local-6989586621679233414"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233414"><span class="hs-identifier hs-var">ratioMem</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233370"><span class="hs-identifier hs-var">budgetMem'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233411"><span class="hs-identifier hs-var">depMem</span></a></span><span>
</span><span id="line-249"></span><span>                          </span><span id="local-6989586621679233415"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233415"><span class="hs-identifier hs-var">ratioSize</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233371"><span class="hs-identifier hs-var">budgetSize'</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679233412"><span class="hs-identifier hs-var">depSize</span></a></span><span>
</span><span id="line-250"></span><span>                         </span><span class="hs-keyword">in</span><span>
</span><span id="line-251"></span><span>                          </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233413"><span class="hs-identifier hs-var">ratioCpu</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233404"><span class="hs-identifier hs-var">depLowerBoundCpu</span></a></span><span>
</span><span id="line-252"></span><span>                              </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233413"><span class="hs-identifier hs-var">ratioCpu</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233405"><span class="hs-identifier hs-var">depUpperBoundCpu</span></a></span><span>
</span><span id="line-253"></span><span>                              </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233414"><span class="hs-identifier hs-var">ratioMem</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233406"><span class="hs-identifier hs-var">depLowerBoundMem</span></a></span><span>
</span><span id="line-254"></span><span>                              </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233414"><span class="hs-identifier hs-var">ratioMem</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233407"><span class="hs-identifier hs-var">depUpperBoundMem</span></a></span><span>
</span><span id="line-255"></span><span>                              </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233415"><span class="hs-identifier hs-var">ratioSize</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E%3D"><span class="hs-operator hs-var">&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233408"><span class="hs-identifier hs-var">depLowerBoundSize</span></a></span><span>
</span><span id="line-256"></span><span>                              </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%26%26"><span class="hs-operator hs-var">&amp;&amp;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233415"><span class="hs-identifier hs-var">ratioSize</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3C%3D"><span class="hs-operator hs-var">&lt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233409"><span class="hs-identifier hs-var">depUpperBoundSize</span></a></span><span>
</span><span id="line-257"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Double -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%.2fx&quot;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233413"><span class="hs-identifier hs-var">ratioCpu</span></a></span><span>
</span><span id="line-258"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Double -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%.2fx&quot;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233414"><span class="hs-identifier hs-var">ratioMem</span></a></span><span>
</span><span id="line-259"></span><span>                          </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Double -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%.2fx&quot;</span></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679233415"><span class="hs-identifier hs-var">ratioSize</span></a></span><span>
</span><span id="line-260"></span><span>                          </span><span class="hs-special">)</span><span>
</span><span id="line-261"></span><span>
</span><span id="line-262"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-263"></span><span class="annot"><a href="Plutarch.Test.Bench.html#csvReporter"><span class="hs-identifier hs-type">csvReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Ingredient</span></span><span>
</span><span id="line-264"></span><span id="csvReporter"><span class="annot"><span class="annottext">csvReporter :: Ingredient
</span><a href="Plutarch.Test.Bench.html#csvReporter"><span class="hs-identifier hs-var hs-var">csvReporter</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
-&gt; Ingredient
</span><span class="hs-identifier hs-var">TestReporter</span></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Proxy @Type (Maybe CsvPath) -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type (Maybe CsvPath)
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#CsvPath"><span class="hs-identifier hs-type">CsvPath</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">((OptionSet
  -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
 -&gt; Ingredient)
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
-&gt; Ingredient
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-265"></span><span>  </span><span class="hs-glyph">\</span><span id="local-6989586621679233416"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233416"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679233417"><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679233417"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-266"></span><span>    </span><span class="annot"><a href="Plutarch.Test.Bench.html#CsvPath"><span class="hs-identifier hs-type">CsvPath</span></a></span><span> </span><span id="local-6989586621679233419"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233419"><span class="hs-identifier hs-var">path</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; Maybe CsvPath
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233416"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-267"></span><span>    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233420"><span class="annot"><span class="annottext">names :: [TestName]
</span><a href="#local-6989586621679233420"><span class="hs-identifier hs-var hs-var">names</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; TestTree -&gt; [TestName]
</span><span class="hs-identifier hs-var">testsNames</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679233416"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679233417"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-268"></span><span>        </span><span id="local-6989586621679233421"><span class="annot"><span class="annottext">namesMap :: IntMap TestName
</span><a href="#local-6989586621679233421"><span class="hs-identifier hs-var hs-var">namesMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Key, TestName)] -&gt; IntMap TestName
forall a. [(Key, a)] -&gt; IntMap a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Strict.Internal.html#fromDistinctAscList"><span class="hs-identifier hs-var">IntMap.fromDistinctAscList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Key, TestName)] -&gt; IntMap TestName)
-&gt; [(Key, TestName)] -&gt; IntMap TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Key] -&gt; [TestName] -&gt; [(Key, TestName)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
Item [Key]
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679233420"><span class="hs-identifier hs-var">names</span></a></span><span>
</span><span id="line-269"></span><span>    </span><span class="annot"><span class="annottext">(StatusMap -&gt; IO (Double -&gt; IO Bool))
-&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
forall a. a -&gt; Maybe a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((StatusMap -&gt; IO (Double -&gt; IO Bool))
 -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
-&gt; (StatusMap -&gt; IO (Double -&gt; IO Bool))
-&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679233423"><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679233423"><span class="hs-identifier hs-var">smap</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-270"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; Maybe TestName
forall a. Ord a =&gt; [a] -&gt; Maybe a
</span><a href="Plutarch.Test.Bench.html#findNonUniqueElement"><span class="hs-identifier hs-var">findNonUniqueElement</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679233420"><span class="hs-identifier hs-var">names</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-271"></span><span>        </span><span class="annot"><span class="annottext">Maybe TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-272"></span><span>        </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span id="local-6989586621679233425"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233425"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-273"></span><span>          </span><span class="annot"><span class="annottext">Handle -&gt; TestName -&gt; IO ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Text.html#hPutStrLn"><span class="hs-identifier hs-var">hPutStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#stderr"><span class="hs-identifier hs-var">stderr</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO ()) -&gt; TestName -&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;CSV report cannot proceed, because name '&quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233425"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;' corresponds to two or more benchmarks. Please disambiguate them.&quot;</span></span><span>
</span><span id="line-274"></span><span>          </span><span class="annot"><span class="annottext">IO ()
forall a. IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/System.Exit.html#exitFailure"><span class="hs-identifier hs-var">exitFailure</span></a></span><span>
</span><span id="line-275"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679233426"><span class="annot"><span class="annottext">augmented :: IntMap (TestName, TVar Status)
</span><a href="#local-6989586621679233426"><span class="hs-identifier hs-var hs-var">augmented</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; TVar Status -&gt; (TestName, TVar Status))
-&gt; IntMap TestName -&gt; StatusMap -&gt; IntMap (TestName, TVar Status)
forall a b c. (a -&gt; b -&gt; c) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap c
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Strict.Internal.html#intersectionWith"><span class="hs-identifier hs-var">IntMap.intersectionWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap TestName
</span><a href="#local-6989586621679233421"><span class="hs-identifier hs-var">namesMap</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679233423"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-276"></span><span>      </span><span class="annot"><span class="annottext">IO Handle -&gt; (Handle -&gt; IO ()) -&gt; (Handle -&gt; IO ()) -&gt; IO ()
forall a b c. IO a -&gt; (a -&gt; IO b) -&gt; (a -&gt; IO c) -&gt; IO c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Exception.Base.html#bracket"><span class="hs-identifier hs-var">bracket</span></a></span><span>
</span><span id="line-277"></span><span>        </span><span class="hs-special">(</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-278"></span><span>            </span><span id="local-6989586621679233428"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679233428"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IOMode -&gt; IO Handle
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.StdHandles.html#openFile"><span class="hs-identifier hs-var">openFile</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679233419"><span class="hs-identifier hs-var">path</span></a></span><span> </span><span class="annot"><span class="annottext">IOMode
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.IOMode.html#WriteMode"><span class="hs-identifier hs-var">WriteMode</span></a></span><span>
</span><span id="line-279"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; BufferMode -&gt; IO ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.html#hSetBuffering"><span class="hs-identifier hs-var">hSetBuffering</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679233428"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">BufferMode
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Types.html#LineBuffering"><span class="hs-identifier hs-var">LineBuffering</span></a></span><span>
</span><span id="line-280"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; TestName -&gt; IO ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Text.html#hPutStrLn"><span class="hs-identifier hs-var">hPutStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679233428"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;name,cpu,mem,size&quot;</span></span><span>
</span><span id="line-281"></span><span>            </span><span class="annot"><span class="annottext">Handle -&gt; IO Handle
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679233428"><span class="hs-identifier hs-var">h</span></a></span><span>
</span><span id="line-282"></span><span>        </span><span class="hs-special">)</span><span>
</span><span id="line-283"></span><span>        </span><span class="annot"><span class="annottext">Handle -&gt; IO ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.html#hClose"><span class="hs-identifier hs-var">hClose</span></a></span><span>
</span><span id="line-284"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Handle -&gt; IntMap (TestName, TVar Status) -&gt; IO ()
</span><a href="Plutarch.Test.Bench.html#csvOutput"><span class="hs-operator hs-var">`csvOutput`</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (TestName, TVar Status)
</span><a href="#local-6989586621679233426"><span class="hs-identifier hs-var">augmented</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-285"></span><span>      </span><span class="annot"><span class="annottext">(Double -&gt; IO Bool) -&gt; IO (Double -&gt; IO Bool)
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((Double -&gt; IO Bool) -&gt; IO (Double -&gt; IO Bool))
-&gt; (Double -&gt; IO Bool) -&gt; IO (Double -&gt; IO Bool)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; Double -&gt; IO Bool
forall a b. a -&gt; b -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">(IO Bool -&gt; Double -&gt; IO Bool) -&gt; IO Bool -&gt; Double -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap -&gt; IO Bool
</span><a href="Plutarch.Test.Bench.html#isSuccessful"><span class="hs-identifier hs-var">isSuccessful</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap
</span><a href="#local-6989586621679233423"><span class="hs-identifier hs-var">smap</span></a></span><span>
</span><span id="line-286"></span><span>
</span><span id="line-287"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-288"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailIfMoreCpu"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier hs-var">FailIfMoreCpu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailIfMoreCpu"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier hs-var">FailIfMoreCpu</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-289"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-290"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-291"></span><span>      </span><span id="local-6989586621679233434"><span id="local-6989586621679233438"><span class="annot"><span class="annottext">FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
(FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool) -&gt; Eq FailIfMoreCpu
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
== :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
$c/= :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
/= :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-292"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-293"></span><span>      </span><span id="local-6989586621679233445"><span id="local-6989586621679233448"><span id="local-6989586621679233451"><span id="local-6989586621679233455"><span id="local-6989586621679233458"><span id="local-6989586621679233461"><span id="local-6989586621679233464"><span class="annot"><span class="annottext">Eq FailIfMoreCpu
Eq FailIfMoreCpu =&gt;
(FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Ordering)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; Ord FailIfMoreCpu
FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Ordering
FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Ordering
compare :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Ordering
$c&lt; :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
&lt; :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
$c&lt;= :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
&lt;= :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
$c&gt; :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
&gt; :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
$c&gt;= :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
&gt;= :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; Bool
$cmax :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
max :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
$cmin :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
min :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-294"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-295"></span><span>      </span><span id="local-6989586621679233468"><span id="local-6989586621679233473"><span id="local-6989586621679233477"><span class="annot"><span class="annottext">Key -&gt; FailIfMoreCpu -&gt; TestName -&gt; TestName
[FailIfMoreCpu] -&gt; TestName -&gt; TestName
FailIfMoreCpu -&gt; TestName
(Key -&gt; FailIfMoreCpu -&gt; TestName -&gt; TestName)
-&gt; (FailIfMoreCpu -&gt; TestName)
-&gt; ([FailIfMoreCpu] -&gt; TestName -&gt; TestName)
-&gt; Show FailIfMoreCpu
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: Key -&gt; FailIfMoreCpu -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; FailIfMoreCpu -&gt; TestName -&gt; TestName
$cshow :: FailIfMoreCpu -&gt; TestName
show :: FailIfMoreCpu -&gt; TestName
$cshowList :: [FailIfMoreCpu] -&gt; TestName -&gt; TestName
showList :: [FailIfMoreCpu] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-296"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-297"></span><span>      </span><span id="local-6989586621679233481"><span id="local-6989586621679233485"><span id="local-6989586621679233488"><span id="local-6989586621679233495"><span class="annot"><span class="annottext">ReadPrec [FailIfMoreCpu]
ReadPrec FailIfMoreCpu
Key -&gt; ReadS FailIfMoreCpu
ReadS [FailIfMoreCpu]
(Key -&gt; ReadS FailIfMoreCpu)
-&gt; ReadS [FailIfMoreCpu]
-&gt; ReadPrec FailIfMoreCpu
-&gt; ReadPrec [FailIfMoreCpu]
-&gt; Read FailIfMoreCpu
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Key -&gt; ReadS FailIfMoreCpu
readsPrec :: Key -&gt; ReadS FailIfMoreCpu
$creadList :: ReadS [FailIfMoreCpu]
readList :: ReadS [FailIfMoreCpu]
$creadPrec :: ReadPrec FailIfMoreCpu
readPrec :: ReadPrec FailIfMoreCpu
$creadListPrec :: ReadPrec [FailIfMoreCpu]
readListPrec :: ReadPrec [FailIfMoreCpu]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span>
</span><span id="line-298"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-299"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-300"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-301"></span><span>      </span><span id="local-6989586621679233499"><span id="local-6989586621679233503"><span id="local-6989586621679233507"><span id="local-6989586621679233511"><span id="local-6989586621679233515"><span id="local-6989586621679233519"><span id="local-6989586621679233523"><span class="annot"><span class="annottext">Integer -&gt; FailIfMoreCpu
FailIfMoreCpu -&gt; FailIfMoreCpu
FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
(FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (Integer -&gt; FailIfMoreCpu)
-&gt; Num FailIfMoreCpu
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
+ :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
$c- :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
- :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
$c* :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
* :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
$cnegate :: FailIfMoreCpu -&gt; FailIfMoreCpu
negate :: FailIfMoreCpu -&gt; FailIfMoreCpu
$cabs :: FailIfMoreCpu -&gt; FailIfMoreCpu
abs :: FailIfMoreCpu -&gt; FailIfMoreCpu
$csignum :: FailIfMoreCpu -&gt; FailIfMoreCpu
signum :: FailIfMoreCpu -&gt; FailIfMoreCpu
$cfromInteger :: Integer -&gt; FailIfMoreCpu
fromInteger :: Integer -&gt; FailIfMoreCpu
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-302"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-303"></span><span>      </span><span id="local-6989586621679233531"><span id="local-6989586621679233535"><span id="local-6989586621679233539"><span class="annot"><span class="annottext">Num FailIfMoreCpu
Num FailIfMoreCpu =&gt;
(FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (FailIfMoreCpu -&gt; FailIfMoreCpu)
-&gt; (Rational -&gt; FailIfMoreCpu)
-&gt; Fractional FailIfMoreCpu
Rational -&gt; FailIfMoreCpu
FailIfMoreCpu -&gt; FailIfMoreCpu
FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
/ :: FailIfMoreCpu -&gt; FailIfMoreCpu -&gt; FailIfMoreCpu
$crecip :: FailIfMoreCpu -&gt; FailIfMoreCpu
recip :: FailIfMoreCpu -&gt; FailIfMoreCpu
$cfromRational :: Rational -&gt; FailIfMoreCpu
fromRational :: Rational -&gt; FailIfMoreCpu
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#Fractional"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></a></span></span></span></span><span>
</span><span id="line-304"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-305"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-306"></span><span>
</span><span id="line-307"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-308"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679233551"><span id="local-6989586621679233555"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier hs-type">FailIfMoreCpu</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-309"></span><span>  </span><span id="local-6989586621679233561"><span class="annot"><span class="annottext">defaultValue :: FailIfMoreCpu
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfMoreCpu
</span><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier hs-var">FailIfMoreCpu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-310"></span><span>  </span><span id="local-6989586621679233563"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe FailIfMoreCpu
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FailIfMoreCpu) -&gt; Maybe Double -&gt; Maybe FailIfMoreCpu
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfMoreCpu
</span><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier hs-var">FailIfMoreCpu</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe FailIfMoreCpu)
-&gt; (TestName -&gt; Maybe Double) -&gt; TestName -&gt; Maybe FailIfMoreCpu
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Double
</span><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-var">parsePositivePercents</span></a></span><span>
</span><span id="line-311"></span><span>  </span><span id="local-6989586621679233566"><span class="annot"><span class="annottext">optionName :: Tagged @Type FailIfMoreCpu TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfMoreCpu TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;fail-if-more-cpu&quot;</span></span><span>
</span><span id="line-312"></span><span>  </span><span id="local-6989586621679233568"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type FailIfMoreCpu TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfMoreCpu TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;If a benchmark uses unacceptably more CPU than baseline (see --baseline), it will be reported as failed.&quot;</span></span><span>
</span><span id="line-313"></span><span>
</span><span id="line-314"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-315"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailIfLessCpu"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier hs-var">FailIfLessCpu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailIfLessCpu"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier hs-var">FailIfLessCpu</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-316"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-317"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-318"></span><span>      </span><span id="local-6989586621679233571"><span id="local-6989586621679233574"><span class="annot"><span class="annottext">FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
(FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool) -&gt; Eq FailIfLessCpu
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
== :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
$c/= :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
/= :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-319"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-320"></span><span>      </span><span id="local-6989586621679233580"><span id="local-6989586621679233583"><span id="local-6989586621679233586"><span id="local-6989586621679233590"><span id="local-6989586621679233593"><span id="local-6989586621679233596"><span id="local-6989586621679233599"><span class="annot"><span class="annottext">Eq FailIfLessCpu
Eq FailIfLessCpu =&gt;
(FailIfLessCpu -&gt; FailIfLessCpu -&gt; Ordering)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; Ord FailIfLessCpu
FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
FailIfLessCpu -&gt; FailIfLessCpu -&gt; Ordering
FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Ordering
compare :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Ordering
$c&lt; :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
&lt; :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
$c&lt;= :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
&lt;= :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
$c&gt; :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
&gt; :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
$c&gt;= :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
&gt;= :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; Bool
$cmax :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
max :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
$cmin :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
min :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-321"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-322"></span><span>      </span><span id="local-6989586621679233602"><span id="local-6989586621679233606"><span id="local-6989586621679233610"><span class="annot"><span class="annottext">Key -&gt; FailIfLessCpu -&gt; TestName -&gt; TestName
[FailIfLessCpu] -&gt; TestName -&gt; TestName
FailIfLessCpu -&gt; TestName
(Key -&gt; FailIfLessCpu -&gt; TestName -&gt; TestName)
-&gt; (FailIfLessCpu -&gt; TestName)
-&gt; ([FailIfLessCpu] -&gt; TestName -&gt; TestName)
-&gt; Show FailIfLessCpu
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: Key -&gt; FailIfLessCpu -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; FailIfLessCpu -&gt; TestName -&gt; TestName
$cshow :: FailIfLessCpu -&gt; TestName
show :: FailIfLessCpu -&gt; TestName
$cshowList :: [FailIfLessCpu] -&gt; TestName -&gt; TestName
showList :: [FailIfLessCpu] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-323"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-324"></span><span>      </span><span id="local-6989586621679233613"><span id="local-6989586621679233617"><span id="local-6989586621679233620"><span id="local-6989586621679233626"><span class="annot"><span class="annottext">ReadPrec [FailIfLessCpu]
ReadPrec FailIfLessCpu
Key -&gt; ReadS FailIfLessCpu
ReadS [FailIfLessCpu]
(Key -&gt; ReadS FailIfLessCpu)
-&gt; ReadS [FailIfLessCpu]
-&gt; ReadPrec FailIfLessCpu
-&gt; ReadPrec [FailIfLessCpu]
-&gt; Read FailIfLessCpu
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Key -&gt; ReadS FailIfLessCpu
readsPrec :: Key -&gt; ReadS FailIfLessCpu
$creadList :: ReadS [FailIfLessCpu]
readList :: ReadS [FailIfLessCpu]
$creadPrec :: ReadPrec FailIfLessCpu
readPrec :: ReadPrec FailIfLessCpu
$creadListPrec :: ReadPrec [FailIfLessCpu]
readListPrec :: ReadPrec [FailIfLessCpu]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span>
</span><span id="line-325"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-326"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-327"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-328"></span><span>      </span><span id="local-6989586621679233629"><span id="local-6989586621679233633"><span id="local-6989586621679233637"><span id="local-6989586621679233641"><span id="local-6989586621679233645"><span id="local-6989586621679233649"><span id="local-6989586621679233653"><span class="annot"><span class="annottext">Integer -&gt; FailIfLessCpu
FailIfLessCpu -&gt; FailIfLessCpu
FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
(FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (Integer -&gt; FailIfLessCpu)
-&gt; Num FailIfLessCpu
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
+ :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
$c- :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
- :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
$c* :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
* :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
$cnegate :: FailIfLessCpu -&gt; FailIfLessCpu
negate :: FailIfLessCpu -&gt; FailIfLessCpu
$cabs :: FailIfLessCpu -&gt; FailIfLessCpu
abs :: FailIfLessCpu -&gt; FailIfLessCpu
$csignum :: FailIfLessCpu -&gt; FailIfLessCpu
signum :: FailIfLessCpu -&gt; FailIfLessCpu
$cfromInteger :: Integer -&gt; FailIfLessCpu
fromInteger :: Integer -&gt; FailIfLessCpu
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-329"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-330"></span><span>      </span><span id="local-6989586621679233660"><span id="local-6989586621679233664"><span id="local-6989586621679233668"><span class="annot"><span class="annottext">Num FailIfLessCpu
Num FailIfLessCpu =&gt;
(FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (FailIfLessCpu -&gt; FailIfLessCpu)
-&gt; (Rational -&gt; FailIfLessCpu)
-&gt; Fractional FailIfLessCpu
Rational -&gt; FailIfLessCpu
FailIfLessCpu -&gt; FailIfLessCpu
FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
/ :: FailIfLessCpu -&gt; FailIfLessCpu -&gt; FailIfLessCpu
$crecip :: FailIfLessCpu -&gt; FailIfLessCpu
recip :: FailIfLessCpu -&gt; FailIfLessCpu
$cfromRational :: Rational -&gt; FailIfLessCpu
fromRational :: Rational -&gt; FailIfLessCpu
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#Fractional"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></a></span></span></span></span><span>
</span><span id="line-331"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-332"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-333"></span><span>
</span><span id="line-334"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-335"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679233679"><span id="local-6989586621679233683"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier hs-type">FailIfLessCpu</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-336"></span><span>  </span><span id="local-6989586621679233688"><span class="annot"><span class="annottext">defaultValue :: FailIfLessCpu
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfLessCpu
</span><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier hs-var">FailIfLessCpu</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-337"></span><span>  </span><span id="local-6989586621679233690"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe FailIfLessCpu
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FailIfLessCpu) -&gt; Maybe Double -&gt; Maybe FailIfLessCpu
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfLessCpu
</span><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier hs-var">FailIfLessCpu</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe FailIfLessCpu)
-&gt; (TestName -&gt; Maybe Double) -&gt; TestName -&gt; Maybe FailIfLessCpu
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Double
</span><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-var">parsePositivePercents</span></a></span><span>
</span><span id="line-338"></span><span>  </span><span id="local-6989586621679233692"><span class="annot"><span class="annottext">optionName :: Tagged @Type FailIfLessCpu TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfLessCpu TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;fail-if-less-cpu&quot;</span></span><span>
</span><span id="line-339"></span><span>  </span><span id="local-6989586621679233694"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type FailIfLessCpu TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfLessCpu TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;If a benchmark uses unacceptably less CPU than baseline (see --baseline), it will be reported as failed.&quot;</span></span><span>
</span><span id="line-340"></span><span>
</span><span id="line-341"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-342"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailIfMoreMem"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier hs-var">FailIfMoreMem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailIfMoreMem"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier hs-var">FailIfMoreMem</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-343"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-344"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-345"></span><span>      </span><span id="local-6989586621679233697"><span id="local-6989586621679233700"><span class="annot"><span class="annottext">FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
(FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool) -&gt; Eq FailIfMoreMem
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
== :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
$c/= :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
/= :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-346"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-347"></span><span>      </span><span id="local-6989586621679233706"><span id="local-6989586621679233709"><span id="local-6989586621679233712"><span id="local-6989586621679233716"><span id="local-6989586621679233719"><span id="local-6989586621679233722"><span id="local-6989586621679233725"><span class="annot"><span class="annottext">Eq FailIfMoreMem
Eq FailIfMoreMem =&gt;
(FailIfMoreMem -&gt; FailIfMoreMem -&gt; Ordering)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; Ord FailIfMoreMem
FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
FailIfMoreMem -&gt; FailIfMoreMem -&gt; Ordering
FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Ordering
compare :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Ordering
$c&lt; :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
&lt; :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
$c&lt;= :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
&lt;= :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
$c&gt; :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
&gt; :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
$c&gt;= :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
&gt;= :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; Bool
$cmax :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
max :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
$cmin :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
min :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-348"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-349"></span><span>      </span><span id="local-6989586621679233728"><span id="local-6989586621679233732"><span id="local-6989586621679233736"><span class="annot"><span class="annottext">Key -&gt; FailIfMoreMem -&gt; TestName -&gt; TestName
[FailIfMoreMem] -&gt; TestName -&gt; TestName
FailIfMoreMem -&gt; TestName
(Key -&gt; FailIfMoreMem -&gt; TestName -&gt; TestName)
-&gt; (FailIfMoreMem -&gt; TestName)
-&gt; ([FailIfMoreMem] -&gt; TestName -&gt; TestName)
-&gt; Show FailIfMoreMem
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: Key -&gt; FailIfMoreMem -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; FailIfMoreMem -&gt; TestName -&gt; TestName
$cshow :: FailIfMoreMem -&gt; TestName
show :: FailIfMoreMem -&gt; TestName
$cshowList :: [FailIfMoreMem] -&gt; TestName -&gt; TestName
showList :: [FailIfMoreMem] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-350"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-351"></span><span>      </span><span id="local-6989586621679233739"><span id="local-6989586621679233743"><span id="local-6989586621679233746"><span id="local-6989586621679233752"><span class="annot"><span class="annottext">ReadPrec [FailIfMoreMem]
ReadPrec FailIfMoreMem
Key -&gt; ReadS FailIfMoreMem
ReadS [FailIfMoreMem]
(Key -&gt; ReadS FailIfMoreMem)
-&gt; ReadS [FailIfMoreMem]
-&gt; ReadPrec FailIfMoreMem
-&gt; ReadPrec [FailIfMoreMem]
-&gt; Read FailIfMoreMem
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Key -&gt; ReadS FailIfMoreMem
readsPrec :: Key -&gt; ReadS FailIfMoreMem
$creadList :: ReadS [FailIfMoreMem]
readList :: ReadS [FailIfMoreMem]
$creadPrec :: ReadPrec FailIfMoreMem
readPrec :: ReadPrec FailIfMoreMem
$creadListPrec :: ReadPrec [FailIfMoreMem]
readListPrec :: ReadPrec [FailIfMoreMem]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span>
</span><span id="line-352"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-353"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-354"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-355"></span><span>      </span><span id="local-6989586621679233755"><span id="local-6989586621679233759"><span id="local-6989586621679233763"><span id="local-6989586621679233767"><span id="local-6989586621679233771"><span id="local-6989586621679233775"><span id="local-6989586621679233779"><span class="annot"><span class="annottext">Integer -&gt; FailIfMoreMem
FailIfMoreMem -&gt; FailIfMoreMem
FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
(FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (Integer -&gt; FailIfMoreMem)
-&gt; Num FailIfMoreMem
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
+ :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
$c- :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
- :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
$c* :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
* :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
$cnegate :: FailIfMoreMem -&gt; FailIfMoreMem
negate :: FailIfMoreMem -&gt; FailIfMoreMem
$cabs :: FailIfMoreMem -&gt; FailIfMoreMem
abs :: FailIfMoreMem -&gt; FailIfMoreMem
$csignum :: FailIfMoreMem -&gt; FailIfMoreMem
signum :: FailIfMoreMem -&gt; FailIfMoreMem
$cfromInteger :: Integer -&gt; FailIfMoreMem
fromInteger :: Integer -&gt; FailIfMoreMem
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-356"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-357"></span><span>      </span><span id="local-6989586621679233786"><span id="local-6989586621679233790"><span id="local-6989586621679233794"><span class="annot"><span class="annottext">Num FailIfMoreMem
Num FailIfMoreMem =&gt;
(FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (FailIfMoreMem -&gt; FailIfMoreMem)
-&gt; (Rational -&gt; FailIfMoreMem)
-&gt; Fractional FailIfMoreMem
Rational -&gt; FailIfMoreMem
FailIfMoreMem -&gt; FailIfMoreMem
FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
/ :: FailIfMoreMem -&gt; FailIfMoreMem -&gt; FailIfMoreMem
$crecip :: FailIfMoreMem -&gt; FailIfMoreMem
recip :: FailIfMoreMem -&gt; FailIfMoreMem
$cfromRational :: Rational -&gt; FailIfMoreMem
fromRational :: Rational -&gt; FailIfMoreMem
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#Fractional"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></a></span></span></span></span><span>
</span><span id="line-358"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-359"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-360"></span><span>
</span><span id="line-361"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-362"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679233805"><span id="local-6989586621679233809"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier hs-type">FailIfMoreMem</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-363"></span><span>  </span><span id="local-6989586621679233814"><span class="annot"><span class="annottext">defaultValue :: FailIfMoreMem
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfMoreMem
</span><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier hs-var">FailIfMoreMem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-364"></span><span>  </span><span id="local-6989586621679233816"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe FailIfMoreMem
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FailIfMoreMem) -&gt; Maybe Double -&gt; Maybe FailIfMoreMem
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfMoreMem
</span><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier hs-var">FailIfMoreMem</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe FailIfMoreMem)
-&gt; (TestName -&gt; Maybe Double) -&gt; TestName -&gt; Maybe FailIfMoreMem
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Double
</span><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-var">parsePositivePercents</span></a></span><span>
</span><span id="line-365"></span><span>  </span><span id="local-6989586621679233818"><span class="annot"><span class="annottext">optionName :: Tagged @Type FailIfMoreMem TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfMoreMem TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;fail-if-more-cpu&quot;</span></span><span>
</span><span id="line-366"></span><span>  </span><span id="local-6989586621679233820"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type FailIfMoreMem TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfMoreMem TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;If a benchmark uses unacceptably more MEM than baseline (see --baseline), it will be reported as failed.&quot;</span></span><span>
</span><span id="line-367"></span><span>
</span><span id="line-368"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-369"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailIfLessMem"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier hs-var">FailIfLessMem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailIfLessMem"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier hs-var">FailIfLessMem</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-370"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-371"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-372"></span><span>      </span><span id="local-6989586621679233823"><span id="local-6989586621679233826"><span class="annot"><span class="annottext">FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
(FailIfLessMem -&gt; FailIfLessMem -&gt; Bool)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; Bool) -&gt; Eq FailIfLessMem
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
== :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
$c/= :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
/= :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-373"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-374"></span><span>      </span><span id="local-6989586621679233832"><span id="local-6989586621679233835"><span id="local-6989586621679233838"><span id="local-6989586621679233842"><span id="local-6989586621679233845"><span id="local-6989586621679233848"><span id="local-6989586621679233851"><span class="annot"><span class="annottext">Eq FailIfLessMem
Eq FailIfLessMem =&gt;
(FailIfLessMem -&gt; FailIfLessMem -&gt; Ordering)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; Bool)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; Bool)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; Bool)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; Bool)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem)
-&gt; Ord FailIfLessMem
FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
FailIfLessMem -&gt; FailIfLessMem -&gt; Ordering
FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: FailIfLessMem -&gt; FailIfLessMem -&gt; Ordering
compare :: FailIfLessMem -&gt; FailIfLessMem -&gt; Ordering
$c&lt; :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
&lt; :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
$c&lt;= :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
&lt;= :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
$c&gt; :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
&gt; :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
$c&gt;= :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
&gt;= :: FailIfLessMem -&gt; FailIfLessMem -&gt; Bool
$cmax :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
max :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
$cmin :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
min :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-375"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-376"></span><span>      </span><span id="local-6989586621679233854"><span id="local-6989586621679233858"><span id="local-6989586621679233862"><span class="annot"><span class="annottext">Key -&gt; FailIfLessMem -&gt; TestName -&gt; TestName
[FailIfLessMem] -&gt; TestName -&gt; TestName
FailIfLessMem -&gt; TestName
(Key -&gt; FailIfLessMem -&gt; TestName -&gt; TestName)
-&gt; (FailIfLessMem -&gt; TestName)
-&gt; ([FailIfLessMem] -&gt; TestName -&gt; TestName)
-&gt; Show FailIfLessMem
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: Key -&gt; FailIfLessMem -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; FailIfLessMem -&gt; TestName -&gt; TestName
$cshow :: FailIfLessMem -&gt; TestName
show :: FailIfLessMem -&gt; TestName
$cshowList :: [FailIfLessMem] -&gt; TestName -&gt; TestName
showList :: [FailIfLessMem] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-377"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-378"></span><span>      </span><span id="local-6989586621679233865"><span id="local-6989586621679233869"><span id="local-6989586621679233872"><span id="local-6989586621679233878"><span class="annot"><span class="annottext">ReadPrec [FailIfLessMem]
ReadPrec FailIfLessMem
Key -&gt; ReadS FailIfLessMem
ReadS [FailIfLessMem]
(Key -&gt; ReadS FailIfLessMem)
-&gt; ReadS [FailIfLessMem]
-&gt; ReadPrec FailIfLessMem
-&gt; ReadPrec [FailIfLessMem]
-&gt; Read FailIfLessMem
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Key -&gt; ReadS FailIfLessMem
readsPrec :: Key -&gt; ReadS FailIfLessMem
$creadList :: ReadS [FailIfLessMem]
readList :: ReadS [FailIfLessMem]
$creadPrec :: ReadPrec FailIfLessMem
readPrec :: ReadPrec FailIfLessMem
$creadListPrec :: ReadPrec [FailIfLessMem]
readListPrec :: ReadPrec [FailIfLessMem]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span>
</span><span id="line-379"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-380"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-381"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-382"></span><span>      </span><span id="local-6989586621679233881"><span id="local-6989586621679233885"><span id="local-6989586621679233889"><span id="local-6989586621679233893"><span id="local-6989586621679233897"><span id="local-6989586621679233901"><span id="local-6989586621679233905"><span class="annot"><span class="annottext">Integer -&gt; FailIfLessMem
FailIfLessMem -&gt; FailIfLessMem
FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
(FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem)
-&gt; (FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem)
-&gt; (FailIfLessMem -&gt; FailIfLessMem)
-&gt; (FailIfLessMem -&gt; FailIfLessMem)
-&gt; (FailIfLessMem -&gt; FailIfLessMem)
-&gt; (Integer -&gt; FailIfLessMem)
-&gt; Num FailIfLessMem
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
+ :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
$c- :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
- :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
$c* :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
* :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
$cnegate :: FailIfLessMem -&gt; FailIfLessMem
negate :: FailIfLessMem -&gt; FailIfLessMem
$cabs :: FailIfLessMem -&gt; FailIfLessMem
abs :: FailIfLessMem -&gt; FailIfLessMem
$csignum :: FailIfLessMem -&gt; FailIfLessMem
signum :: FailIfLessMem -&gt; FailIfLessMem
$cfromInteger :: Integer -&gt; FailIfLessMem
fromInteger :: Integer -&gt; FailIfLessMem
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-383"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-384"></span><span>      </span><span id="local-6989586621679233912"><span id="local-6989586621679233916"><span id="local-6989586621679233920"><span class="annot"><span class="annottext">Num FailIfLessMem
Num FailIfLessMem =&gt;
(FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem)
-&gt; (FailIfLessMem -&gt; FailIfLessMem)
-&gt; (Rational -&gt; FailIfLessMem)
-&gt; Fractional FailIfLessMem
Rational -&gt; FailIfLessMem
FailIfLessMem -&gt; FailIfLessMem
FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
/ :: FailIfLessMem -&gt; FailIfLessMem -&gt; FailIfLessMem
$crecip :: FailIfLessMem -&gt; FailIfLessMem
recip :: FailIfLessMem -&gt; FailIfLessMem
$cfromRational :: Rational -&gt; FailIfLessMem
fromRational :: Rational -&gt; FailIfLessMem
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#Fractional"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></a></span></span></span></span><span>
</span><span id="line-385"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-386"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-387"></span><span>
</span><span id="line-388"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-389"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679233931"><span id="local-6989586621679233935"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier hs-type">FailIfLessMem</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-390"></span><span>  </span><span id="local-6989586621679233940"><span class="annot"><span class="annottext">defaultValue :: FailIfLessMem
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfLessMem
</span><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier hs-var">FailIfLessMem</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-391"></span><span>  </span><span id="local-6989586621679233942"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe FailIfLessMem
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FailIfLessMem) -&gt; Maybe Double -&gt; Maybe FailIfLessMem
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfLessMem
</span><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier hs-var">FailIfLessMem</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe FailIfLessMem)
-&gt; (TestName -&gt; Maybe Double) -&gt; TestName -&gt; Maybe FailIfLessMem
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Double
</span><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-var">parsePositivePercents</span></a></span><span>
</span><span id="line-392"></span><span>  </span><span id="local-6989586621679233944"><span class="annot"><span class="annottext">optionName :: Tagged @Type FailIfLessMem TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfLessMem TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;fail-if-less-mem&quot;</span></span><span>
</span><span id="line-393"></span><span>  </span><span id="local-6989586621679233946"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type FailIfLessMem TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfLessMem TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;If a benchmark uses unacceptably less MEM than baseline (see --baseline), it will be reported as failed.&quot;</span></span><span>
</span><span id="line-394"></span><span>
</span><span id="line-395"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-396"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailIfBigger"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier hs-var">FailIfBigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailIfBigger"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier hs-var">FailIfBigger</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-397"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-398"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-399"></span><span>      </span><span id="local-6989586621679233949"><span id="local-6989586621679233952"><span class="annot"><span class="annottext">FailIfBigger -&gt; FailIfBigger -&gt; Bool
(FailIfBigger -&gt; FailIfBigger -&gt; Bool)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; Bool) -&gt; Eq FailIfBigger
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
== :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
$c/= :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
/= :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-400"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-401"></span><span>      </span><span id="local-6989586621679233958"><span id="local-6989586621679233961"><span id="local-6989586621679233964"><span id="local-6989586621679233968"><span id="local-6989586621679233971"><span id="local-6989586621679233974"><span id="local-6989586621679233977"><span class="annot"><span class="annottext">Eq FailIfBigger
Eq FailIfBigger =&gt;
(FailIfBigger -&gt; FailIfBigger -&gt; Ordering)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; Bool)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; Bool)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; Bool)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; Bool)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger)
-&gt; Ord FailIfBigger
FailIfBigger -&gt; FailIfBigger -&gt; Bool
FailIfBigger -&gt; FailIfBigger -&gt; Ordering
FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: FailIfBigger -&gt; FailIfBigger -&gt; Ordering
compare :: FailIfBigger -&gt; FailIfBigger -&gt; Ordering
$c&lt; :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
&lt; :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
$c&lt;= :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
&lt;= :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
$c&gt; :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
&gt; :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
$c&gt;= :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
&gt;= :: FailIfBigger -&gt; FailIfBigger -&gt; Bool
$cmax :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
max :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
$cmin :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
min :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-402"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-403"></span><span>      </span><span id="local-6989586621679233980"><span id="local-6989586621679233984"><span id="local-6989586621679233988"><span class="annot"><span class="annottext">Key -&gt; FailIfBigger -&gt; TestName -&gt; TestName
[FailIfBigger] -&gt; TestName -&gt; TestName
FailIfBigger -&gt; TestName
(Key -&gt; FailIfBigger -&gt; TestName -&gt; TestName)
-&gt; (FailIfBigger -&gt; TestName)
-&gt; ([FailIfBigger] -&gt; TestName -&gt; TestName)
-&gt; Show FailIfBigger
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: Key -&gt; FailIfBigger -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; FailIfBigger -&gt; TestName -&gt; TestName
$cshow :: FailIfBigger -&gt; TestName
show :: FailIfBigger -&gt; TestName
$cshowList :: [FailIfBigger] -&gt; TestName -&gt; TestName
showList :: [FailIfBigger] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-404"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-405"></span><span>      </span><span id="local-6989586621679233991"><span id="local-6989586621679233995"><span id="local-6989586621679233998"><span id="local-6989586621679234004"><span class="annot"><span class="annottext">ReadPrec [FailIfBigger]
ReadPrec FailIfBigger
Key -&gt; ReadS FailIfBigger
ReadS [FailIfBigger]
(Key -&gt; ReadS FailIfBigger)
-&gt; ReadS [FailIfBigger]
-&gt; ReadPrec FailIfBigger
-&gt; ReadPrec [FailIfBigger]
-&gt; Read FailIfBigger
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Key -&gt; ReadS FailIfBigger
readsPrec :: Key -&gt; ReadS FailIfBigger
$creadList :: ReadS [FailIfBigger]
readList :: ReadS [FailIfBigger]
$creadPrec :: ReadPrec FailIfBigger
readPrec :: ReadPrec FailIfBigger
$creadListPrec :: ReadPrec [FailIfBigger]
readListPrec :: ReadPrec [FailIfBigger]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span>
</span><span id="line-406"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-407"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-408"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-409"></span><span>      </span><span id="local-6989586621679234007"><span id="local-6989586621679234011"><span id="local-6989586621679234015"><span id="local-6989586621679234019"><span id="local-6989586621679234023"><span id="local-6989586621679234027"><span id="local-6989586621679234031"><span class="annot"><span class="annottext">Integer -&gt; FailIfBigger
FailIfBigger -&gt; FailIfBigger
FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
(FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger)
-&gt; (FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger)
-&gt; (FailIfBigger -&gt; FailIfBigger)
-&gt; (FailIfBigger -&gt; FailIfBigger)
-&gt; (FailIfBigger -&gt; FailIfBigger)
-&gt; (Integer -&gt; FailIfBigger)
-&gt; Num FailIfBigger
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
+ :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
$c- :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
- :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
$c* :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
* :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
$cnegate :: FailIfBigger -&gt; FailIfBigger
negate :: FailIfBigger -&gt; FailIfBigger
$cabs :: FailIfBigger -&gt; FailIfBigger
abs :: FailIfBigger -&gt; FailIfBigger
$csignum :: FailIfBigger -&gt; FailIfBigger
signum :: FailIfBigger -&gt; FailIfBigger
$cfromInteger :: Integer -&gt; FailIfBigger
fromInteger :: Integer -&gt; FailIfBigger
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-410"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-411"></span><span>      </span><span id="local-6989586621679234038"><span id="local-6989586621679234042"><span id="local-6989586621679234046"><span class="annot"><span class="annottext">Num FailIfBigger
Num FailIfBigger =&gt;
(FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger)
-&gt; (FailIfBigger -&gt; FailIfBigger)
-&gt; (Rational -&gt; FailIfBigger)
-&gt; Fractional FailIfBigger
Rational -&gt; FailIfBigger
FailIfBigger -&gt; FailIfBigger
FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
/ :: FailIfBigger -&gt; FailIfBigger -&gt; FailIfBigger
$crecip :: FailIfBigger -&gt; FailIfBigger
recip :: FailIfBigger -&gt; FailIfBigger
$cfromRational :: Rational -&gt; FailIfBigger
fromRational :: Rational -&gt; FailIfBigger
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#Fractional"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></a></span></span></span></span><span>
</span><span id="line-412"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-413"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-414"></span><span>
</span><span id="line-415"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-416"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679234057"><span id="local-6989586621679234061"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier hs-type">FailIfBigger</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-417"></span><span>  </span><span id="local-6989586621679234066"><span class="annot"><span class="annottext">defaultValue :: FailIfBigger
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfBigger
</span><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier hs-var">FailIfBigger</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-418"></span><span>  </span><span id="local-6989586621679234068"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe FailIfBigger
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FailIfBigger) -&gt; Maybe Double -&gt; Maybe FailIfBigger
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfBigger
</span><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier hs-var">FailIfBigger</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe FailIfBigger)
-&gt; (TestName -&gt; Maybe Double) -&gt; TestName -&gt; Maybe FailIfBigger
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Double
</span><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-var">parsePositivePercents</span></a></span><span>
</span><span id="line-419"></span><span>  </span><span id="local-6989586621679234070"><span class="annot"><span class="annottext">optionName :: Tagged @Type FailIfBigger TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfBigger TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;fail-if-bigger&quot;</span></span><span>
</span><span id="line-420"></span><span>  </span><span id="local-6989586621679234072"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type FailIfBigger TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfBigger TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;If a benchmark is unacceptably bigger than baseline (see --baseline), it will be reported as failed.&quot;</span></span><span>
</span><span id="line-421"></span><span>
</span><span id="line-422"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-423"></span><span class="hs-keyword">newtype</span><span> </span><span id="FailIfSmaller"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier hs-var">FailIfSmaller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="FailIfSmaller"><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier hs-var">FailIfSmaller</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-424"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-425"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-426"></span><span>      </span><span id="local-6989586621679234075"><span id="local-6989586621679234078"><span class="annot"><span class="annottext">FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
(FailIfSmaller -&gt; FailIfSmaller -&gt; Bool)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; Bool) -&gt; Eq FailIfSmaller
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
== :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
$c/= :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
/= :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-427"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-428"></span><span>      </span><span id="local-6989586621679234084"><span id="local-6989586621679234087"><span id="local-6989586621679234090"><span id="local-6989586621679234094"><span id="local-6989586621679234097"><span id="local-6989586621679234100"><span id="local-6989586621679234103"><span class="annot"><span class="annottext">Eq FailIfSmaller
Eq FailIfSmaller =&gt;
(FailIfSmaller -&gt; FailIfSmaller -&gt; Ordering)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; Bool)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; Bool)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; Bool)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; Bool)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller)
-&gt; Ord FailIfSmaller
FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
FailIfSmaller -&gt; FailIfSmaller -&gt; Ordering
FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: FailIfSmaller -&gt; FailIfSmaller -&gt; Ordering
compare :: FailIfSmaller -&gt; FailIfSmaller -&gt; Ordering
$c&lt; :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
&lt; :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
$c&lt;= :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
&lt;= :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
$c&gt; :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
&gt; :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
$c&gt;= :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
&gt;= :: FailIfSmaller -&gt; FailIfSmaller -&gt; Bool
$cmax :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
max :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
$cmin :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
min :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-429"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-430"></span><span>      </span><span id="local-6989586621679234106"><span id="local-6989586621679234110"><span id="local-6989586621679234114"><span class="annot"><span class="annottext">Key -&gt; FailIfSmaller -&gt; TestName -&gt; TestName
[FailIfSmaller] -&gt; TestName -&gt; TestName
FailIfSmaller -&gt; TestName
(Key -&gt; FailIfSmaller -&gt; TestName -&gt; TestName)
-&gt; (FailIfSmaller -&gt; TestName)
-&gt; ([FailIfSmaller] -&gt; TestName -&gt; TestName)
-&gt; Show FailIfSmaller
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: Key -&gt; FailIfSmaller -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; FailIfSmaller -&gt; TestName -&gt; TestName
$cshow :: FailIfSmaller -&gt; TestName
show :: FailIfSmaller -&gt; TestName
$cshowList :: [FailIfSmaller] -&gt; TestName -&gt; TestName
showList :: [FailIfSmaller] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span>
</span><span id="line-431"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-432"></span><span>      </span><span id="local-6989586621679234117"><span id="local-6989586621679234121"><span id="local-6989586621679234124"><span id="local-6989586621679234130"><span class="annot"><span class="annottext">ReadPrec [FailIfSmaller]
ReadPrec FailIfSmaller
Key -&gt; ReadS FailIfSmaller
ReadS [FailIfSmaller]
(Key -&gt; ReadS FailIfSmaller)
-&gt; ReadS [FailIfSmaller]
-&gt; ReadPrec FailIfSmaller
-&gt; ReadPrec [FailIfSmaller]
-&gt; Read FailIfSmaller
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Key -&gt; ReadS FailIfSmaller
readsPrec :: Key -&gt; ReadS FailIfSmaller
$creadList :: ReadS [FailIfSmaller]
readList :: ReadS [FailIfSmaller]
$creadPrec :: ReadPrec FailIfSmaller
readPrec :: ReadPrec FailIfSmaller
$creadListPrec :: ReadPrec [FailIfSmaller]
readListPrec :: ReadPrec [FailIfSmaller]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span>
</span><span id="line-433"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-434"></span><span>  </span><span class="hs-keyword">deriving</span><span>
</span><span id="line-435"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-436"></span><span>      </span><span id="local-6989586621679234133"><span id="local-6989586621679234137"><span id="local-6989586621679234141"><span id="local-6989586621679234145"><span id="local-6989586621679234149"><span id="local-6989586621679234153"><span id="local-6989586621679234157"><span class="annot"><span class="annottext">Integer -&gt; FailIfSmaller
FailIfSmaller -&gt; FailIfSmaller
FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
(FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller)
-&gt; (FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller)
-&gt; (FailIfSmaller -&gt; FailIfSmaller)
-&gt; (FailIfSmaller -&gt; FailIfSmaller)
-&gt; (FailIfSmaller -&gt; FailIfSmaller)
-&gt; (Integer -&gt; FailIfSmaller)
-&gt; Num FailIfSmaller
forall a.
(a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (a -&gt; a)
-&gt; (Integer -&gt; a)
-&gt; Num a
$c+ :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
+ :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
$c- :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
- :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
$c* :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
* :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
$cnegate :: FailIfSmaller -&gt; FailIfSmaller
negate :: FailIfSmaller -&gt; FailIfSmaller
$cabs :: FailIfSmaller -&gt; FailIfSmaller
abs :: FailIfSmaller -&gt; FailIfSmaller
$csignum :: FailIfSmaller -&gt; FailIfSmaller
signum :: FailIfSmaller -&gt; FailIfSmaller
$cfromInteger :: Integer -&gt; FailIfSmaller
fromInteger :: Integer -&gt; FailIfSmaller
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#Num"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Num</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-437"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-438"></span><span>      </span><span id="local-6989586621679234164"><span id="local-6989586621679234168"><span id="local-6989586621679234172"><span class="annot"><span class="annottext">Num FailIfSmaller
Num FailIfSmaller =&gt;
(FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller)
-&gt; (FailIfSmaller -&gt; FailIfSmaller)
-&gt; (Rational -&gt; FailIfSmaller)
-&gt; Fractional FailIfSmaller
Rational -&gt; FailIfSmaller
FailIfSmaller -&gt; FailIfSmaller
FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
forall a.
Num a =&gt;
(a -&gt; a -&gt; a) -&gt; (a -&gt; a) -&gt; (Rational -&gt; a) -&gt; Fractional a
$c/ :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
/ :: FailIfSmaller -&gt; FailIfSmaller -&gt; FailIfSmaller
$crecip :: FailIfSmaller -&gt; FailIfSmaller
recip :: FailIfSmaller -&gt; FailIfSmaller
$cfromRational :: Rational -&gt; FailIfSmaller
fromRational :: Rational -&gt; FailIfSmaller
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#Fractional"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Fractional</span></a></span></span></span></span><span>
</span><span id="line-439"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-440"></span><span>    </span><span class="hs-keyword">via</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-441"></span><span>
</span><span id="line-442"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-443"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679234183"><span id="local-6989586621679234187"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier hs-type">FailIfSmaller</span></a></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-444"></span><span>  </span><span id="local-6989586621679234192"><span class="annot"><span class="annottext">defaultValue :: FailIfSmaller
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfSmaller
</span><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier hs-var">FailIfSmaller</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1.0</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0.0</span></span><span class="hs-special">)</span><span>
</span><span id="line-445"></span><span>  </span><span id="local-6989586621679234194"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe FailIfSmaller
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Double -&gt; FailIfSmaller) -&gt; Maybe Double -&gt; Maybe FailIfSmaller
forall a b. (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; FailIfSmaller
</span><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier hs-var">FailIfSmaller</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe Double -&gt; Maybe FailIfSmaller)
-&gt; (TestName -&gt; Maybe Double) -&gt; TestName -&gt; Maybe FailIfSmaller
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Double
</span><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-var">parsePositivePercents</span></a></span><span>
</span><span id="line-446"></span><span>  </span><span id="local-6989586621679234196"><span class="annot"><span class="annottext">optionName :: Tagged @Type FailIfSmaller TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfSmaller TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;fail-if-smaller&quot;</span></span><span>
</span><span id="line-447"></span><span>  </span><span id="local-6989586621679234198"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type FailIfSmaller TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type FailIfSmaller TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;If a benchmark is unacceptably smaller than baseline (see --baseline), it will be reported as failed.&quot;</span></span><span>
</span><span id="line-448"></span><span>
</span><span id="line-449"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-450"></span><span class="hs-keyword">newtype</span><span> </span><span id="BaselinePath"><span class="annot"><a href="Plutarch.Test.Bench.html#BaselinePath"><span class="hs-identifier hs-var">BaselinePath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="BaselinePath"><span class="annot"><a href="Plutarch.Test.Bench.html#BaselinePath"><span class="hs-identifier hs-var">BaselinePath</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-451"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-452"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-453"></span><span>      </span><span id="local-6989586621679234201"><span id="local-6989586621679234204"><span class="annot"><span class="annottext">BaselinePath -&gt; BaselinePath -&gt; Bool
(BaselinePath -&gt; BaselinePath -&gt; Bool)
-&gt; (BaselinePath -&gt; BaselinePath -&gt; Bool) -&gt; Eq BaselinePath
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: BaselinePath -&gt; BaselinePath -&gt; Bool
== :: BaselinePath -&gt; BaselinePath -&gt; Bool
$c/= :: BaselinePath -&gt; BaselinePath -&gt; Bool
/= :: BaselinePath -&gt; BaselinePath -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-454"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-455"></span><span>      </span><span id="local-6989586621679234210"><span id="local-6989586621679234213"><span id="local-6989586621679234216"><span id="local-6989586621679234220"><span id="local-6989586621679234223"><span id="local-6989586621679234226"><span id="local-6989586621679234229"><span class="annot"><span class="annottext">Eq BaselinePath
Eq BaselinePath =&gt;
(BaselinePath -&gt; BaselinePath -&gt; Ordering)
-&gt; (BaselinePath -&gt; BaselinePath -&gt; Bool)
-&gt; (BaselinePath -&gt; BaselinePath -&gt; Bool)
-&gt; (BaselinePath -&gt; BaselinePath -&gt; Bool)
-&gt; (BaselinePath -&gt; BaselinePath -&gt; Bool)
-&gt; (BaselinePath -&gt; BaselinePath -&gt; BaselinePath)
-&gt; (BaselinePath -&gt; BaselinePath -&gt; BaselinePath)
-&gt; Ord BaselinePath
BaselinePath -&gt; BaselinePath -&gt; Bool
BaselinePath -&gt; BaselinePath -&gt; Ordering
BaselinePath -&gt; BaselinePath -&gt; BaselinePath
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: BaselinePath -&gt; BaselinePath -&gt; Ordering
compare :: BaselinePath -&gt; BaselinePath -&gt; Ordering
$c&lt; :: BaselinePath -&gt; BaselinePath -&gt; Bool
&lt; :: BaselinePath -&gt; BaselinePath -&gt; Bool
$c&lt;= :: BaselinePath -&gt; BaselinePath -&gt; Bool
&lt;= :: BaselinePath -&gt; BaselinePath -&gt; Bool
$c&gt; :: BaselinePath -&gt; BaselinePath -&gt; Bool
&gt; :: BaselinePath -&gt; BaselinePath -&gt; Bool
$c&gt;= :: BaselinePath -&gt; BaselinePath -&gt; Bool
&gt;= :: BaselinePath -&gt; BaselinePath -&gt; Bool
$cmax :: BaselinePath -&gt; BaselinePath -&gt; BaselinePath
max :: BaselinePath -&gt; BaselinePath -&gt; BaselinePath
$cmin :: BaselinePath -&gt; BaselinePath -&gt; BaselinePath
min :: BaselinePath -&gt; BaselinePath -&gt; BaselinePath
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-456"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-457"></span><span>
</span><span id="line-458"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-459"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679234240"><span id="local-6989586621679234243"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#BaselinePath"><span class="hs-identifier hs-type">BaselinePath</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-460"></span><span>  </span><span id="local-6989586621679234245"><span class="annot"><span class="annottext">defaultValue :: Maybe BaselinePath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe BaselinePath
forall a. Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-461"></span><span>  </span><span id="local-6989586621679234246"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe (Maybe BaselinePath)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe BaselinePath -&gt; Maybe (Maybe BaselinePath)
forall a. a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe BaselinePath -&gt; Maybe (Maybe BaselinePath))
-&gt; (TestName -&gt; Maybe BaselinePath)
-&gt; TestName
-&gt; Maybe (Maybe BaselinePath)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">BaselinePath -&gt; Maybe BaselinePath
forall a. a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(BaselinePath -&gt; Maybe BaselinePath)
-&gt; (TestName -&gt; BaselinePath) -&gt; TestName -&gt; Maybe BaselinePath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; BaselinePath
</span><a href="Plutarch.Test.Bench.html#BaselinePath"><span class="hs-identifier hs-var">BaselinePath</span></a></span><span>
</span><span id="line-462"></span><span>  </span><span id="local-6989586621679234248"><span class="annot"><span class="annottext">optionName :: Tagged @Type (Maybe BaselinePath) TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type (Maybe BaselinePath) TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;baseline&quot;</span></span><span>
</span><span id="line-463"></span><span>  </span><span id="local-6989586621679234250"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type (Maybe BaselinePath) TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type (Maybe BaselinePath) TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;File with baseline results in CSV format to compare against&quot;</span></span><span>
</span><span id="line-464"></span><span>
</span><span id="line-465"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-466"></span><span class="hs-keyword">newtype</span><span> </span><span id="CsvPath"><span class="annot"><a href="Plutarch.Test.Bench.html#CsvPath"><span class="hs-identifier hs-var">CsvPath</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="CsvPath"><span class="annot"><a href="Plutarch.Test.Bench.html#CsvPath"><span class="hs-identifier hs-var">CsvPath</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.html#FilePath"><span class="hs-identifier hs-type">FilePath</span></a></span><span>
</span><span id="line-467"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span>
</span><span id="line-468"></span><span>    </span><span class="hs-special">(</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-469"></span><span>      </span><span id="local-6989586621679234252"><span id="local-6989586621679234255"><span class="annot"><span class="annottext">CsvPath -&gt; CsvPath -&gt; Bool
(CsvPath -&gt; CsvPath -&gt; Bool)
-&gt; (CsvPath -&gt; CsvPath -&gt; Bool) -&gt; Eq CsvPath
forall a. (a -&gt; a -&gt; Bool) -&gt; (a -&gt; a -&gt; Bool) -&gt; Eq a
$c== :: CsvPath -&gt; CsvPath -&gt; Bool
== :: CsvPath -&gt; CsvPath -&gt; Bool
$c/= :: CsvPath -&gt; CsvPath -&gt; Bool
/= :: CsvPath -&gt; CsvPath -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Eq"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Eq</span></a></span></span></span><span>
</span><span id="line-470"></span><span>    </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-471"></span><span>      </span><span id="local-6989586621679234261"><span id="local-6989586621679234264"><span id="local-6989586621679234267"><span id="local-6989586621679234271"><span id="local-6989586621679234274"><span id="local-6989586621679234277"><span id="local-6989586621679234280"><span class="annot"><span class="annottext">Eq CsvPath
Eq CsvPath =&gt;
(CsvPath -&gt; CsvPath -&gt; Ordering)
-&gt; (CsvPath -&gt; CsvPath -&gt; Bool)
-&gt; (CsvPath -&gt; CsvPath -&gt; Bool)
-&gt; (CsvPath -&gt; CsvPath -&gt; Bool)
-&gt; (CsvPath -&gt; CsvPath -&gt; Bool)
-&gt; (CsvPath -&gt; CsvPath -&gt; CsvPath)
-&gt; (CsvPath -&gt; CsvPath -&gt; CsvPath)
-&gt; Ord CsvPath
CsvPath -&gt; CsvPath -&gt; Bool
CsvPath -&gt; CsvPath -&gt; Ordering
CsvPath -&gt; CsvPath -&gt; CsvPath
forall a.
Eq a =&gt;
(a -&gt; a -&gt; Ordering)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; Bool)
-&gt; (a -&gt; a -&gt; a)
-&gt; (a -&gt; a -&gt; a)
-&gt; Ord a
$ccompare :: CsvPath -&gt; CsvPath -&gt; Ordering
compare :: CsvPath -&gt; CsvPath -&gt; Ordering
$c&lt; :: CsvPath -&gt; CsvPath -&gt; Bool
&lt; :: CsvPath -&gt; CsvPath -&gt; Bool
$c&lt;= :: CsvPath -&gt; CsvPath -&gt; Bool
&lt;= :: CsvPath -&gt; CsvPath -&gt; Bool
$c&gt; :: CsvPath -&gt; CsvPath -&gt; Bool
&gt; :: CsvPath -&gt; CsvPath -&gt; Bool
$c&gt;= :: CsvPath -&gt; CsvPath -&gt; Bool
&gt;= :: CsvPath -&gt; CsvPath -&gt; Bool
$cmax :: CsvPath -&gt; CsvPath -&gt; CsvPath
max :: CsvPath -&gt; CsvPath -&gt; CsvPath
$cmin :: CsvPath -&gt; CsvPath -&gt; CsvPath
min :: CsvPath -&gt; CsvPath -&gt; CsvPath
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Ord</span></a></span></span></span></span></span></span></span></span><span>
</span><span id="line-472"></span><span>    </span><span class="hs-special">)</span><span>
</span><span id="line-473"></span><span>
</span><span id="line-474"></span><span class="annot"><span class="hs-comment">-- | @since 1.0.0</span></span><span>
</span><span id="line-475"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679234291"><span id="local-6989586621679234294"><span class="annot"><span class="hs-identifier hs-type">IsOption</span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#CsvPath"><span class="hs-identifier hs-type">CsvPath</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-476"></span><span>  </span><span id="local-6989586621679234296"><span class="annot"><span class="annottext">defaultValue :: Maybe CsvPath
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">defaultValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CsvPath
forall a. Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-477"></span><span>  </span><span id="local-6989586621679234297"><span class="annot"><span class="annottext">parseValue :: TestName -&gt; Maybe (Maybe CsvPath)
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">parseValue</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe CsvPath -&gt; Maybe (Maybe CsvPath)
forall a. a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(Maybe CsvPath -&gt; Maybe (Maybe CsvPath))
-&gt; (TestName -&gt; Maybe CsvPath) -&gt; TestName -&gt; Maybe (Maybe CsvPath)
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">CsvPath -&gt; Maybe CsvPath
forall a. a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">(CsvPath -&gt; Maybe CsvPath)
-&gt; (TestName -&gt; CsvPath) -&gt; TestName -&gt; Maybe CsvPath
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; CsvPath
</span><a href="Plutarch.Test.Bench.html#CsvPath"><span class="hs-identifier hs-var">CsvPath</span></a></span><span>
</span><span id="line-478"></span><span>  </span><span id="local-6989586621679234299"><span class="annot"><span class="annottext">optionName :: Tagged @Type (Maybe CsvPath) TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionName</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type (Maybe CsvPath) TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;csv&quot;</span></span><span>
</span><span id="line-479"></span><span>  </span><span id="local-6989586621679234301"><span class="annot"><span class="annottext">optionHelp :: Tagged @Type (Maybe CsvPath) TestName
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">optionHelp</span></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Tagged @Type (Maybe CsvPath) TestName
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;File to write results in CSV format&quot;</span></span><span>
</span><span id="line-480"></span><span>
</span><span id="line-481"></span><span class="annot"><span class="hs-comment">-- * Internals</span></span><span>
</span><span id="line-482"></span><span>
</span><span id="line-483"></span><span class="hs-comment">-- Most of this code is from `tasty-bench`</span><span>
</span><span id="line-484"></span><span>
</span><span id="line-485"></span><span class="annot"><a href="Plutarch.Test.Bench.html#modifyConsoleReporter"><span class="hs-identifier hs-type">modifyConsoleReporter</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-486"></span><span>  </span><span class="hs-special">[</span><span class="annot"><span class="hs-identifier hs-type">OptionDescription</span></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-487"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">OptionSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-488"></span><span>  </span><span class="annot"><span class="hs-identifier hs-type">Ingredient</span></span><span>
</span><span id="line-489"></span><span id="modifyConsoleReporter"><span class="annot"><span class="annottext">modifyConsoleReporter :: [OptionDescription]
-&gt; (OptionSet
    -&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result))
-&gt; Ingredient
</span><a href="Plutarch.Test.Bench.html#modifyConsoleReporter"><span class="hs-identifier hs-var hs-var">modifyConsoleReporter</span></a></span></span><span> </span><span id="local-6989586621679234302"><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="#local-6989586621679234302"><span class="hs-identifier hs-var">desc'</span></a></span></span><span> </span><span id="local-6989586621679234303"><span class="annot"><span class="annottext">OptionSet
-&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
</span><a href="#local-6989586621679234303"><span class="hs-identifier hs-var">iof</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
-&gt; Ingredient
</span><span class="hs-identifier hs-var">TestReporter</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="#local-6989586621679234304"><span class="hs-identifier hs-var">desc</span></a></span><span> </span><span class="annot"><span class="annottext">[OptionDescription] -&gt; [OptionDescription] -&gt; [OptionDescription]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="#local-6989586621679234302"><span class="hs-identifier hs-var">desc'</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((OptionSet
  -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
 -&gt; Ingredient)
-&gt; (OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
-&gt; Ingredient
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span id="local-6989586621679234305"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234305"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span id="local-6989586621679234306"><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679234306"><span class="hs-identifier hs-var">tree</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-490"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234307"><span class="annot"><span class="annottext">nameSeqs :: IntMap (Seq TestName)
</span><a href="#local-6989586621679234307"><span class="hs-identifier hs-var hs-var">nameSeqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[(Key, Seq TestName)] -&gt; IntMap (Seq TestName)
forall a. [(Key, a)] -&gt; IntMap a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Strict.Internal.html#fromDistinctAscList"><span class="hs-identifier hs-var">IntMap.fromDistinctAscList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Key, Seq TestName)] -&gt; IntMap (Seq TestName))
-&gt; [(Key, Seq TestName)] -&gt; IntMap (Seq TestName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">[Key] -&gt; [Seq TestName] -&gt; [(Key, Seq TestName)]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
Item [Key]
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([Seq TestName] -&gt; [(Key, Seq TestName)])
-&gt; [Seq TestName] -&gt; [(Key, Seq TestName)]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; TestTree -&gt; [Seq TestName]
</span><a href="Plutarch.Test.Bench.html#testNameSeqs"><span class="hs-identifier hs-var">testNameSeqs</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234305"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679234306"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-491"></span><span>      </span><span id="local-6989586621679234309"><span class="annot"><span class="annottext">namesAndDeps :: IntMap (TestName, Unique (WithLoHi Key))
</span><a href="#local-6989586621679234309"><span class="hs-identifier hs-var hs-var">namesAndDeps</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-492"></span><span>        </span><span class="annot"><span class="annottext">[(Key, (TestName, Unique (WithLoHi Key)))]
-&gt; IntMap (TestName, Unique (WithLoHi Key))
forall a. [(Key, a)] -&gt; IntMap a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Strict.Internal.html#fromDistinctAscList"><span class="hs-identifier hs-var">IntMap.fromDistinctAscList</span></a></span><span> </span><span class="annot"><span class="annottext">([(Key, (TestName, Unique (WithLoHi Key)))]
 -&gt; IntMap (TestName, Unique (WithLoHi Key)))
-&gt; [(Key, (TestName, Unique (WithLoHi Key)))]
-&gt; IntMap (TestName, Unique (WithLoHi Key))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-493"></span><span>          </span><span class="annot"><span class="annottext">[Key]
-&gt; [(TestName, Unique (WithLoHi Key))]
-&gt; [(Key, (TestName, Unique (WithLoHi Key)))]
forall a b. [a] -&gt; [b] -&gt; [(a, b)]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zip"><span class="hs-identifier hs-var">zip</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
Item [Key]
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span> </span><span class="annot"><span class="annottext">([(TestName, Unique (WithLoHi Key))]
 -&gt; [(Key, (TestName, Unique (WithLoHi Key)))])
-&gt; [(TestName, Unique (WithLoHi Key))]
-&gt; [(Key, (TestName, Unique (WithLoHi Key)))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-494"></span><span>            </span><span class="annot"><span class="annottext">IntMap (Seq TestName)
-&gt; OptionSet -&gt; TestTree -&gt; [(TestName, Unique (WithLoHi Key))]
</span><a href="Plutarch.Test.Bench.html#testNamesAndDeps"><span class="hs-identifier hs-var">testNamesAndDeps</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Seq TestName)
</span><a href="#local-6989586621679234307"><span class="hs-identifier hs-var">nameSeqs</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234305"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679234306"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-495"></span><span>      </span><span id="local-6989586621679234311"><span class="annot"><span class="annottext">modifySMap :: StatusMap -&gt; IO StatusMap
</span><a href="#local-6989586621679234311"><span class="hs-identifier hs-var hs-var">modifySMap</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-496"></span><span>        </span><span class="hs-special">(</span><span class="annot"><span class="annottext">OptionSet
-&gt; IO (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
</span><a href="#local-6989586621679234303"><span class="hs-identifier hs-var">iof</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234305"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="hs-operator">&gt;&gt;=</span><span class="hs-special">)</span><span>
</span><span id="line-497"></span><span>          </span><span class="annot"><span class="annottext">(((TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
  -&gt; IO StatusMap)
 -&gt; IO StatusMap)
-&gt; (StatusMap
    -&gt; (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
    -&gt; IO StatusMap)
-&gt; StatusMap
-&gt; IO StatusMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
 -&gt; IntMap (TestName, Unique (WithLoHi Key), TVar Status)
 -&gt; IO StatusMap)
-&gt; IntMap (TestName, Unique (WithLoHi Key), TVar Status)
-&gt; (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
-&gt; IO StatusMap
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
-&gt; IntMap (TestName, Unique (WithLoHi Key), TVar Status)
-&gt; IO StatusMap
</span><a href="Plutarch.Test.Bench.html#postprocessResult"><span class="hs-identifier hs-var">postprocessResult</span></a></span><span>
</span><span id="line-498"></span><span>          </span><span class="annot"><span class="annottext">(IntMap (TestName, Unique (WithLoHi Key), TVar Status)
 -&gt; (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
 -&gt; IO StatusMap)
-&gt; (StatusMap
    -&gt; IntMap (TestName, Unique (WithLoHi Key), TVar Status))
-&gt; StatusMap
-&gt; (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
-&gt; IO StatusMap
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">((TestName, Unique (WithLoHi Key))
 -&gt; TVar Status -&gt; (TestName, Unique (WithLoHi Key), TVar Status))
-&gt; IntMap (TestName, Unique (WithLoHi Key))
-&gt; StatusMap
-&gt; IntMap (TestName, Unique (WithLoHi Key), TVar Status)
forall a b c. (a -&gt; b -&gt; c) -&gt; IntMap a -&gt; IntMap b -&gt; IntMap c
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Strict.Internal.html#intersectionWith"><span class="hs-identifier hs-var">IntMap.intersectionWith</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679234314"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234314"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234315"><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="#local-6989586621679234315"><span class="hs-identifier hs-var">b</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679234316"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234316"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234314"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="#local-6989586621679234315"><span class="hs-identifier hs-var">b</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234316"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key))
</span><a href="#local-6989586621679234309"><span class="hs-identifier hs-var">namesAndDeps</span></a></span><span>
</span><span id="line-499"></span><span>   </span><span class="hs-keyword">in</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">StatusMap -&gt; IO StatusMap
</span><a href="#local-6989586621679234311"><span class="hs-identifier hs-var">modifySMap</span></a></span><span> </span><span class="hs-operator">&gt;=&gt;</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">((StatusMap -&gt; IO (Double -&gt; IO Bool))
 -&gt; StatusMap -&gt; IO (Double -&gt; IO Bool))
-&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
-&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
-&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
</span><a href="#local-6989586621679234317"><span class="hs-identifier hs-var">cb</span></a></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234305"><span class="hs-identifier hs-var">opts</span></a></span><span> </span><span class="annot"><span class="annottext">TestTree
</span><a href="#local-6989586621679234306"><span class="hs-identifier hs-var">tree</span></a></span><span>
</span><span id="line-500"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-501"></span><span>    </span><span class="hs-special">(</span><span id="local-6989586621679234304"><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="#local-6989586621679234304"><span class="hs-identifier hs-var">desc</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234317"><span class="annot"><span class="annottext">OptionSet
-&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
</span><a href="#local-6989586621679234317"><span class="hs-identifier hs-var">cb</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Ingredient
</span><span class="hs-identifier hs-var">consoleTestReporter</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-502"></span><span>      </span><span class="annot"><span class="hs-identifier hs-type">TestReporter</span></span><span> </span><span id="local-6989586621679234322"><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="#local-6989586621679234322"><span class="hs-identifier hs-var">d</span></a></span></span><span> </span><span id="local-6989586621679234323"><span class="annot"><span class="annottext">OptionSet
-&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
</span><a href="#local-6989586621679234323"><span class="hs-identifier hs-var">c</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[OptionDescription]
</span><a href="#local-6989586621679234322"><span class="hs-identifier hs-var">d</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">OptionSet
-&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool))
</span><a href="#local-6989586621679234323"><span class="hs-identifier hs-var">c</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-503"></span><span>      </span><span class="annot"><span class="annottext">Ingredient
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
-&gt; ([OptionDescription],
    OptionSet
    -&gt; TestTree -&gt; Maybe (StatusMap -&gt; IO (Double -&gt; IO Bool)))
forall a. HasCallStack =&gt; TestName -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Err.html#error"><span class="hs-identifier hs-var">error</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;modifyConsoleReporter: consoleTestReporter must be TestReporter&quot;</span></span><span>
</span><span id="line-504"></span><span>
</span><span id="line-505"></span><span class="hs-keyword">data</span><span> </span><span id="ExecutionBudget"><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-var">ExecutionBudget</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="ExecutionBudget"><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-var">ExecutionBudget</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-506"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234325"><span id="local-6989586621679234331"><span id="local-6989586621679234335"><span class="annot"><span class="annottext">Key -&gt; ExecutionBudget -&gt; TestName -&gt; TestName
[ExecutionBudget] -&gt; TestName -&gt; TestName
ExecutionBudget -&gt; TestName
(Key -&gt; ExecutionBudget -&gt; TestName -&gt; TestName)
-&gt; (ExecutionBudget -&gt; TestName)
-&gt; ([ExecutionBudget] -&gt; TestName -&gt; TestName)
-&gt; Show ExecutionBudget
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: Key -&gt; ExecutionBudget -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; ExecutionBudget -&gt; TestName -&gt; TestName
$cshow :: ExecutionBudget -&gt; TestName
show :: ExecutionBudget -&gt; TestName
$cshowList :: [ExecutionBudget] -&gt; TestName -&gt; TestName
showList :: [ExecutionBudget] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234338"><span id="local-6989586621679234341"><span id="local-6989586621679234344"><span id="local-6989586621679234354"><span class="annot"><span class="annottext">ReadPrec [ExecutionBudget]
ReadPrec ExecutionBudget
Key -&gt; ReadS ExecutionBudget
ReadS [ExecutionBudget]
(Key -&gt; ReadS ExecutionBudget)
-&gt; ReadS [ExecutionBudget]
-&gt; ReadPrec ExecutionBudget
-&gt; ReadPrec [ExecutionBudget]
-&gt; Read ExecutionBudget
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: Key -&gt; ReadS ExecutionBudget
readsPrec :: Key -&gt; ReadS ExecutionBudget
$creadList :: ReadS [ExecutionBudget]
readList :: ReadS [ExecutionBudget]
$creadPrec :: ReadPrec ExecutionBudget
readPrec :: ReadPrec ExecutionBudget
$creadListPrec :: ReadPrec [ExecutionBudget]
readListPrec :: ReadPrec [ExecutionBudget]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-507"></span><span>
</span><span id="line-508"></span><span class="hs-keyword">data</span><span> </span><span id="WithLoHi"><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-var">WithLoHi</span></a></span></span><span> </span><span id="local-6989586621679232582"><span class="annot"><a href="#local-6989586621679232582"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-509"></span><span>  </span><span class="hs-glyph">=</span><span> </span><span id="WithLoHi"><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-var">WithLoHi</span></a></span></span><span>
</span><span id="line-510"></span><span>      </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679232582"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-comment">-- payload</span><span>
</span><span id="line-511"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- cpu</span><span>
</span><span id="line-512"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- mem</span><span>
</span><span id="line-513"></span><span>      </span><span class="hs-glyph">!</span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-comment">-- size</span><span>
</span><span id="line-514"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234358"><span id="local-6989586621679234368"><span id="local-6989586621679234371"><span class="annot"><span class="annottext">Key -&gt; WithLoHi a -&gt; TestName -&gt; TestName
[WithLoHi a] -&gt; TestName -&gt; TestName
WithLoHi a -&gt; TestName
(Key -&gt; WithLoHi a -&gt; TestName -&gt; TestName)
-&gt; (WithLoHi a -&gt; TestName)
-&gt; ([WithLoHi a] -&gt; TestName -&gt; TestName)
-&gt; Show (WithLoHi a)
forall a. Show a =&gt; Key -&gt; WithLoHi a -&gt; TestName -&gt; TestName
forall a. Show a =&gt; [WithLoHi a] -&gt; TestName -&gt; TestName
forall a. Show a =&gt; WithLoHi a -&gt; TestName
forall a.
(Key -&gt; a -&gt; TestName -&gt; TestName)
-&gt; (a -&gt; TestName) -&gt; ([a] -&gt; TestName -&gt; TestName) -&gt; Show a
$cshowsPrec :: forall a. Show a =&gt; Key -&gt; WithLoHi a -&gt; TestName -&gt; TestName
showsPrec :: Key -&gt; WithLoHi a -&gt; TestName -&gt; TestName
$cshow :: forall a. Show a =&gt; WithLoHi a -&gt; TestName
show :: WithLoHi a -&gt; TestName
$cshowList :: forall a. Show a =&gt; [WithLoHi a] -&gt; TestName -&gt; TestName
showList :: [WithLoHi a] -&gt; TestName -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#Show"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Show</span></a></span></span></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234375"><span id="local-6989586621679234378"><span id="local-6989586621679234381"><span id="local-6989586621679234394"><span class="annot"><span class="annottext">ReadPrec [WithLoHi a]
ReadPrec (WithLoHi a)
Key -&gt; ReadS (WithLoHi a)
ReadS [WithLoHi a]
(Key -&gt; ReadS (WithLoHi a))
-&gt; ReadS [WithLoHi a]
-&gt; ReadPrec (WithLoHi a)
-&gt; ReadPrec [WithLoHi a]
-&gt; Read (WithLoHi a)
forall a. Read a =&gt; ReadPrec [WithLoHi a]
forall a. Read a =&gt; ReadPrec (WithLoHi a)
forall a. Read a =&gt; Key -&gt; ReadS (WithLoHi a)
forall a. Read a =&gt; ReadS [WithLoHi a]
forall a.
(Key -&gt; ReadS a)
-&gt; ReadS [a] -&gt; ReadPrec a -&gt; ReadPrec [a] -&gt; Read a
$creadsPrec :: forall a. Read a =&gt; Key -&gt; ReadS (WithLoHi a)
readsPrec :: Key -&gt; ReadS (WithLoHi a)
$creadList :: forall a. Read a =&gt; ReadS [WithLoHi a]
readList :: ReadS [WithLoHi a]
$creadPrec :: forall a. Read a =&gt; ReadPrec (WithLoHi a)
readPrec :: ReadPrec (WithLoHi a)
$creadListPrec :: forall a. Read a =&gt; ReadPrec [WithLoHi a]
readListPrec :: ReadPrec [WithLoHi a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Read.html#Read"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var hs-var">Read</span></a></span></span></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-515"></span><span>
</span><span id="line-516"></span><span class="hs-keyword">data</span><span> </span><span id="PBenchmarkable"><span class="annot"><a href="Plutarch.Test.Bench.html#PBenchmarkable"><span class="hs-identifier hs-var">PBenchmarkable</span></a></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-517"></span><span>  </span><span id="local-6989586621679234396"><span id="PBenchmarkable"><span class="annot"><a href="Plutarch.Test.Bench.html#PBenchmarkable"><span class="hs-identifier hs-var">PBenchmarkable</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#BenchConfig"><span class="hs-identifier hs-type">BenchConfig</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ClosedTerm</span></span><span> </span><span class="annot"><a href="#local-6989586621679234396"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#PBenchmarkable"><span class="hs-identifier hs-type">PBenchmarkable</span></a></span></span><span>
</span><span id="line-518"></span><span>
</span><span id="line-519"></span><span class="hs-keyword">instance</span><span> </span><span class="annot"><span class="hs-identifier hs-type">IsTest</span></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#PBenchmarkable"><span class="hs-identifier hs-type">PBenchmarkable</span></a></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-520"></span><span>  </span><span id="local-6989586621679234409"><span class="annot"><span class="annottext">testOptions :: Tagged @Type PBenchmarkable [OptionDescription]
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">testOptions</span></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-521"></span><span>    </span><span class="annot"><span class="annottext">[OptionDescription]
-&gt; Tagged @Type PBenchmarkable [OptionDescription]
forall {k} (s :: k) b. b -&gt; Tagged @k s b
</span><span class="hs-identifier hs-var">Tagged</span></span><span>
</span><span id="line-522"></span><span>      </span><span class="hs-special">[</span><span> </span><span class="annot"><span class="annottext">Proxy @Type FailIfMoreCpu -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type FailIfMoreCpu
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier hs-type">FailIfMoreCpu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-523"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy @Type FailIfLessCpu -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type FailIfLessCpu
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier hs-type">FailIfLessCpu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-524"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy @Type FailIfMoreMem -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type FailIfMoreMem
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier hs-type">FailIfMoreMem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-525"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy @Type FailIfLessMem -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type FailIfLessMem
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier hs-type">FailIfLessMem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-526"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy @Type FailIfBigger -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type FailIfBigger
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier hs-type">FailIfBigger</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-527"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Proxy @Type FailIfSmaller -&gt; OptionDescription
forall v. IsOption v =&gt; Proxy @Type v -&gt; OptionDescription
</span><span class="hs-identifier hs-var">Option</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Proxy @Type FailIfSmaller
forall {k} (t :: k). Proxy @k t
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-var">Proxy</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Proxy.html#Proxy"><span class="hs-identifier hs-type">Proxy</span></a></span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier hs-type">FailIfSmaller</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-528"></span><span>      </span><span class="hs-special">]</span><span>
</span><span id="line-529"></span><span>  </span><span id="local-6989586621679234410"><span class="annot"><span class="annottext">run :: OptionSet -&gt; PBenchmarkable -&gt; (Progress -&gt; IO ()) -&gt; IO Result
</span><span class="hs-identifier hs-var hs-var hs-var hs-var">run</span></span></span><span> </span><span id="local-6989586621679234411"><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">opts</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#PBenchmarkable"><span class="hs-identifier hs-type">PBenchmarkable</span></a></span><span> </span><span id="local-6989586621679234543"><span class="annot"><span class="annottext">BenchConfig
</span><a href="#local-6989586621679234543"><span class="hs-identifier hs-var">config</span></a></span></span><span> </span><span id="local-6989586621679234544"><span class="annot"><span class="annottext">ClosedTerm a
</span><a href="#local-6989586621679234544"><span class="hs-identifier hs-var">term</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679234545"><span class="annot"><span class="annottext">Progress -&gt; IO ()
</span><a href="#local-6989586621679234545"><span class="hs-identifier hs-var">_progress</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-530"></span><span>    </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Either Text Script
</span><a href="#local-6989586621679234546"><span class="hs-identifier hs-var">compiled</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-531"></span><span>      </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679234547"><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679234547"><span class="hs-identifier hs-var">err</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO Result
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; IO Result) -&gt; Result -&gt; IO Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Result
</span><span class="hs-identifier hs-var">testFailed</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Result) -&gt; TestName -&gt; Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to compile term: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Text -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/text-2.0.2/src/Data.Text.Show.html#unpack"><span class="hs-identifier hs-var">Text.unpack</span></a></span><span> </span><span class="annot"><span class="annottext">Text
</span><a href="#local-6989586621679234547"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-532"></span><span>      </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span id="local-6989586621679234549"><span class="annot"><span class="annottext">Script
</span><a href="#local-6989586621679234549"><span class="hs-identifier hs-var">script</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-533"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Script
-&gt; (Either
      (CekEvaluationException NamedDeBruijn DefaultUni DefaultFun)
      Script,
    ExBudget, [Text])
</span><span class="hs-identifier hs-var">evalScriptUnlimited</span></span><span> </span><span class="annot"><span class="annottext">Script
</span><a href="#local-6989586621679234549"><span class="hs-identifier hs-var">script</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-534"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Left"><span class="hs-identifier hs-type">Left</span></a></span><span> </span><span id="local-6989586621679234550"><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
</span><a href="#local-6989586621679234550"><span class="hs-identifier hs-var">err</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">ExBudget
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; IO Result
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; IO Result) -&gt; Result -&gt; IO Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Result
</span><span class="hs-identifier hs-var">testFailed</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Result) -&gt; TestName -&gt; Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;Failed to evaluate term: &quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
-&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">CekEvaluationException NamedDeBruijn DefaultUni DefaultFun
</span><a href="#local-6989586621679234550"><span class="hs-identifier hs-var">err</span></a></span><span>
</span><span id="line-535"></span><span>          </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-type">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Script
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-type">ExBudget</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExCPU</span></span><span> </span><span id="local-6989586621679234551"><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621679234551"><span class="hs-identifier hs-var">cpu</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">ExMemory</span></span><span> </span><span id="local-6989586621679234552"><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621679234552"><span class="hs-identifier hs-var">mem</span></a></span></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">[Text]
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-536"></span><span>            </span><span class="annot"><span class="annottext">Result -&gt; IO Result
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Result -&gt; IO Result) -&gt; Result -&gt; IO Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-537"></span><span>              </span><span class="annot"><span class="annottext">TestName -&gt; Result
</span><span class="hs-identifier hs-var">testPassed</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Result) -&gt; TestName -&gt; Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-538"></span><span>                </span><span class="annot"><span class="annottext">WithLoHi ExecutionBudget -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">(WithLoHi ExecutionBudget -&gt; TestName)
-&gt; WithLoHi ExecutionBudget -&gt; TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-539"></span><span>                  </span><span class="annot"><span class="annottext">ExecutionBudget
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi ExecutionBudget
forall a.
a
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi a
</span><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-var">WithLoHi</span></a></span><span>
</span><span id="line-540"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Integer -&gt; Integer -&gt; ExecutionBudget
</span><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-var">ExecutionBudget</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CostingInteger -&gt; Integer
forall a. Num a =&gt; CostingInteger -&gt; a
</span><span class="hs-identifier hs-var">fromSatInt</span></span><span> </span><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621679234551"><span class="hs-identifier hs-var">cpu</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">CostingInteger -&gt; Integer
forall a. Num a =&gt; CostingInteger -&gt; a
</span><span class="hs-identifier hs-var">fromSatInt</span></span><span> </span><span class="annot"><span class="annottext">CostingInteger
</span><a href="#local-6989586621679234552"><span class="hs-identifier hs-var">mem</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Script -&gt; Integer
</span><a href="Plutarch.Test.Bench.html#scriptSize"><span class="hs-identifier hs-var">scriptSize</span></a></span><span> </span><span class="annot"><span class="annottext">Script
</span><a href="#local-6989586621679234549"><span class="hs-identifier hs-var">script</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-541"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-operator hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234554"><span class="hs-identifier hs-var">ifLessCpu</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234556"><span class="hs-identifier hs-var">ifMoreCpu</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-542"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-operator hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234557"><span class="hs-identifier hs-var">ifLessMem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234558"><span class="hs-identifier hs-var">ifMoreMem</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-543"></span><span>                    </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-operator hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234559"><span class="hs-identifier hs-var">ifSmaller</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2B"><span class="hs-operator hs-var">+</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234560"><span class="hs-identifier hs-var">ifBigger</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-544"></span><span>    </span><span class="hs-keyword">where</span><span>
</span><span id="line-545"></span><span>      </span><span id="local-6989586621679234546"><span class="annot"><span class="annottext">compiled :: Either Text Script
</span><a href="#local-6989586621679234546"><span class="hs-identifier hs-var hs-var">compiled</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-546"></span><span>        </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">BenchConfig
</span><a href="#local-6989586621679234543"><span class="hs-identifier hs-var">config</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-547"></span><span>          </span><span class="annot"><span class="annottext">BenchConfig
</span><a href="Plutarch.Test.Bench.html#Optimizing"><span class="hs-identifier hs-var">Optimizing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">ClosedTerm a -&gt; Either Text Script
forall (a :: PType).
(forall (s :: S). Term s a) -&gt; Either Text Script
</span><span class="hs-identifier hs-var">compileOptimized</span></span><span> </span><span class="annot"><span class="annottext">Term s a
ClosedTerm a
</span><a href="#local-6989586621679234544"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-548"></span><span>          </span><span class="annot"><a href="Plutarch.Test.Bench.html#NonOptimizing"><span class="hs-identifier hs-type">NonOptimizing</span></a></span><span> </span><span id="local-6989586621679234561"><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679234561"><span class="hs-identifier hs-var">pconfig</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Config -&gt; ClosedTerm a -&gt; Either Text Script
forall (a :: PType). Config -&gt; ClosedTerm a -&gt; Either Text Script
</span><span class="hs-identifier hs-var">compile</span></span><span> </span><span class="annot"><span class="annottext">Config
</span><a href="#local-6989586621679234561"><span class="hs-identifier hs-var">pconfig</span></a></span><span> </span><span class="annot"><span class="annottext">Term s a
ClosedTerm a
</span><a href="#local-6989586621679234544"><span class="hs-identifier hs-var">term</span></a></span><span>
</span><span id="line-549"></span><span>
</span><span id="line-550"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessCpu"><span class="hs-identifier hs-type">FailIfLessCpu</span></a></span><span> </span><span id="local-6989586621679234554"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234554"><span class="hs-identifier hs-var">ifLessCpu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; FailIfLessCpu
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-551"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreCpu"><span class="hs-identifier hs-type">FailIfMoreCpu</span></a></span><span> </span><span id="local-6989586621679234556"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234556"><span class="hs-identifier hs-var">ifMoreCpu</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; FailIfMoreCpu
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-552"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfLessMem"><span class="hs-identifier hs-type">FailIfLessMem</span></a></span><span> </span><span id="local-6989586621679234557"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234557"><span class="hs-identifier hs-var">ifLessMem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; FailIfLessMem
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-553"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfMoreMem"><span class="hs-identifier hs-type">FailIfMoreMem</span></a></span><span> </span><span id="local-6989586621679234558"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234558"><span class="hs-identifier hs-var">ifMoreMem</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; FailIfMoreMem
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-554"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfBigger"><span class="hs-identifier hs-type">FailIfBigger</span></a></span><span> </span><span id="local-6989586621679234560"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234560"><span class="hs-identifier hs-var">ifBigger</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; FailIfBigger
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-555"></span><span>      </span><span class="annot"><a href="Plutarch.Test.Bench.html#FailIfSmaller"><span class="hs-identifier hs-type">FailIfSmaller</span></a></span><span> </span><span id="local-6989586621679234559"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234559"><span class="hs-identifier hs-var">ifSmaller</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">OptionSet -&gt; FailIfSmaller
forall v. IsOption v =&gt; OptionSet -&gt; v
</span><span class="hs-identifier hs-var">lookupOption</span></span><span> </span><span class="annot"><span class="annottext">OptionSet
</span><a href="#local-6989586621679234411"><span class="hs-identifier hs-var">opts</span></a></span><span>
</span><span id="line-556"></span><span>
</span><span id="line-557"></span><span class="hs-keyword">data</span><span> </span><span id="Unique"><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-var">Unique</span></a></span></span><span> </span><span id="local-6989586621679232783"><span class="annot"><a href="#local-6989586621679232783"><span class="hs-identifier hs-type">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span id="None"><span class="annot"><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="Unique"><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-var">Unique</span></a></span></span><span> </span><span class="hs-glyph">!</span><span class="annot"><a href="#local-6989586621679232783"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NotUnique"><span class="annot"><a href="Plutarch.Test.Bench.html#NotUnique"><span class="hs-identifier hs-var">NotUnique</span></a></span></span><span> </span><span class="hs-glyph">|</span><span> </span><span id="NotProvided"><span class="annot"><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span></span><span>
</span><span id="line-558"></span><span>  </span><span class="hs-keyword">deriving</span><span> </span><span class="annot"><span class="hs-keyword">stock</span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234563"><span id="local-6989586621679234565"><span class="annot"><span class="annottext">(forall a b. (a -&gt; b) -&gt; Unique a -&gt; Unique b)
-&gt; (forall a b. a -&gt; Unique b -&gt; Unique a) -&gt; Functor Unique
forall a b. a -&gt; Unique b -&gt; Unique a
forall a b. (a -&gt; b) -&gt; Unique a -&gt; Unique b
forall (f :: Type -&gt; Type).
(forall a b. (a -&gt; b) -&gt; f a -&gt; f b)
-&gt; (forall a b. a -&gt; f b -&gt; f a) -&gt; Functor f
$cfmap :: forall a b. (a -&gt; b) -&gt; Unique a -&gt; Unique b
fmap :: forall a b. (a -&gt; b) -&gt; Unique a -&gt; Unique b
$c&lt;$ :: forall a b. a -&gt; Unique b -&gt; Unique a
&lt;$ :: forall a b. a -&gt; Unique b -&gt; Unique a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Functor"><span class="hs-identifier hs-var hs-var hs-var hs-var hs-var hs-var">Functor</span></a></span></span></span><span class="hs-special">)</span><span>
</span><span id="line-559"></span><span>
</span><span id="line-560"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679232782"><span id="local-6989586621679234570"><span id="local-6989586621679234574"><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Semigroup"><span class="hs-identifier hs-type">Semigroup</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232782"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-561"></span><span>  </span><span id="local-6989586621679234579"><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234579"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span id="local-6989586621679234580"><span class="annot"><span class="annottext">&lt;&gt; :: Unique a -&gt; Unique a -&gt; Unique a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var hs-var hs-var hs-var">&lt;&gt;</span></a></span></span><span> </span><span class="annot"><span class="annottext">Unique a
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234579"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-562"></span><span>  </span><span class="annot"><span class="annottext">Unique a
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span id="local-6989586621679234581"><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234581"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234581"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-563"></span><span>  </span><span id="local-6989586621679234582"><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234582"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Unique a
</span><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234582"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-564"></span><span>  </span><span class="annot"><span class="annottext">Unique a
</span><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span id="local-6989586621679234583"><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234583"><span class="hs-identifier hs-var">a</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique a
</span><a href="#local-6989586621679234583"><span class="hs-identifier hs-var">a</span></a></span><span>
</span><span id="line-565"></span><span>  </span><span class="annot"><span class="annottext">Unique a
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">&lt;&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Unique a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique a
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#NotUnique"><span class="hs-identifier hs-var">NotUnique</span></a></span><span>
</span><span id="line-566"></span><span>
</span><span id="line-567"></span><span class="hs-keyword">instance</span><span> </span><span id="local-6989586621679232553"><span id="local-6989586621679234589"><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#Monoid"><span class="hs-identifier hs-type">Monoid</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232553"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">)</span></span></span><span> </span><span class="hs-keyword">where</span><span>
</span><span id="line-568"></span><span>  </span><span id="local-6989586621679234592"><span class="annot"><span class="annottext">mempty :: Unique a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mempty"><span class="hs-identifier hs-var hs-var hs-var hs-var">mempty</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique a
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span>
</span><span id="line-569"></span><span>  </span><span id="local-6989586621679234594"><span class="annot"><span class="annottext">mappend :: Unique a -&gt; Unique a -&gt; Unique a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mappend"><span class="hs-identifier hs-var hs-var hs-var hs-var">mappend</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Unique a -&gt; Unique a -&gt; Unique a
forall a. Semigroup a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%3E"><span class="hs-operator hs-var">(&lt;&gt;)</span></a></span><span>
</span><span id="line-570"></span><span>
</span><span id="line-571"></span><span class="annot"><span class="hs-comment">-- | Convert a test tree to a list of test names.</span></span><span>
</span><span id="line-572"></span><span class="annot"><a href="Plutarch.Test.Bench.html#testNameSeqs"><span class="hs-identifier hs-type">testNameSeqs</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OptionSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span class="hs-special">]</span><span>
</span><span id="line-573"></span><span id="testNameSeqs"><span class="annot"><span class="annottext">testNameSeqs :: OptionSet -&gt; TestTree -&gt; [Seq TestName]
</span><a href="Plutarch.Test.Bench.html#testNameSeqs"><span class="hs-identifier hs-var hs-var">testNameSeqs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-574"></span><span>  </span><span class="annot"><span class="annottext">TreeFold [Seq TestName] -&gt; OptionSet -&gt; TestTree -&gt; [Seq TestName]
forall b. Monoid b =&gt; TreeFold b -&gt; OptionSet -&gt; TestTree -&gt; b
</span><span class="hs-identifier hs-var">foldTestTree</span></span><span>
</span><span id="line-575"></span><span>    </span><span class="annot"><span class="annottext">TreeFold [Seq TestName]
forall b. Monoid b =&gt; TreeFold b
</span><span class="hs-identifier hs-var">trivialFold</span></span><span>
</span><span id="line-576"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">foldSingle</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-glyph">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#singleton"><span class="hs-identifier hs-type">Seq.singleton</span></a></span><span>
</span><span id="line-577"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">foldGroup</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">.</span></span><span> </span><span class="annot"><span class="hs-identifier">concat</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#%3C%7C"><span class="hs-operator hs-type">(&lt;|)</span></a></span><span>
</span><span id="line-578"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-579"></span><span>
</span><span id="line-580"></span><span class="annot"><a href="Plutarch.Test.Bench.html#testNamesAndDeps"><span class="hs-identifier hs-type">testNamesAndDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">OptionSet</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestTree</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">IntMap.Key</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span>
</span><span id="line-581"></span><span id="testNamesAndDeps"><span class="annot"><span class="annottext">testNamesAndDeps :: IntMap (Seq TestName)
-&gt; OptionSet -&gt; TestTree -&gt; [(TestName, Unique (WithLoHi Key))]
</span><a href="Plutarch.Test.Bench.html#testNamesAndDeps"><span class="hs-identifier hs-var hs-var">testNamesAndDeps</span></a></span></span><span> </span><span id="local-6989586621679234597"><span class="annot"><span class="annottext">IntMap (Seq TestName)
</span><a href="#local-6989586621679234597"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-582"></span><span>  </span><span class="annot"><span class="annottext">TreeFold [(TestName, Unique (WithLoHi Key))]
-&gt; OptionSet -&gt; TestTree -&gt; [(TestName, Unique (WithLoHi Key))]
forall b. Monoid b =&gt; TreeFold b -&gt; OptionSet -&gt; TestTree -&gt; b
</span><span class="hs-identifier hs-var">foldTestTree</span></span><span>
</span><span id="line-583"></span><span>    </span><span class="annot"><span class="annottext">TreeFold [(TestName, Unique (WithLoHi Key))]
forall b. Monoid b =&gt; TreeFold b
</span><span class="hs-identifier hs-var">trivialFold</span></span><span>
</span><span id="line-584"></span><span>      </span><span class="hs-special">{</span><span> </span><span class="annot"><span class="hs-identifier hs-var">foldSingle</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-glyph">:</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="annot"><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-type">NotProvided</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-585"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">foldGroup</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-type">$</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">.</span></span><span> </span><span class="annot"><span class="hs-identifier">concat</span></span><span class="hs-special">)</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-type">map</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Bifunctor.html#first"><span class="hs-identifier hs-type">first</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-type">(++)</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-type">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-operator">++</span></span><span> </span><span class="annot"><span class="hs-string">&quot;.&quot;</span></span><span class="hs-special">)</span><span>
</span><span id="line-586"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">foldAfter</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-type">const</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679234598"><span class="hs-identifier hs-type">foldDeps</span></a></span><span>
</span><span id="line-587"></span><span>      </span><span class="hs-special">}</span><span>
</span><span id="line-588"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-589"></span><span>    </span><span id="local-6989586621679232799"><span class="annot"><a href="#local-6989586621679234598"><span class="hs-identifier hs-type">foldDeps</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">DependencyType</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Expr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679232799"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">IntMap.Key</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">(</span><span class="annot"><a href="#local-6989586621679232799"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">IntMap.Key</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span class="hs-special">]</span></span><span>
</span><span id="line-590"></span><span>    </span><span id="local-6989586621679234598"><span class="annot"><span class="annottext">foldDeps :: forall a.
DependencyType
-&gt; Expr
-&gt; [(a, Unique (WithLoHi Key))]
-&gt; [(a, Unique (WithLoHi Key))]
</span><a href="#local-6989586621679234598"><span class="hs-identifier hs-var hs-var">foldDeps</span></a></span></span><span> </span><span class="annot"><span class="annottext">DependencyType
</span><span class="hs-identifier hs-var">AllSucceed</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">And</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">StringLit</span></span><span> </span><span id="local-6989586621679234608"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234608"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span> </span><span id="local-6989586621679234609"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679234609"><span class="hs-identifier hs-var">p</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-591"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="Plutarch.Test.Bench.html#pbcomparePrefix"><span class="hs-identifier hs-var">pbcomparePrefix</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; Bool
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#isPrefixOf"><span class="hs-operator hs-var">`isPrefixOf`</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234608"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-592"></span><span>      </span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span> </span><span id="local-6989586621679234610"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234610"><span class="hs-identifier hs-var">cpu</span></a></span></span><span> </span><span id="local-6989586621679234611"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234611"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621679234612"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234612"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe (WithLoHi ())
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Maybe (WithLoHi ()))
-&gt; TestName -&gt; Maybe (WithLoHi ())
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; TestName -&gt; TestName
forall a. Key -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#drop"><span class="hs-identifier hs-var">drop</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; Key
forall a. [a] -&gt; Key
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Key
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="Plutarch.Test.Bench.html#pbcomparePrefix"><span class="hs-identifier hs-var">pbcomparePrefix</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234608"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-593"></span><span>          </span><span class="annot"><span class="annottext">((a, Unique (WithLoHi Key)) -&gt; (a, Unique (WithLoHi Key)))
-&gt; [(a, Unique (WithLoHi Key))] -&gt; [(a, Unique (WithLoHi Key))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="annot"><span class="annottext">(((a, Unique (WithLoHi Key)) -&gt; (a, Unique (WithLoHi Key)))
 -&gt; [(a, Unique (WithLoHi Key))] -&gt; [(a, Unique (WithLoHi Key))])
-&gt; ((a, Unique (WithLoHi Key)) -&gt; (a, Unique (WithLoHi Key)))
-&gt; [(a, Unique (WithLoHi Key))]
-&gt; [(a, Unique (WithLoHi Key))]
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique (WithLoHi Key) -&gt; Unique (WithLoHi Key))
-&gt; (a, Unique (WithLoHi Key)) -&gt; (a, Unique (WithLoHi Key))
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: Type -&gt; Type -&gt; Type) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Bifunctor.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="annot"><span class="annottext">((Unique (WithLoHi Key) -&gt; Unique (WithLoHi Key))
 -&gt; (a, Unique (WithLoHi Key)) -&gt; (a, Unique (WithLoHi Key)))
-&gt; (Unique (WithLoHi Key) -&gt; Unique (WithLoHi Key))
-&gt; (a, Unique (WithLoHi Key))
-&gt; (a, Unique (WithLoHi Key))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
-&gt; Unique (WithLoHi Key) -&gt; Unique (WithLoHi Key)
forall a. Monoid a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#mappend"><span class="hs-identifier hs-var">mappend</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique (WithLoHi Key)
 -&gt; Unique (WithLoHi Key) -&gt; Unique (WithLoHi Key))
-&gt; Unique (WithLoHi Key)
-&gt; Unique (WithLoHi Key)
-&gt; Unique (WithLoHi Key)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span id="local-6989586621679234615"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234615"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Key
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi Key
forall a.
a
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi a
</span><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-var">WithLoHi</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234615"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234610"><span class="hs-identifier hs-var">cpu</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234611"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234612"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Key -&gt; WithLoHi Key) -&gt; Unique Key -&gt; Unique (WithLoHi Key)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Seq TestName) -&gt; Expr -&gt; Unique Key
</span><a href="Plutarch.Test.Bench.html#findMatchingKeys"><span class="hs-identifier hs-var">findMatchingKeys</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Seq TestName)
</span><a href="#local-6989586621679234597"><span class="hs-identifier hs-var">im</span></a></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679234609"><span class="hs-identifier hs-var">p</span></a></span><span>
</span><span id="line-594"></span><span>    </span><span class="annot"><a href="#local-6989586621679234598"><span class="hs-identifier hs-var">foldDeps</span></a></span><span> </span><span class="annot"><span class="annottext">DependencyType
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((a, Unique (WithLoHi Key)) -&gt; (a, Unique (WithLoHi Key)))
-&gt; [(a, Unique (WithLoHi Key))] -&gt; [(a, Unique (WithLoHi Key))]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(Unique (WithLoHi Key) -&gt; Unique (WithLoHi Key))
-&gt; (a, Unique (WithLoHi Key)) -&gt; (a, Unique (WithLoHi Key))
forall b c a. (b -&gt; c) -&gt; (a, b) -&gt; (a, c)
forall (p :: Type -&gt; Type -&gt; Type) b c a.
Bifunctor p =&gt;
(b -&gt; c) -&gt; p a b -&gt; p a c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Bifunctor.html#second"><span class="hs-identifier hs-var">second</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
-&gt; Unique (WithLoHi Key) -&gt; Unique (WithLoHi Key)
forall a b. a -&gt; b -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#const"><span class="hs-identifier hs-var">const</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-595"></span><span>
</span><span id="line-596"></span><span class="annot"><a href="Plutarch.Test.Bench.html#pbcomparePrefix"><span class="hs-identifier hs-type">pbcomparePrefix</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-597"></span><span id="pbcomparePrefix"><span class="annot"><span class="annottext">pbcomparePrefix :: TestName
</span><a href="Plutarch.Test.Bench.html#pbcomparePrefix"><span class="hs-identifier hs-var hs-var">pbcomparePrefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;plutarch-bench&quot;</span></span><span>
</span><span id="line-598"></span><span>
</span><span id="line-599"></span><span class="annot"><a href="Plutarch.Test.Bench.html#findMatchingKeys"><span class="hs-identifier hs-type">findMatchingKeys</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Sequence.Internal.html#Seq"><span class="hs-identifier hs-type">Seq</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Expr</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">IntMap.Key</span></a></span><span>
</span><span id="line-600"></span><span id="findMatchingKeys"><span class="annot"><span class="annottext">findMatchingKeys :: IntMap (Seq TestName) -&gt; Expr -&gt; Unique Key
</span><a href="Plutarch.Test.Bench.html#findMatchingKeys"><span class="hs-identifier hs-var hs-var">findMatchingKeys</span></a></span></span><span> </span><span id="local-6989586621679234617"><span class="annot"><span class="annottext">IntMap (Seq TestName)
</span><a href="#local-6989586621679234617"><span class="hs-identifier hs-var">im</span></a></span></span><span> </span><span id="local-6989586621679234618"><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679234618"><span class="hs-identifier hs-var">p</span></a></span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-601"></span><span>  </span><span class="annot"><span class="annottext">((Key, Seq TestName) -&gt; Unique Key)
-&gt; [(Key, Seq TestName)] -&gt; Unique Key
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; [a] -&gt; m
forall (t :: Type -&gt; Type) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679234620"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234620"><span class="hs-identifier hs-var">k</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234621"><span class="annot"><span class="annottext">Seq TestName
</span><a href="#local-6989586621679234621"><span class="hs-identifier hs-var">v</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Seq TestName -&gt; M Bool -&gt; Either TestName Bool
forall a. Seq TestName -&gt; M a -&gt; Either TestName a
</span><span class="hs-identifier hs-var">withFields</span></span><span> </span><span class="annot"><span class="annottext">Seq TestName
</span><a href="#local-6989586621679234621"><span class="hs-identifier hs-var">v</span></a></span><span> </span><span class="annot"><span class="annottext">M Bool
</span><a href="#local-6989586621679234622"><span class="hs-identifier hs-var">pat</span></a></span><span> </span><span class="annot"><span class="annottext">Either TestName Bool -&gt; Either TestName Bool -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Either TestName Bool
forall a b. b -&gt; Either a b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Either.html#Right"><span class="hs-identifier hs-var">Right</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Unique Key
forall a. a -&gt; Unique a
</span><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-var">Unique</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234620"><span class="hs-identifier hs-var">k</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Unique Key
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">([(Key, Seq TestName)] -&gt; Unique Key)
-&gt; [(Key, Seq TestName)] -&gt; Unique Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Seq TestName) -&gt; [(Key, Seq TestName)]
forall a. IntMap a -&gt; [(Key, a)]
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#assocs"><span class="hs-identifier hs-var">IntMap.assocs</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (Seq TestName)
</span><a href="#local-6989586621679234617"><span class="hs-identifier hs-var">im</span></a></span><span>
</span><span id="line-602"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-603"></span><span>    </span><span id="local-6989586621679234622"><span class="annot"><span class="annottext">pat :: M Bool
</span><a href="#local-6989586621679234622"><span class="hs-identifier hs-var hs-var">pat</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Expr -&gt; M Value
</span><span class="hs-identifier hs-var">eval</span></span><span> </span><span class="annot"><span class="annottext">Expr
</span><a href="#local-6989586621679234618"><span class="hs-identifier hs-var">p</span></a></span><span> </span><span class="annot"><span class="annottext">M Value -&gt; (Value -&gt; M Bool) -&gt; M Bool
forall a b.
ReaderT (Seq TestName) (Either TestName) a
-&gt; (a -&gt; ReaderT (Seq TestName) (Either TestName) b)
-&gt; ReaderT (Seq TestName) (Either TestName) b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="annot"><span class="annottext">Value -&gt; M Bool
</span><span class="hs-identifier hs-var">asB</span></span><span>
</span><span id="line-604"></span><span>
</span><span id="line-605"></span><span class="annot"><a href="Plutarch.Test.Bench.html#postprocessResult"><span class="hs-identifier hs-type">postprocessResult</span></a></span><span> </span><span class="hs-glyph">::</span><span>
</span><span id="line-606"></span><span>  </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-607"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntSet.Internal.html#Key"><span class="hs-identifier hs-type">IntMap.Key</span></a></span><span class="hs-special">)</span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Status</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-608"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatusMap</span></span><span>
</span><span id="line-609"></span><span id="postprocessResult"><span class="annot"><span class="annottext">postprocessResult :: (TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result)
-&gt; IntMap (TestName, Unique (WithLoHi Key), TVar Status)
-&gt; IO StatusMap
</span><a href="Plutarch.Test.Bench.html#postprocessResult"><span class="hs-identifier hs-var hs-var">postprocessResult</span></a></span></span><span> </span><span id="local-6989586621679234624"><span class="annot"><span class="annottext">TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result
</span><a href="#local-6989586621679234624"><span class="hs-identifier hs-var">f</span></a></span></span><span> </span><span id="local-6989586621679234625"><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key), TVar Status)
</span><a href="#local-6989586621679234625"><span class="hs-identifier hs-var">src</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-610"></span><span>  </span><span id="local-6989586621679234626"><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
</span><a href="#local-6989586621679234626"><span class="hs-identifier hs-var">paired</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key), TVar Status)
-&gt; ((TestName, Unique (WithLoHi Key), TVar Status)
    -&gt; IO (TestName, Unique (WithLoHi Key), TVar Status, TVar Status))
-&gt; IO
     (IntMap
        (TestName, Unique (WithLoHi Key), TVar Status, TVar Status))
forall (t :: Type -&gt; Type) (m :: Type -&gt; Type) a b.
(Traversable t, Monad m) =&gt;
t a -&gt; (a -&gt; m b) -&gt; m (t b)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Traversable.html#forM"><span class="hs-identifier hs-var">forM</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key), TVar Status)
</span><a href="#local-6989586621679234625"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="annot"><span class="annottext">(((TestName, Unique (WithLoHi Key), TVar Status)
  -&gt; IO (TestName, Unique (WithLoHi Key), TVar Status, TVar Status))
 -&gt; IO
      (IntMap
         (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)))
-&gt; ((TestName, Unique (WithLoHi Key), TVar Status)
    -&gt; IO (TestName, Unique (WithLoHi Key), TVar Status, TVar Status))
-&gt; IO
     (IntMap
        (TestName, Unique (WithLoHi Key), TVar Status, TVar Status))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679234627"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234627"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234628"><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="#local-6989586621679234628"><span class="hs-identifier hs-var">mDepId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234629"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234629"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234627"><span class="hs-identifier hs-var">name</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="#local-6989586621679234628"><span class="hs-identifier hs-var">mDepId</span></a></span><span class="hs-special">,</span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234629"><span class="hs-identifier hs-var">tv</span></a></span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TVar Status
 -&gt; (TestName, Unique (WithLoHi Key), TVar Status, TVar Status))
-&gt; IO (TVar Status)
-&gt; IO (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Status -&gt; IO (TVar Status)
forall a. a -&gt; IO (TVar a)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#newTVarIO"><span class="hs-identifier hs-var">newTVarIO</span></a></span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">NotStarted</span></span><span>
</span><span id="line-611"></span><span>  </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234630"><span class="annot"><span class="annottext">doUpdate :: IO Bool
</span><a href="#local-6989586621679234630"><span class="hs-identifier hs-var hs-var">doUpdate</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">STM Bool -&gt; IO Bool
forall a. STM a -&gt; IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#atomically"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM Bool -&gt; IO Bool) -&gt; STM Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-612"></span><span>        </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#Any"><span class="hs-identifier hs-type">Any</span></a></span><span> </span><span id="local-6989586621679234631"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234631"><span class="hs-identifier hs-var">anyUpdated</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#All"><span class="hs-identifier hs-type">All</span></a></span><span> </span><span id="local-6989586621679234632"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234632"><span class="hs-identifier hs-var">allDone</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span>
</span><span id="line-613"></span><span>          </span><span class="annot"><span class="annottext">Ap STM (Any, All) -&gt; STM (Any, All)
forall (f :: Type -&gt; Type) a. Ap f a -&gt; f a
</span><span class="hs-identifier hs-var">getApp</span></span><span> </span><span class="annot"><span class="annottext">(Ap STM (Any, All) -&gt; STM (Any, All))
-&gt; Ap STM (Any, All) -&gt; STM (Any, All)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(((TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
  -&gt; Ap STM (Any, All))
 -&gt; IntMap
      (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
 -&gt; Ap STM (Any, All))
-&gt; IntMap
     (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
-&gt; ((TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
    -&gt; Ap STM (Any, All))
-&gt; Ap STM (Any, All)
forall a b c. (a -&gt; b -&gt; c) -&gt; b -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#flip"><span class="hs-identifier hs-var">flip</span></a></span><span> </span><span class="annot"><span class="annottext">((TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
 -&gt; Ap STM (Any, All))
-&gt; IntMap
     (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
-&gt; Ap STM (Any, All)
forall m a. Monoid m =&gt; (a -&gt; m) -&gt; IntMap a -&gt; m
forall (t :: Type -&gt; Type) m a.
(Foldable t, Monoid m) =&gt;
(a -&gt; m) -&gt; t a -&gt; m
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#foldMap"><span class="hs-identifier hs-var">foldMap</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
</span><a href="#local-6989586621679234626"><span class="hs-identifier hs-var">paired</span></a></span><span> </span><span class="annot"><span class="annottext">(((TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
  -&gt; Ap STM (Any, All))
 -&gt; Ap STM (Any, All))
-&gt; ((TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
    -&gt; Ap STM (Any, All))
-&gt; Ap STM (Any, All)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679234633"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234633"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234634"><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="#local-6989586621679234634"><span class="hs-identifier hs-var">mDepId</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234635"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234635"><span class="hs-identifier hs-var">newTV</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234636"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234636"><span class="hs-identifier hs-var">oldTV</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">STM (Any, All) -&gt; Ap STM (Any, All)
forall (f :: Type -&gt; Type) a. f a -&gt; Ap f a
</span><span class="hs-identifier hs-var">Ap</span></span><span> </span><span class="annot"><span class="annottext">(STM (Any, All) -&gt; Ap STM (Any, All))
-&gt; STM (Any, All) -&gt; Ap STM (Any, All)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-614"></span><span>            </span><span id="local-6989586621679234637"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679234637"><span class="hs-identifier hs-var">old</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; STM Status
forall a. TVar a -&gt; STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234636"><span class="hs-identifier hs-var">oldTV</span></a></span><span>
</span><span id="line-615"></span><span>            </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679234637"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-616"></span><span>              </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Any, All) -&gt; STM (Any, All)
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#All"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-617"></span><span>              </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-618"></span><span>                </span><span id="local-6989586621679234638"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679234638"><span class="hs-identifier hs-var">new</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; STM Status
forall a. TVar a -&gt; STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234635"><span class="hs-identifier hs-var">newTV</span></a></span><span>
</span><span id="line-619"></span><span>                </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679234638"><span class="hs-identifier hs-var">new</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-620"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span id="local-6989586621679234639"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234639"><span class="hs-identifier hs-var">res</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-621"></span><span>                    </span><span id="local-6989586621679234640"><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="#local-6989586621679234640"><span class="hs-identifier hs-var">depRes</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="#local-6989586621679234634"><span class="hs-identifier hs-var">mDepId</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-622"></span><span>                      </span><span class="annot"><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-type">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span id="local-6989586621679234641"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234641"><span class="hs-identifier hs-var">depId</span></a></span></span><span> </span><span id="local-6989586621679234642"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234642"><span class="hs-identifier hs-var">cpu</span></a></span></span><span> </span><span id="local-6989586621679234643"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234643"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621679234644"><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234644"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Key
-&gt; IntMap (TestName, Unique (WithLoHi Key), TVar Status)
-&gt; Maybe (TestName, Unique (WithLoHi Key), TVar Status)
forall a. Key -&gt; IntMap a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#lookup"><span class="hs-identifier hs-var">IntMap.lookup</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234641"><span class="hs-identifier hs-var">depId</span></a></span><span> </span><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key), TVar Status)
</span><a href="#local-6989586621679234625"><span class="hs-identifier hs-var">src</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-623"></span><span>                        </span><span class="annot"><span class="annottext">Maybe (TestName, Unique (WithLoHi Key), TVar Status)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result))
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-624"></span><span>                        </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234646"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234646"><span class="hs-identifier hs-var">depTV</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-625"></span><span>                          </span><span id="local-6989586621679234647"><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679234647"><span class="hs-identifier hs-var">depStatus</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; STM Status
forall a. TVar a -&gt; STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234646"><span class="hs-identifier hs-var">depTV</span></a></span><span>
</span><span id="line-626"></span><span>                          </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679234647"><span class="hs-identifier hs-var">depStatus</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-627"></span><span>                            </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span id="local-6989586621679234648"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234648"><span class="hs-identifier hs-var">dep</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result))
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result)))
-&gt; Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result))
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">WithLoHi Result -&gt; Unique (WithLoHi Result)
forall a. a -&gt; Unique a
</span><a href="Plutarch.Test.Bench.html#Unique"><span class="hs-identifier hs-var">Unique</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi Result
forall a.
a
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; (Double, Double)
-&gt; WithLoHi a
</span><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-var">WithLoHi</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234648"><span class="hs-identifier hs-var">dep</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234642"><span class="hs-identifier hs-var">cpu</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234643"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><a href="#local-6989586621679234644"><span class="hs-identifier hs-var">size</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-628"></span><span>                            </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result))
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span>
</span><span id="line-629"></span><span>                      </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result))
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#None"><span class="hs-identifier hs-var">None</span></a></span><span>
</span><span id="line-630"></span><span>                      </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="Plutarch.Test.Bench.html#NotUnique"><span class="hs-identifier hs-var">NotUnique</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result))
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#NotUnique"><span class="hs-identifier hs-var">NotUnique</span></a></span><span>
</span><span id="line-631"></span><span>                      </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result) -&gt; STM (Unique (WithLoHi Result))
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
forall a. Unique a
</span><a href="Plutarch.Test.Bench.html#NotProvided"><span class="hs-identifier hs-var">NotProvided</span></a></span><span>
</span><span id="line-632"></span><span>                    </span><span class="annot"><span class="annottext">TVar Status -&gt; Status -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#writeTVar"><span class="hs-identifier hs-var">writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234636"><span class="hs-identifier hs-var">oldTV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Status
</span><span class="hs-identifier hs-var">Done</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; Unique (WithLoHi Result) -&gt; Result -&gt; Result
</span><a href="#local-6989586621679234624"><span class="hs-identifier hs-var">f</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234633"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Result)
</span><a href="#local-6989586621679234640"><span class="hs-identifier hs-var">depRes</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234639"><span class="hs-identifier hs-var">res</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span>
</span><span id="line-633"></span><span>                    </span><span class="annot"><span class="annottext">(Any, All) -&gt; STM (Any, All)
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#All"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-634"></span><span>                  </span><span class="annot"><span class="hs-identifier hs-type">Executing</span></span><span> </span><span id="local-6989586621679234649"><span class="annot"><span class="annottext">Progress
</span><a href="#local-6989586621679234649"><span class="hs-identifier hs-var">newProgr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-635"></span><span>                    </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234650"><span class="annot"><span class="annottext">updated :: Bool
</span><a href="#local-6989586621679234650"><span class="hs-identifier hs-var hs-var">updated</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Status
</span><a href="#local-6989586621679234637"><span class="hs-identifier hs-var">old</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-636"></span><span>                          </span><span class="annot"><span class="hs-identifier hs-type">Executing</span></span><span> </span><span id="local-6989586621679234651"><span class="annot"><span class="annottext">Progress
</span><a href="#local-6989586621679234651"><span class="hs-identifier hs-var">oldProgr</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Progress
</span><a href="#local-6989586621679234651"><span class="hs-identifier hs-var">oldProgr</span></a></span><span> </span><span class="annot"><span class="annottext">Progress -&gt; Progress -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Progress
</span><a href="#local-6989586621679234649"><span class="hs-identifier hs-var">newProgr</span></a></span><span>
</span><span id="line-637"></span><span>                          </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-638"></span><span>                    </span><span class="annot"><span class="annottext">Bool -&gt; STM () -&gt; STM ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#when"><span class="hs-identifier hs-var">when</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234650"><span class="hs-identifier hs-var">updated</span></a></span><span> </span><span class="annot"><span class="annottext">(STM () -&gt; STM ()) -&gt; STM () -&gt; STM ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span>
</span><span id="line-639"></span><span>                      </span><span class="annot"><span class="annottext">TVar Status -&gt; Status -&gt; STM ()
forall a. TVar a -&gt; a -&gt; STM ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#writeTVar"><span class="hs-identifier hs-var">writeTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234636"><span class="hs-identifier hs-var">oldTV</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Progress -&gt; Status
</span><span class="hs-identifier hs-var">Executing</span></span><span> </span><span class="annot"><span class="annottext">Progress
</span><a href="#local-6989586621679234649"><span class="hs-identifier hs-var">newProgr</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-640"></span><span>                    </span><span class="annot"><span class="annottext">(Any, All) -&gt; STM (Any, All)
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234650"><span class="hs-identifier hs-var">updated</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#All"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-641"></span><span>                  </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier hs-var">NotStarted</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">(Any, All) -&gt; STM (Any, All)
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Any
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#Any"><span class="hs-identifier hs-var">Any</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; All
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Semigroup.Internal.html#All"><span class="hs-identifier hs-var">All</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-642"></span><span>        </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234631"><span class="hs-identifier hs-var">anyUpdated</span></a></span><span> </span><span class="annot"><span class="annottext">Bool -&gt; Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%7C%7C"><span class="hs-operator hs-var">||</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234632"><span class="hs-identifier hs-var">allDone</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; STM Bool
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234632"><span class="hs-identifier hs-var">allDone</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">STM Bool
forall a. STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#retry"><span class="hs-identifier hs-var">retry</span></a></span><span>
</span><span id="line-643"></span><span>      </span><span id="local-6989586621679234654"><span class="annot"><span class="annottext">adNauseam :: IO ()
</span><a href="#local-6989586621679234654"><span class="hs-identifier hs-var hs-var">adNauseam</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">IO Bool
</span><a href="#local-6989586621679234630"><span class="hs-identifier hs-var">doUpdate</span></a></span><span> </span><span class="annot"><span class="annottext">IO Bool -&gt; (Bool -&gt; IO ()) -&gt; IO ()
forall a b. IO a -&gt; (a -&gt; IO b) -&gt; IO b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; IO () -&gt; IO ()
forall (f :: Type -&gt; Type). Applicative f =&gt; Bool -&gt; f () -&gt; f ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#unless"><span class="hs-operator hs-var">`unless`</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679234654"><span class="hs-identifier hs-var">adNauseam</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-644"></span><span>  </span><span class="annot"><span class="annottext">ThreadId
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">IO () -&gt; IO ThreadId
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#forkIO"><span class="hs-identifier hs-var">forkIO</span></a></span><span> </span><span class="annot"><span class="annottext">IO ()
</span><a href="#local-6989586621679234654"><span class="hs-identifier hs-var">adNauseam</span></a></span><span>
</span><span id="line-645"></span><span>  </span><span class="annot"><span class="annottext">StatusMap -&gt; IO StatusMap
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">(StatusMap -&gt; IO StatusMap) -&gt; StatusMap -&gt; IO StatusMap
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">((TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
 -&gt; TVar Status)
-&gt; IntMap
     (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
-&gt; StatusMap
forall a b. (a -&gt; b) -&gt; IntMap a -&gt; IntMap b
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#fmap"><span class="hs-identifier hs-var">fmap</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">\</span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Unique (WithLoHi Key)
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234655"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234655"><span class="hs-identifier hs-var">a</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234655"><span class="hs-identifier hs-var">a</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">IntMap (TestName, Unique (WithLoHi Key), TVar Status, TVar Status)
</span><a href="#local-6989586621679234626"><span class="hs-identifier hs-var">paired</span></a></span><span>
</span><span id="line-646"></span><span>
</span><span id="line-647"></span><span class="annot"><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-type">parsePositivePercents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span>
</span><span id="line-648"></span><span id="parsePositivePercents"><span class="annot"><span class="annottext">parsePositivePercents :: TestName -&gt; Maybe Double
</span><a href="Plutarch.Test.Bench.html#parsePositivePercents"><span class="hs-identifier hs-var hs-var">parsePositivePercents</span></a></span></span><span> </span><span id="local-6989586621679234656"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234656"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-649"></span><span>  </span><span id="local-6989586621679234657"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234657"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Double
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234656"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-650"></span><span>  </span><span class="annot"><span class="annottext">Bool -&gt; Maybe ()
forall (f :: Type -&gt; Type). Alternative f =&gt; Bool -&gt; f ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Control.Monad.html#guard"><span class="hs-identifier hs-var">guard</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234657"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Bool
forall a. Ord a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3E"><span class="hs-operator hs-var">&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">0</span></span><span class="hs-special">)</span><span>
</span><span id="line-651"></span><span>  </span><span class="annot"><span class="annottext">Double -&gt; Maybe Double
forall a. a -&gt; Maybe a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234657"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-652"></span><span>
</span><span id="line-653"></span><span class="annot"><a href="Plutarch.Test.Bench.html#joinQuotedFields"><span class="hs-identifier hs-type">joinQuotedFields</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span>
</span><span id="line-654"></span><span id="joinQuotedFields"><span class="annot"><span class="annottext">joinQuotedFields :: [TestName] -&gt; [TestName]
</span><a href="Plutarch.Test.Bench.html#joinQuotedFields"><span class="hs-identifier hs-var hs-var">joinQuotedFields</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span>
</span><span id="line-655"></span><span class="annot"><a href="Plutarch.Test.Bench.html#joinQuotedFields"><span class="hs-identifier hs-var">joinQuotedFields</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234659"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234659"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234660"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679234660"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-656"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool
</span><a href="#local-6989586621679234661"><span class="hs-identifier hs-var">areQuotesBalanced</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; [TestName] -&gt; [TestName]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; [TestName]
</span><a href="Plutarch.Test.Bench.html#joinQuotedFields"><span class="hs-identifier hs-var">joinQuotedFields</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679234660"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-657"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Bool) -&gt; [TestName] -&gt; ([TestName], [TestName])
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool
</span><a href="#local-6989586621679234661"><span class="hs-identifier hs-var">areQuotesBalanced</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679234660"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-658"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TestName]
</span><span class="hs-identifier">_</span></span><span class="hs-special">,</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-comment">-- malformed CSV</span><span>
</span><span id="line-659"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679234663"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679234663"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234664"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234664"><span class="hs-identifier hs-var">z</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234665"><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679234665"><span class="hs-identifier hs-var">zs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234659"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; [TestName] -&gt; [TestName]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679234663"><span class="hs-identifier hs-var">ys</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; [TestName] -&gt; [TestName]
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">TestName
Item [TestName]
</span><a href="#local-6989586621679234664"><span class="hs-identifier hs-var">z</span></a></span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; [TestName] -&gt; [TestName]
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; [TestName]
</span><a href="Plutarch.Test.Bench.html#joinQuotedFields"><span class="hs-identifier hs-var">joinQuotedFields</span></a></span><span> </span><span class="annot"><span class="annottext">[TestName]
</span><a href="#local-6989586621679234665"><span class="hs-identifier hs-var">zs</span></a></span><span>
</span><span id="line-660"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-661"></span><span>    </span><span id="local-6989586621679234661"><span class="annot"><span class="annottext">areQuotesBalanced :: TestName -&gt; Bool
</span><a href="#local-6989586621679234661"><span class="hs-identifier hs-var hs-var">areQuotesBalanced</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Bool
forall a. Integral a =&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#even"><span class="hs-identifier hs-var">even</span></a></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; Bool) -&gt; (TestName -&gt; Key) -&gt; TestName -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Key
forall a. [a] -&gt; Key
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Key
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Key) -&gt; (TestName -&gt; TestName) -&gt; TestName -&gt; Key
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; TestName -&gt; TestName
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%3D%3D"><span class="hs-operator hs-var">==</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span class="hs-special">)</span><span>
</span><span id="line-662"></span><span>
</span><span id="line-663"></span><span class="annot"><a href="Plutarch.Test.Bench.html#forceFail"><span class="hs-identifier hs-type">forceFail</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Result</span></span><span>
</span><span id="line-664"></span><span id="forceFail"><span class="annot"><span class="annottext">forceFail :: Result -&gt; Result
</span><a href="Plutarch.Test.Bench.html#forceFail"><span class="hs-identifier hs-var hs-var">forceFail</span></a></span></span><span> </span><span id="local-6989586621679234671"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234671"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234671"><span class="hs-identifier hs-var">r</span></a></span><span> </span><span class="hs-special">{</span><span class="annot"><span class="hs-identifier hs-var">resultOutcome</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Failure</span></span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestFailed</span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="hs-identifier hs-var">resultShortDescription</span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="hs-string">&quot;FAIL&quot;</span></span><span class="hs-special">}</span><span>
</span><span id="line-665"></span><span>
</span><span id="line-666"></span><span class="annot"><a href="Plutarch.Test.Bench.html#formatSlowDown"><span class="hs-identifier hs-type">formatSlowDown</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-667"></span><span id="formatSlowDown"><span class="annot"><span class="annottext">formatSlowDown :: Double -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#formatSlowDown"><span class="hs-identifier hs-var hs-var">formatSlowDown</span></a></span></span><span> </span><span id="local-6989586621679234672"><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234672"><span class="hs-identifier hs-var">ratio</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679234673"><span class="hs-identifier hs-var">percents</span></a></span><span> </span><span class="annot"><span class="annottext">Int64 -&gt; Int64 -&gt; Ordering
forall a. Ord a =&gt; a -&gt; a -&gt; Ordering
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#compare"><span class="hs-operator hs-var">`compare`</span></a></span><span> </span><span class="annot"><span class="annottext">Int64
</span><span class="hs-number">0</span></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-668"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#LT"><span class="hs-identifier hs-var">LT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Int64 -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%2i%% less than baseline&quot;</span></span><span> </span><span class="hs-special">(</span><span class="hs-glyph">-</span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679234673"><span class="hs-identifier hs-var">percents</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-669"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#EQ"><span class="hs-identifier hs-var">EQ</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;same as baseline&quot;</span></span><span>
</span><span id="line-670"></span><span>  </span><span class="annot"><span class="annottext">Ordering
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#GT"><span class="hs-identifier hs-var">GT</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Int64 -&gt; TestName
forall r. PrintfType r =&gt; TestName -&gt; r
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Text.Printf.html#printf"><span class="hs-identifier hs-var">printf</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;%2i%% more than baseline&quot;</span></span><span> </span><span class="annot"><span class="annottext">Int64
</span><a href="#local-6989586621679234673"><span class="hs-identifier hs-var">percents</span></a></span><span>
</span><span id="line-671"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-672"></span><span>    </span><span class="annot"><a href="#local-6989586621679234673"><span class="hs-identifier hs-type">percents</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Int.html#Int64"><span class="hs-identifier hs-type">Int64</span></a></span><span>
</span><span id="line-673"></span><span>    </span><span id="local-6989586621679234673"><span class="annot"><span class="annottext">percents :: Int64
</span><a href="#local-6989586621679234673"><span class="hs-identifier hs-var hs-var">percents</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Int64
forall b. Integral b =&gt; Double -&gt; b
forall a b. (RealFrac a, Integral b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#truncate"><span class="hs-identifier hs-var">truncate</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">(</span><span class="annot"><span class="annottext">Double
</span><a href="#local-6989586621679234672"><span class="hs-identifier hs-var">ratio</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-operator hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">1</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#%2A"><span class="hs-operator hs-var">*</span></a></span><span> </span><span class="annot"><span class="annottext">Double
</span><span class="hs-number">100</span></span><span class="hs-special">)</span><span>
</span><span id="line-674"></span><span>
</span><span id="line-675"></span><span class="annot"><a href="Plutarch.Test.Bench.html#compareVsBaseline"><span class="hs-identifier hs-type">compareVsBaseline</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#Set"><span class="hs-identifier hs-type">Set</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-type">ExecutionBudget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Double"><span class="hs-identifier hs-type">Double</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-676"></span><span id="compareVsBaseline"><span class="annot"><span class="annottext">compareVsBaseline :: Set TestName
-&gt; TestName -&gt; ExecutionBudget -&gt; Maybe (Double, Double, Double)
</span><a href="Plutarch.Test.Bench.html#compareVsBaseline"><span class="hs-identifier hs-var hs-var">compareVsBaseline</span></a></span></span><span> </span><span id="local-6989586621679234677"><span class="annot"><span class="annottext">Set TestName
</span><a href="#local-6989586621679234677"><span class="hs-identifier hs-var">baseline</span></a></span></span><span> </span><span id="local-6989586621679234678"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234678"><span class="hs-identifier hs-var">name</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-type">ExecutionBudget</span></a></span><span> </span><span id="local-6989586621679234679"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234679"><span class="hs-identifier hs-var">cpu</span></a></span></span><span> </span><span id="local-6989586621679234680"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234680"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621679234681"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234681"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Maybe (Integer, Integer, Integer)
</span><a href="#local-6989586621679234682"><span class="hs-identifier hs-var">mOld</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-677"></span><span>  </span><span class="annot"><span class="annottext">Maybe (Integer, Integer, Integer)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe (Double, Double, Double)
forall a. Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-678"></span><span>  </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234683"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234683"><span class="hs-identifier hs-var">oldCpu</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234684"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234684"><span class="hs-identifier hs-var">oldMem</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234685"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234685"><span class="hs-identifier hs-var">oldSize</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span>
</span><span id="line-679"></span><span>    </span><span class="annot"><span class="annottext">(Double, Double, Double) -&gt; Maybe (Double, Double, Double)
forall a. a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span>
</span><span id="line-680"></span><span>      </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234679"><span class="hs-identifier hs-var">cpu</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234683"><span class="hs-identifier hs-var">oldCpu</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234680"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234684"><span class="hs-identifier hs-var">oldMem</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234681"><span class="hs-identifier hs-var">size</span></a></span><span> </span><span class="annot"><span class="annottext">Double -&gt; Double -&gt; Double
forall a. Fractional a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#%2F"><span class="hs-operator hs-var">/</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; Double
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234685"><span class="hs-identifier hs-var">oldSize</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-681"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-682"></span><span>    </span><span class="annot"><a href="#local-6989586621679234682"><span class="hs-identifier hs-type">mOld</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-683"></span><span>    </span><span id="local-6989586621679234682"><span class="annot"><span class="annottext">mOld :: Maybe (Integer, Integer, Integer)
</span><a href="#local-6989586621679234682"><span class="hs-identifier hs-var hs-var">mOld</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-684"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234686"><span class="annot"><span class="annottext">prefix :: TestName
</span><a href="#local-6989586621679234686"><span class="hs-identifier hs-var hs-var">prefix</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#encodeCsv"><span class="hs-identifier hs-var">encodeCsv</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234678"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;,&quot;</span></span><span>
</span><span id="line-685"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679234688"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234688"><span class="hs-identifier hs-var">line</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234689"><span class="annot"><span class="annottext">Set TestName
</span><a href="#local-6989586621679234689"><span class="hs-identifier hs-var">furtherLines</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">Set TestName -&gt; Maybe (TestName, Set TestName)
forall a. Set a -&gt; Maybe (a, Set a)
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#minView"><span class="hs-identifier hs-var">Set.minView</span></a></span><span> </span><span class="annot"><span class="annottext">(Set TestName -&gt; Maybe (TestName, Set TestName))
-&gt; Set TestName -&gt; Maybe (TestName, Set TestName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Set TestName, Set TestName) -&gt; Set TestName
forall a b. (a, b) -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Tuple.html#snd"><span class="hs-identifier hs-var">snd</span></a></span><span> </span><span class="annot"><span class="annottext">((Set TestName, Set TestName) -&gt; Set TestName)
-&gt; (Set TestName, Set TestName) -&gt; Set TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Set TestName -&gt; (Set TestName, Set TestName)
forall a. Ord a =&gt; a -&gt; Set a -&gt; (Set a, Set a)
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#split"><span class="hs-identifier hs-var">Set.split</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234686"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">Set TestName
</span><a href="#local-6989586621679234677"><span class="hs-identifier hs-var">baseline</span></a></span><span>
</span><span id="line-686"></span><span>
</span><span id="line-687"></span><span>      </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">Set TestName -&gt; Maybe (TestName, Set TestName)
forall a. Set a -&gt; Maybe (a, Set a)
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#minView"><span class="hs-identifier hs-var">Set.minView</span></a></span><span> </span><span class="annot"><span class="annottext">Set TestName
</span><a href="#local-6989586621679234689"><span class="hs-identifier hs-var">furtherLines</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-688"></span><span>        </span><span class="annot"><span class="annottext">Maybe (TestName, Set TestName)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-689"></span><span>        </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234693"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234693"><span class="hs-identifier hs-var">nextLine</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Set TestName
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; Maybe TestName
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#stripPrefix"><span class="hs-identifier hs-var">stripPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234686"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234693"><span class="hs-identifier hs-var">nextLine</span></a></span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-690"></span><span>          </span><span class="annot"><span class="annottext">Maybe TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; Maybe ()
forall a. a -&gt; Maybe a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-691"></span><span>          </span><span class="hs-comment">-- If there are several lines matching prefix, skip them all.</span><span>
</span><span id="line-692"></span><span>          </span><span class="hs-comment">-- Should not normally happen, 'csvReporter' prohibits repeating test names.</span><span>
</span><span id="line-693"></span><span>          </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">{</span><span class="hs-special">}</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Maybe ()
forall a. Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-694"></span><span>
</span><span id="line-695"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679234694"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234694"><span class="hs-identifier hs-var">cpuCell</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234695"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234695"><span class="hs-identifier hs-var">rest</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; TestName -&gt; (TestName, TestName)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; (TestName, TestName))
-&gt; Maybe TestName -&gt; Maybe (TestName, TestName)
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; Maybe TestName
forall a. Eq a =&gt; [a] -&gt; [a] -&gt; Maybe [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#stripPrefix"><span class="hs-identifier hs-var">stripPrefix</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234686"><span class="hs-identifier hs-var">prefix</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234688"><span class="hs-identifier hs-var">line</span></a></span><span>
</span><span id="line-696"></span><span>      </span><span class="hs-special">(</span><span id="local-6989586621679234696"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234696"><span class="hs-identifier hs-var">memCell</span></a></span></span><span class="hs-special">,</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234697"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234697"><span class="hs-identifier hs-var">rest'</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">(TestName, TestName) -&gt; Maybe (TestName, TestName)
forall a. a -&gt; Maybe a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">((TestName, TestName) -&gt; Maybe (TestName, TestName))
-&gt; (TestName, TestName) -&gt; Maybe (TestName, TestName)
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; TestName -&gt; (TestName, TestName)
forall a. (a -&gt; Bool) -&gt; [a] -&gt; ([a], [a])
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#span"><span class="hs-identifier hs-var">span</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234695"><span class="hs-identifier hs-var">rest</span></a></span><span>
</span><span id="line-697"></span><span>      </span><span class="hs-keyword">let</span><span> </span><span id="local-6989586621679234698"><span class="annot"><span class="annottext">sizeCell :: TestName
</span><a href="#local-6989586621679234698"><span class="hs-identifier hs-var hs-var">sizeCell</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">(Char -&gt; Bool) -&gt; TestName -&gt; TestName
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#takeWhile"><span class="hs-identifier hs-var">takeWhile</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; Char -&gt; Bool
forall a. Eq a =&gt; a -&gt; a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#%2F%3D"><span class="hs-operator hs-var">/=</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234697"><span class="hs-identifier hs-var">rest'</span></a></span><span>
</span><span id="line-698"></span><span>      </span><span class="hs-special">(</span><span class="hs-special">,</span><span class="hs-special">,</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">(Integer -&gt; Integer -&gt; Integer -&gt; (Integer, Integer, Integer))
-&gt; Maybe Integer
-&gt; Maybe (Integer -&gt; Integer -&gt; (Integer, Integer, Integer))
forall (f :: Type -&gt; Type) a b. Functor f =&gt; (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Functor.html#%3C%24%3E"><span class="hs-operator hs-var">&lt;$&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Integer
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234694"><span class="hs-identifier hs-var">cpuCell</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; Integer -&gt; (Integer, Integer, Integer))
-&gt; Maybe Integer -&gt; Maybe (Integer -&gt; (Integer, Integer, Integer))
forall a b. Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Integer
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234696"><span class="hs-identifier hs-var">memCell</span></a></span><span> </span><span class="annot"><span class="annottext">Maybe (Integer -&gt; (Integer, Integer, Integer))
-&gt; Maybe Integer -&gt; Maybe (Integer, Integer, Integer)
forall a b. Maybe (a -&gt; b) -&gt; Maybe a -&gt; Maybe b
forall (f :: Type -&gt; Type) a b.
Applicative f =&gt;
f (a -&gt; b) -&gt; f a -&gt; f b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3C%2A%3E"><span class="hs-operator hs-var">&lt;*&gt;</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe Integer
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234698"><span class="hs-identifier hs-var">sizeCell</span></a></span><span>
</span><span id="line-699"></span><span>
</span><span id="line-700"></span><span class="annot"><a href="Plutarch.Test.Bench.html#encodeCsv"><span class="hs-identifier hs-type">encodeCsv</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-701"></span><span id="encodeCsv"><span class="annot"><span class="annottext">encodeCsv :: TestName -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#encodeCsv"><span class="hs-identifier hs-var hs-var">encodeCsv</span></a></span></span><span> </span><span id="local-6989586621679234700"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234700"><span class="hs-identifier hs-var">xs</span></a></span></span><span>
</span><span id="line-702"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">forall (t :: Type -&gt; Type) a.
Foldable t =&gt;
(a -&gt; Bool) -&gt; t a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#any"><span class="hs-identifier hs-var">any</span></a></span><span> </span><span class="hs-glyph">@</span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">@</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Char"><span class="hs-identifier hs-type">Char</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; Bool
forall a. Eq a =&gt; a -&gt; [a] -&gt; Bool
forall (t :: Type -&gt; Type) a.
(Foldable t, Eq a) =&gt;
a -&gt; t a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#elem"><span class="hs-operator hs-var">`elem`</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234700"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;,\&quot;\n\r&quot;</span></span><span> </span><span class="hs-glyph">=</span><span>
</span><span id="line-703"></span><span>      </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; TestName
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
</span><a href="#local-6989586621679234703"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234700"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="hs-comment">-- opening quote</span><span>
</span><span id="line-704"></span><span>  </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234700"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-705"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-706"></span><span>    </span><span id="local-6989586621679234703"><span class="annot"><span class="annottext">go :: TestName -&gt; TestName
</span><a href="#local-6989586621679234703"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;\&quot;&quot;</span></span><span> </span><span class="hs-comment">-- closing quote</span><span>
</span><span id="line-707"></span><span>    </span><span class="annot"><a href="#local-6989586621679234703"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234707"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234707"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; TestName
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">'&quot;'</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; TestName
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
</span><a href="#local-6989586621679234703"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234707"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-708"></span><span>    </span><span class="annot"><a href="#local-6989586621679234703"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234708"><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679234708"><span class="hs-identifier hs-var">y</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234709"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234709"><span class="hs-identifier hs-var">ys</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Char
</span><a href="#local-6989586621679234708"><span class="hs-identifier hs-var">y</span></a></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; TestName
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName
</span><a href="#local-6989586621679234703"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234709"><span class="hs-identifier hs-var">ys</span></a></span><span>
</span><span id="line-709"></span><span>
</span><span id="line-710"></span><span class="annot"><a href="Plutarch.Test.Bench.html#scriptSize"><span class="hs-identifier hs-type">scriptSize</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Script</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-bignum-1.3/src/GHC.Num.Integer.html#Integer"><span class="hs-identifier hs-type">Integer</span></a></span><span>
</span><span id="line-711"></span><span id="scriptSize"><span class="annot"><span class="annottext">scriptSize :: Script -&gt; Integer
</span><a href="Plutarch.Test.Bench.html#scriptSize"><span class="hs-identifier hs-var hs-var">scriptSize</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Key -&gt; Integer
forall a b. (Integral a, Num b) =&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Real.html#fromIntegral"><span class="hs-identifier hs-var">fromIntegral</span></a></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; Integer) -&gt; (Script -&gt; Key) -&gt; Script -&gt; Integer
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">ShortByteString -&gt; Key
</span><a href="../../../ghc-9.6.6/html/libraries/bytestring-0.11.5.3/src/Data.ByteString.Short.Internal.html#length"><span class="hs-identifier hs-var">Short.length</span></a></span><span> </span><span class="annot"><span class="annottext">(ShortByteString -&gt; Key)
-&gt; (Script -&gt; ShortByteString) -&gt; Script -&gt; Key
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Program DeBruijn DefaultUni DefaultFun () -&gt; ShortByteString
</span><span class="hs-identifier hs-var">serialiseUPLC</span></span><span> </span><span class="annot"><span class="annottext">(Program DeBruijn DefaultUni DefaultFun () -&gt; ShortByteString)
-&gt; (Script -&gt; Program DeBruijn DefaultUni DefaultFun ())
-&gt; Script
-&gt; ShortByteString
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Script -&gt; Program DeBruijn DefaultUni DefaultFun ()
</span><span class="hs-identifier hs-var">unScript</span></span><span>
</span><span id="line-712"></span><span>
</span><span id="line-713"></span><span class="annot"><a href="Plutarch.Test.Bench.html#toTableAligned"><span class="hs-identifier hs-type">toTableAligned</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-714"></span><span id="toTableAligned"><span class="annot"><span class="annottext">toTableAligned :: [[TestName]] -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#toTableAligned"><span class="hs-identifier hs-var hs-var">toTableAligned</span></a></span></span><span> </span><span id="local-6989586621679234711"><span class="annot"><span class="annottext">[[TestName]]
</span><a href="#local-6989586621679234711"><span class="hs-identifier hs-var">xss'</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TestName] -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#unlines"><span class="hs-identifier hs-var">unlines</span></a></span><span> </span><span class="annot"><span class="annottext">([TestName] -&gt; TestName) -&gt; [TestName] -&gt; TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([TestName] -&gt; TestName) -&gt; [[TestName]] -&gt; [TestName]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; [TestName] -&gt; TestName
forall a. [a] -&gt; [[a]] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.OldList.html#intercalate"><span class="hs-identifier hs-var">intercalate</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot; | &quot;</span></span><span> </span><span class="annot"><span class="annottext">([TestName] -&gt; TestName)
-&gt; ([TestName] -&gt; [TestName]) -&gt; [TestName] -&gt; TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; TestName -&gt; TestName) -&gt; [Key] -&gt; [TestName] -&gt; [TestName]
forall a b c. (a -&gt; b -&gt; c) -&gt; [a] -&gt; [b] -&gt; [c]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#zipWith"><span class="hs-identifier hs-var">zipWith</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key -&gt; TestName -&gt; TestName
</span><a href="#local-6989586621679234713"><span class="hs-identifier hs-var">pad</span></a></span><span> </span><span class="annot"><span class="annottext">(Key -&gt; TestName -&gt; TestName)
-&gt; (Key -&gt; Key) -&gt; Key -&gt; TestName -&gt; TestName
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Key
</span><a href="#local-6989586621679234714"><span class="hs-identifier hs-var">padColumn</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-special">[</span><span class="annot"><span class="annottext">Key
Item [Key]
</span><span class="hs-number">0</span></span><span> </span><span class="hs-glyph">..</span><span class="hs-special">]</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[TestName]]
</span><a href="#local-6989586621679234715"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-715"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-716"></span><span>    </span><span id="local-6989586621679234715"><span class="annot"><span class="annottext">[[TestName]]
</span><a href="#local-6989586621679234715"><span class="hs-identifier hs-var">xss</span></a></span></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="hs-special">[</span><span class="hs-special">[</span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span class="hs-special">]</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">([TestName] -&gt; [TestName]) -&gt; [[TestName]] -&gt; [[TestName]]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">(TestName -&gt; Bool) -&gt; [TestName] -&gt; [TestName]
forall a. (a -&gt; Bool) -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#filter"><span class="hs-identifier hs-var">filter</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Bool -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#not"><span class="hs-identifier hs-var">not</span></a></span><span> </span><span class="annot"><span class="annottext">(Bool -&gt; Bool) -&gt; (TestName -&gt; Bool) -&gt; TestName -&gt; Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Bool
forall a. [a] -&gt; Bool
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#null"><span class="hs-identifier hs-var">null</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[TestName]]
</span><a href="#local-6989586621679234711"><span class="hs-identifier hs-var">xss'</span></a></span><span>
</span><span id="line-717"></span><span>    </span><span id="local-6989586621679234713"><span class="annot"><span class="annottext">pad :: Key -&gt; TestName -&gt; TestName
</span><a href="#local-6989586621679234713"><span class="hs-identifier hs-var hs-var">pad</span></a></span></span><span> </span><span id="local-6989586621679234720"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234720"><span class="hs-identifier hs-var">n</span></a></span></span><span> </span><span id="local-6989586621679234721"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234721"><span class="hs-identifier hs-var">xs</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234721"><span class="hs-identifier hs-var">xs</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Char -&gt; TestName
forall a. Key -&gt; a -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#replicate"><span class="hs-identifier hs-var">replicate</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234720"><span class="hs-identifier hs-var">n</span></a></span><span> </span><span class="annot"><span class="annottext">Key -&gt; Key -&gt; Key
forall a. Num a =&gt; a -&gt; a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Num.html#-"><span class="hs-operator hs-var">-</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Key
forall a. [a] -&gt; Key
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Key
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234721"><span class="hs-identifier hs-var">xs</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">' '</span></span><span>
</span><span id="line-718"></span><span>    </span><span id="local-6989586621679234714"><span class="annot"><span class="annottext">padColumn :: Key -&gt; Key
</span><a href="#local-6989586621679234714"><span class="hs-identifier hs-var hs-var">padColumn</span></a></span></span><span> </span><span id="local-6989586621679234723"><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234723"><span class="hs-identifier hs-var">idx</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[Key] -&gt; Key
forall a. Ord a =&gt; [a] -&gt; a
forall (t :: Type -&gt; Type) a. (Foldable t, Ord a) =&gt; t a -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#maximum"><span class="hs-identifier hs-var">maximum</span></a></span><span> </span><span class="annot"><span class="annottext">([Key] -&gt; Key) -&gt; [Key] -&gt; Key
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">([TestName] -&gt; Key) -&gt; [[TestName]] -&gt; [Key]
forall a b. (a -&gt; b) -&gt; [a] -&gt; [b]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#map"><span class="hs-identifier hs-var">map</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; Key
forall a. [a] -&gt; Key
forall (t :: Type -&gt; Type) a. Foldable t =&gt; t a -&gt; Key
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#length"><span class="hs-identifier hs-var">length</span></a></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; Key) -&gt; ([TestName] -&gt; TestName) -&gt; [TestName] -&gt; Key
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">[TestName] -&gt; Key -&gt; TestName
forall a. HasCallStack =&gt; [a] -&gt; Key -&gt; a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.List.html#%21%21"><span class="hs-operator hs-var">!!</span></a></span><span> </span><span class="annot"><span class="annottext">Key
</span><a href="#local-6989586621679234723"><span class="hs-identifier hs-var">idx</span></a></span><span class="hs-special">)</span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[[TestName]]
</span><a href="#local-6989586621679234715"><span class="hs-identifier hs-var">xss</span></a></span><span>
</span><span id="line-719"></span><span>
</span><span id="line-720"></span><span id="local-6989586621679232622"><span class="annot"><a href="Plutarch.Test.Bench.html#findNonUniqueElement"><span class="hs-identifier hs-type">findNonUniqueElement</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Classes.html#Ord"><span class="hs-identifier hs-type">Ord</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232622"><span class="hs-identifier hs-type">a</span></a></span><span> </span><span class="hs-glyph">=&gt;</span><span> </span><span class="hs-special">[</span><span class="annot"><a href="#local-6989586621679232622"><span class="hs-identifier hs-type">a</span></a></span><span class="hs-special">]</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Maybe"><span class="hs-identifier hs-type">Maybe</span></a></span><span> </span><span class="annot"><a href="#local-6989586621679232622"><span class="hs-identifier hs-type">a</span></a></span></span><span>
</span><span id="line-721"></span><span id="findNonUniqueElement"><span class="annot"><span class="annottext">findNonUniqueElement :: forall a. Ord a =&gt; [a] -&gt; Maybe a
</span><a href="Plutarch.Test.Bench.html#findNonUniqueElement"><span class="hs-identifier hs-var hs-var">findNonUniqueElement</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; Maybe a
forall {a}. Ord a =&gt; Set a -&gt; [a] -&gt; Maybe a
</span><a href="#local-6989586621679234728"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
forall a. Set a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#empty"><span class="hs-identifier hs-var">Set.empty</span></a></span><span>
</span><span id="line-722"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-723"></span><span>    </span><span id="local-6989586621679234728"><span class="annot"><span class="annottext">go :: Set a -&gt; [a] -&gt; Maybe a
</span><a href="#local-6989586621679234728"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="annot"><span class="annottext">Set a
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Maybe a
forall a. Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span>
</span><span id="line-724"></span><span>    </span><span class="annot"><a href="#local-6989586621679234728"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span id="local-6989586621679234736"><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679234736"><span class="hs-identifier hs-var">acc</span></a></span></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234737"><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234737"><span class="hs-identifier hs-var">x</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234738"><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679234738"><span class="hs-identifier hs-var">xs</span></a></span></span><span class="hs-special">)</span><span>
</span><span id="line-725"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234737"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Bool
forall a. Ord a =&gt; a -&gt; Set a -&gt; Bool
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#member"><span class="hs-operator hs-var">`Set.member`</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679234736"><span class="hs-identifier hs-var">acc</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">a -&gt; Maybe a
forall a. a -&gt; Maybe a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-var">Just</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234737"><span class="hs-identifier hs-var">x</span></a></span><span>
</span><span id="line-726"></span><span>      </span><span class="hs-glyph">|</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#otherwise"><span class="hs-identifier hs-var">otherwise</span></a></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Set a -&gt; [a] -&gt; Maybe a
</span><a href="#local-6989586621679234728"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">a -&gt; Set a -&gt; Set a
forall a. Ord a =&gt; a -&gt; Set a -&gt; Set a
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.Set.Internal.html#insert"><span class="hs-identifier hs-var">Set.insert</span></a></span><span> </span><span class="annot"><span class="annottext">a
</span><a href="#local-6989586621679234737"><span class="hs-identifier hs-var">x</span></a></span><span> </span><span class="annot"><span class="annottext">Set a
</span><a href="#local-6989586621679234736"><span class="hs-identifier hs-var">acc</span></a></span><span class="hs-special">)</span><span> </span><span class="annot"><span class="annottext">[a]
</span><a href="#local-6989586621679234738"><span class="hs-identifier hs-var">xs</span></a></span><span>
</span><span id="line-727"></span><span>
</span><span id="line-728"></span><span class="annot"><a href="Plutarch.Test.Bench.html#csvOutput"><span class="hs-identifier hs-type">csvOutput</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Types.html#Handle"><span class="hs-identifier hs-type">Handle</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#IntMap"><span class="hs-identifier hs-type">IntMap</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="hs-identifier hs-type">TestName</span></span><span class="hs-special">,</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#TVar"><span class="hs-identifier hs-type">TVar</span></a></span><span> </span><span class="annot"><span class="hs-identifier hs-type">Status</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-729"></span><span id="csvOutput"><span class="annot"><span class="annottext">csvOutput :: Handle -&gt; IntMap (TestName, TVar Status) -&gt; IO ()
</span><a href="Plutarch.Test.Bench.html#csvOutput"><span class="hs-identifier hs-var hs-var">csvOutput</span></a></span></span><span> </span><span id="local-6989586621679234741"><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679234741"><span class="hs-identifier hs-var">h</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">((TestName, TVar Status) -&gt; IO ())
-&gt; IntMap (TestName, TVar Status) -&gt; IO ()
forall (t :: Type -&gt; Type) (f :: Type -&gt; Type) a b.
(Foldable t, Applicative f) =&gt;
(a -&gt; f b) -&gt; t a -&gt; f ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/Data.Foldable.html#traverse_"><span class="hs-identifier hs-var">traverse_</span></a></span><span> </span><span class="annot"><span class="annottext">(((TestName, TVar Status) -&gt; IO ())
 -&gt; IntMap (TestName, TVar Status) -&gt; IO ())
-&gt; ((TestName, TVar Status) -&gt; IO ())
-&gt; IntMap (TestName, TVar Status)
-&gt; IO ()
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-special">(</span><span id="local-6989586621679234742"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234742"><span class="hs-identifier hs-var">name</span></a></span></span><span class="hs-special">,</span><span> </span><span id="local-6989586621679234743"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234743"><span class="hs-identifier hs-var">tv</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-730"></span><span>  </span><span id="local-6989586621679234744"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234744"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM Result -&gt; IO Result
forall a. STM a -&gt; IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#atomically"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM Result -&gt; IO Result) -&gt; STM Result -&gt; IO Result
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; STM Status
forall a. TVar a -&gt; STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234743"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">STM Status -&gt; (Status -&gt; STM Result) -&gt; STM Result
forall a b. STM a -&gt; (a -&gt; STM b) -&gt; STM b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span id="local-6989586621679234745"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234745"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Result -&gt; STM Result
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234745"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">STM Result
forall a. STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#retry"><span class="hs-identifier hs-var">retry</span></a></span><span>
</span><span id="line-731"></span><span>  </span><span class="hs-keyword">case</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; Maybe (WithLoHi ExecutionBudget)
forall a. Read a =&gt; TestName -&gt; Maybe a
</span><span class="hs-identifier hs-var">safeRead</span></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; TestName
</span><span class="hs-identifier hs-var">resultDescription</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234744"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span> </span><span class="hs-keyword">of</span><span>
</span><span id="line-732"></span><span>    </span><span class="annot"><span class="annottext">Maybe (WithLoHi ExecutionBudget)
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Nothing"><span class="hs-identifier hs-var">Nothing</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">() -&gt; IO ()
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="hs-special">)</span><span>
</span><span id="line-733"></span><span>    </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Maybe.html#Just"><span class="hs-identifier hs-type">Just</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#WithLoHi"><span class="hs-identifier hs-type">WithLoHi</span></a></span><span> </span><span id="local-6989586621679234746"><span class="annot"><span class="annottext">ExecutionBudget
</span><a href="#local-6989586621679234746"><span class="hs-identifier hs-var">est</span></a></span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><span class="hs-identifier">_</span></span><span> </span><span class="annot"><span class="annottext">(Double, Double)
</span><span class="hs-identifier">_</span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-734"></span><span>      </span><span id="local-6989586621679234747"><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234747"><span class="hs-identifier hs-var">msg</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">TestName -&gt; IO TestName
</span><span class="hs-identifier hs-var">formatMessage</span></span><span> </span><span class="annot"><span class="annottext">(TestName -&gt; IO TestName) -&gt; TestName -&gt; IO TestName
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionBudget -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#csvEstimate"><span class="hs-identifier hs-var">csvEstimate</span></a></span><span> </span><span class="annot"><span class="annottext">ExecutionBudget
</span><a href="#local-6989586621679234746"><span class="hs-identifier hs-var">est</span></a></span><span>
</span><span id="line-735"></span><span>      </span><span class="annot"><span class="annottext">Handle -&gt; TestName -&gt; IO ()
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.IO.Handle.Text.html#hPutStrLn"><span class="hs-identifier hs-var">hPutStrLn</span></a></span><span> </span><span class="annot"><span class="annottext">Handle
</span><a href="#local-6989586621679234741"><span class="hs-identifier hs-var">h</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">TestName -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#encodeCsv"><span class="hs-identifier hs-var">encodeCsv</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234742"><span class="hs-identifier hs-var">name</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Char
</span><span class="hs-char">','</span></span><span> </span><span class="annot"><span class="annottext">Char -&gt; TestName -&gt; TestName
forall a. a -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-var">:</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><a href="#local-6989586621679234747"><span class="hs-identifier hs-var">msg</span></a></span><span class="hs-special">)</span><span>
</span><span id="line-736"></span><span>
</span><span id="line-737"></span><span class="annot"><a href="Plutarch.Test.Bench.html#csvEstimate"><span class="hs-identifier hs-type">csvEstimate</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-type">ExecutionBudget</span></a></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#String"><span class="hs-identifier hs-type">String</span></a></span><span>
</span><span id="line-738"></span><span id="csvEstimate"><span class="annot"><span class="annottext">csvEstimate :: ExecutionBudget -&gt; TestName
</span><a href="Plutarch.Test.Bench.html#csvEstimate"><span class="hs-identifier hs-var hs-var">csvEstimate</span></a></span></span><span> </span><span class="hs-special">(</span><span class="annot"><a href="Plutarch.Test.Bench.html#ExecutionBudget"><span class="hs-identifier hs-type">ExecutionBudget</span></a></span><span> </span><span id="local-6989586621679234749"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234749"><span class="hs-identifier hs-var">cpu</span></a></span></span><span> </span><span id="local-6989586621679234750"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234750"><span class="hs-identifier hs-var">mem</span></a></span></span><span> </span><span id="local-6989586621679234751"><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234751"><span class="hs-identifier hs-var">size</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Integer -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234749"><span class="hs-identifier hs-var">cpu</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234750"><span class="hs-identifier hs-var">mem</span></a></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">TestName
</span><span class="hs-string">&quot;,&quot;</span></span><span> </span><span class="annot"><span class="annottext">TestName -&gt; TestName -&gt; TestName
forall a. [a] -&gt; [a] -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%2B%2B"><span class="hs-operator hs-var">++</span></a></span><span> </span><span class="annot"><span class="annottext">Integer -&gt; TestName
forall a. Show a =&gt; a -&gt; TestName
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Show.html#show"><span class="hs-identifier hs-var">show</span></a></span><span> </span><span class="annot"><span class="annottext">Integer
</span><a href="#local-6989586621679234751"><span class="hs-identifier hs-var">size</span></a></span><span>
</span><span id="line-739"></span><span>
</span><span id="line-740"></span><span class="annot"><a href="Plutarch.Test.Bench.html#isSuccessful"><span class="hs-identifier hs-type">isSuccessful</span></a></span><span> </span><span class="hs-glyph">::</span><span> </span><span class="annot"><span class="hs-identifier hs-type">StatusMap</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#IO"><span class="hs-identifier hs-type">IO</span></a></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#Bool"><span class="hs-identifier hs-type">Bool</span></a></span><span>
</span><span id="line-741"></span><span id="isSuccessful"><span class="annot"><span class="annottext">isSuccessful :: StatusMap -&gt; IO Bool
</span><a href="Plutarch.Test.Bench.html#isSuccessful"><span class="hs-identifier hs-var hs-var">isSuccessful</span></a></span></span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">[TVar Status] -&gt; IO Bool
</span><a href="#local-6989586621679234752"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">([TVar Status] -&gt; IO Bool)
-&gt; (StatusMap -&gt; [TVar Status]) -&gt; StatusMap -&gt; IO Bool
forall b c a. (b -&gt; c) -&gt; (a -&gt; b) -&gt; a -&gt; c
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#."><span class="hs-operator hs-var">.</span></a></span><span> </span><span class="annot"><span class="annottext">StatusMap -&gt; [TVar Status]
forall a. IntMap a -&gt; [a]
</span><a href="../../../ghc-9.6.6/html/libraries/containers-0.6.7/src/Data.IntMap.Internal.html#elems"><span class="hs-identifier hs-var">IntMap.elems</span></a></span><span>
</span><span id="line-742"></span><span>  </span><span class="hs-keyword">where</span><span>
</span><span id="line-743"></span><span>    </span><span id="local-6989586621679234752"><span class="annot"><span class="annottext">go :: [TVar Status] -&gt; IO Bool
</span><a href="#local-6989586621679234752"><span class="hs-identifier hs-var hs-var">go</span></a></span></span><span> </span><span class="hs-special">[</span><span class="hs-special">]</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#True"><span class="hs-identifier hs-var">True</span></a></span><span>
</span><span id="line-744"></span><span>    </span><span class="annot"><a href="#local-6989586621679234752"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="hs-special">(</span><span id="local-6989586621679234760"><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234760"><span class="hs-identifier hs-var">tv</span></a></span></span><span> </span><span class="annot"><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#%3A"><span class="hs-glyph hs-type">:</span></a></span><span> </span><span id="local-6989586621679234761"><span class="annot"><span class="annottext">[TVar Status]
</span><a href="#local-6989586621679234761"><span class="hs-identifier hs-var">tvs</span></a></span></span><span class="hs-special">)</span><span> </span><span class="hs-glyph">=</span><span> </span><span class="hs-keyword">do</span><span>
</span><span id="line-745"></span><span>      </span><span id="local-6989586621679234762"><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234762"><span class="hs-identifier hs-var">b</span></a></span></span><span> </span><span class="hs-glyph">&lt;-</span><span> </span><span class="annot"><span class="annottext">STM Bool -&gt; IO Bool
forall a. STM a -&gt; IO a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#atomically"><span class="hs-identifier hs-var">atomically</span></a></span><span> </span><span class="annot"><span class="annottext">(STM Bool -&gt; IO Bool) -&gt; STM Bool -&gt; IO Bool
forall a b. (a -&gt; b) -&gt; a -&gt; b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%24"><span class="hs-operator hs-var">$</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status -&gt; STM Status
forall a. TVar a -&gt; STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#readTVar"><span class="hs-identifier hs-var">readTVar</span></a></span><span> </span><span class="annot"><span class="annottext">TVar Status
</span><a href="#local-6989586621679234760"><span class="hs-identifier hs-var">tv</span></a></span><span> </span><span class="annot"><span class="annottext">STM Status -&gt; (Status -&gt; STM Bool) -&gt; STM Bool
forall a b. STM a -&gt; (a -&gt; STM b) -&gt; STM b
forall (m :: Type -&gt; Type) a b. Monad m =&gt; m a -&gt; (a -&gt; m b) -&gt; m b
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#%3E%3E%3D"><span class="hs-operator hs-var">&gt;&gt;=</span></a></span><span> </span><span class="hs-glyph">\</span><span class="hs-glyph">case</span><span> </span><span class="annot"><span class="hs-identifier hs-type">Done</span></span><span> </span><span id="local-6989586621679234763"><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234763"><span class="hs-identifier hs-var">r</span></a></span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; STM Bool
forall a. a -&gt; STM a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="hs-special">(</span><span class="annot"><span class="annottext">Result -&gt; Bool
</span><span class="hs-identifier hs-var">resultSuccessful</span></span><span> </span><span class="annot"><span class="annottext">Result
</span><a href="#local-6989586621679234763"><span class="hs-identifier hs-var">r</span></a></span><span class="hs-special">)</span><span class="hs-special">;</span><span> </span><span class="annot"><span class="annottext">Status
</span><span class="hs-identifier">_</span></span><span> </span><span class="hs-glyph">-&gt;</span><span> </span><span class="annot"><span class="annottext">STM Bool
forall a. STM a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Conc.Sync.html#retry"><span class="hs-identifier hs-var">retry</span></a></span><span>
</span><span id="line-746"></span><span>      </span><span class="hs-keyword">if</span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="#local-6989586621679234762"><span class="hs-identifier hs-var">b</span></a></span><span> </span><span class="hs-keyword">then</span><span> </span><span class="annot"><span class="annottext">[TVar Status] -&gt; IO Bool
</span><a href="#local-6989586621679234752"><span class="hs-identifier hs-var">go</span></a></span><span> </span><span class="annot"><span class="annottext">[TVar Status]
</span><a href="#local-6989586621679234761"><span class="hs-identifier hs-var">tvs</span></a></span><span> </span><span class="hs-keyword">else</span><span> </span><span class="annot"><span class="annottext">Bool -&gt; IO Bool
forall a. a -&gt; IO a
forall (f :: Type -&gt; Type) a. Applicative f =&gt; a -&gt; f a
</span><a href="../../../ghc-9.6.6/html/libraries/base-4.18.2.1/src/GHC.Base.html#pure"><span class="hs-identifier hs-var">pure</span></a></span><span> </span><span class="annot"><span class="annottext">Bool
</span><a href="../../../ghc-9.6.6/html/libraries/ghc-prim-0.10.0/src/GHC.Types.html#False"><span class="hs-identifier hs-var">False</span></a></span><span>
</span><span id="line-747"></span></pre></body></html>